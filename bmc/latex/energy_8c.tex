\doxysection{energy.\+c File Reference}
\hypertarget{energy_8c}{}\label{energy_8c}\index{energy.c@{energy.c}}
{\ttfamily \#include "{}ha\+\_\+energy/energy.\+h"{}}\newline
{\ttfamily \#include "{}ha\+\_\+energy/mqtt\+\_\+rec.\+h"{}}\newline
{\ttfamily \#include "{}ha\+\_\+energy/bsoc.\+h"{}}\newline
Include dependency graph for energy.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{energy_8c_a8fb447618db946a9e2a596d9ea18763f}{\+\_\+\+DEFAULT\+\_\+\+SOURCE}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static bool \mbox{\hyperlink{energy_8c_a5db80d060a0e5e2905e748f97ce54f80}{solar\+\_\+shutdown}} (void)
\item 
void \mbox{\hyperlink{energy_8c_a0e3152830cd54954f6745ba7ae42ff42}{show\+IP}} (void)
\item 
static void \mbox{\hyperlink{energy_8c_ac6b8bef7c0921e591a31d844e13d24e8}{skeleton\+\_\+daemon}} ()
\item 
bool \mbox{\hyperlink{energy_8c_a014b7e7feb1f7f94f1947d2961e58534}{sanity\+\_\+check}} (void)
\item 
void \mbox{\hyperlink{energy_8c_aa39b8400b702a022ed3aaa4940cf4e15}{timer\+\_\+callback}} (int32\+\_\+t signum)
\item 
void \mbox{\hyperlink{energy_8c_a2a87ef47168dc639b307a285b8cb4462}{connlost}} (void \texorpdfstring{$\ast$}{*}context, char \texorpdfstring{$\ast$}{*}cause)
\item 
int \mbox{\hyperlink{energy_8c_a0ddf1224851353fc92bfbff6f499fa97}{main}} (int argc, char \texorpdfstring{$\ast$}{*}argv\mbox{[}$\,$\mbox{]})
\item 
void \mbox{\hyperlink{energy_8c_aaa8441f14022457063db591bed50fe62}{ramp\+\_\+up\+\_\+gti}} (MQTTClient client\+\_\+p, bool start, bool excess)
\item 
void \mbox{\hyperlink{energy_8c_aa02b759a5ba02eb2d0083c02dcbe4834}{ramp\+\_\+down\+\_\+gti}} (MQTTClient client\+\_\+p, bool sw\+\_\+off)
\item 
void \mbox{\hyperlink{energy_8c_a28b7bbb5fe37666136a84c7cded51e2e}{ramp\+\_\+up\+\_\+ac}} (MQTTClient client\+\_\+p, bool start)
\item 
void \mbox{\hyperlink{energy_8c_a92077e5f551e509dad279a8d2be4b21d}{ramp\+\_\+down\+\_\+ac}} (MQTTClient client\+\_\+p, bool sw\+\_\+off)
\item 
void \mbox{\hyperlink{energy_8c_a2c6c70b9a184aa76393a677b08954c81}{ha\+\_\+ac\+\_\+off}} (void)
\item 
void \mbox{\hyperlink{energy_8c_a9a2e9166d49137eb9230625ac072807d}{ha\+\_\+ac\+\_\+on}} (void)
\item 
void \mbox{\hyperlink{energy_8c_a200b8cfedca58c43dc888d70d83342d2}{ha\+\_\+dc\+\_\+off}} (void)
\item 
void \mbox{\hyperlink{energy_8c_ada6758833529a18e073775d997a3833b}{ha\+\_\+dc\+\_\+on}} (void)
\item 
char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\+\_\+time}} (bool log)
\item 
bool \mbox{\hyperlink{energy_8c_a2533146394b65b382653eff2cd6f2106}{sync\+\_\+ha}} (void)
\item 
bool \mbox{\hyperlink{energy_8c_ae7020228b3ccca216927caec73938554}{log\+\_\+timer}} (void)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}} \mbox{\hyperlink{energy_8c_ae0a8ca490b1331a13666dbedf7175bd9}{ha\+\_\+flag\+\_\+vars\+\_\+pc}}
\item 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}} \mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\+\_\+flag\+\_\+vars\+\_\+ss}}
\item 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}} \mbox{\hyperlink{energy_8c_a04a99d06cea1265d7193a122288d83a0}{ha\+\_\+flag\+\_\+vars\+\_\+sd}}
\item 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}} \mbox{\hyperlink{energy_8c_ab9a22fb7b17a1ebe54668d617b8d7226}{ha\+\_\+flag\+\_\+vars\+\_\+ha}}
\item 
const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{energy_8c_ae54230f3933b19460113c7aeac29cec7}{board\+\_\+name}} = "{}NO\+\_\+\+BOARD"{}
\item 
const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{energy_8c_aec275271b98c5dd5cbe9a33ea5081893}{driver\+\_\+name}} = "{}NO\+\_\+\+DRIVER"{}
\item 
FILE \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}
\item 
struct \mbox{\hyperlink{structenergy__type}{energy\+\_\+type}} \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{energy_8c_a8fb447618db946a9e2a596d9ea18763f}\index{energy.c@{energy.c}!\_DEFAULT\_SOURCE@{\_DEFAULT\_SOURCE}}
\index{\_DEFAULT\_SOURCE@{\_DEFAULT\_SOURCE}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{\_DEFAULT\_SOURCE}{\_DEFAULT\_SOURCE}}
{\footnotesize\ttfamily \label{energy_8c_a8fb447618db946a9e2a596d9ea18763f} 
\#define \+\_\+\+DEFAULT\+\_\+\+SOURCE}



\doxysubsection{Function Documentation}
\Hypertarget{energy_8c_a2a87ef47168dc639b307a285b8cb4462}\index{energy.c@{energy.c}!connlost@{connlost}}
\index{connlost@{connlost}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{connlost()}{connlost()}}
{\footnotesize\ttfamily \label{energy_8c_a2a87ef47168dc639b307a285b8cb4462} 
void connlost (\begin{DoxyParamCaption}\item[{void \texorpdfstring{$\ast$}{*}}]{context}{, }\item[{char \texorpdfstring{$\ast$}{*}}]{cause}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00298\ \{}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structha__flag__type}{ha\_flag\_type}}\ *ha\_flag\ =\ context;}
\DoxyCodeLine{00300\ \ \ \ \ int32\_t\ id\_num;}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{comment}{//\ bug-\/out\ if\ no\ context\ variables\ passed\ to\ callback}}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{keywordflow}{if}\ (context\ ==\ NULL)\ \{}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ id\_num\ =\ -\/1;}
\DoxyCodeLine{00305\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ id\_num\ =\ ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_a0756e3e6519823c23b8711864a70460c}{ha\_id}};}
\DoxyCodeLine{00307\ \ \ \ \ \}}
\DoxyCodeLine{00308\ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\(\backslash\)n\%s\ Connection\ lost,\ exit\ ha\_energy\ program\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00309\ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ \ \ \ \ cause:\ \%s,\ \%d\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ cause,\ id\_num);}
\DoxyCodeLine{00310\ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%sDAEMON\ failure\ \ LOG\ Version\ \%s\ :\ MQTT\ Version\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8h_aa48b2017856a8a9c33a9935afe604c8d}{LOG\_VERSION}},\ \mbox{\hyperlink{energy_8h_a702197a21870dfd505d92530b27754ac}{MQTT\_VERSION}});}
\DoxyCodeLine{00311\ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00312\ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00313\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_a2a87ef47168dc639b307a285b8cb4462_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=215pt]{energy_8c_a2a87ef47168dc639b307a285b8cb4462_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a2c6c70b9a184aa76393a677b08954c81}\index{energy.c@{energy.c}!ha\_ac\_off@{ha\_ac\_off}}
\index{ha\_ac\_off@{ha\_ac\_off}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ha\_ac\_off()}{ha\_ac\_off()}}
{\footnotesize\ttfamily \label{energy_8c_a2c6c70b9a184aa76393a677b08954c81} 
void ha\+\_\+ac\+\_\+off (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00947\ \{}
\DoxyCodeLine{00948\ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}{TOPIC\_PACC}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00949\ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00950\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_a2c6c70b9a184aa76393a677b08954c81_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{energy_8c_a2c6c70b9a184aa76393a677b08954c81_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a9a2e9166d49137eb9230625ac072807d}\index{energy.c@{energy.c}!ha\_ac\_on@{ha\_ac\_on}}
\index{ha\_ac\_on@{ha\_ac\_on}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ha\_ac\_on()}{ha\_ac\_on()}}
{\footnotesize\ttfamily \label{energy_8c_a9a2e9166d49137eb9230625ac072807d} 
void ha\+\_\+ac\+\_\+on (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00953\ \{}
\DoxyCodeLine{00954\ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}{TOPIC\_PACC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00955\ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00956\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_a9a2e9166d49137eb9230625ac072807d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=347pt]{energy_8c_a9a2e9166d49137eb9230625ac072807d_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a200b8cfedca58c43dc888d70d83342d2}\index{energy.c@{energy.c}!ha\_dc\_off@{ha\_dc\_off}}
\index{ha\_dc\_off@{ha\_dc\_off}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ha\_dc\_off()}{ha\_dc\_off()}}
{\footnotesize\ttfamily \label{energy_8c_a200b8cfedca58c43dc888d70d83342d2} 
void ha\+\_\+dc\+\_\+off (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00962\ \{}
\DoxyCodeLine{00963\ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00964\ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00965\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_a200b8cfedca58c43dc888d70d83342d2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=221pt]{energy_8c_a200b8cfedca58c43dc888d70d83342d2_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_ada6758833529a18e073775d997a3833b}\index{energy.c@{energy.c}!ha\_dc\_on@{ha\_dc\_on}}
\index{ha\_dc\_on@{ha\_dc\_on}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ha\_dc\_on()}{ha\_dc\_on()}}
{\footnotesize\ttfamily \label{energy_8c_ada6758833529a18e073775d997a3833b} 
void ha\+\_\+dc\+\_\+on (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00968\ \{}
\DoxyCodeLine{00969\ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00970\ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00971\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_ada6758833529a18e073775d997a3833b_cgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}\index{energy.c@{energy.c}!log\_time@{log\_time}}
\index{log\_time@{log\_time}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{log\_time()}{log\_time()}}
{\footnotesize\ttfamily \label{energy_8c_a18b19ee666a9edc39d904a474ddee1d9} 
char \texorpdfstring{$\ast$}{*} log\+\_\+time (\begin{DoxyParamCaption}\item[{bool}]{log}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01032\ \{}
\DoxyCodeLine{01033\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{char}\ time\_log[\mbox{\hyperlink{energy_8h_a0c85192a1fc4b17a7c63d0c0f6f61625}{RBUF\_SIZ}}]\ =\ \{0\};}
\DoxyCodeLine{01034\ \ \ \ \ \textcolor{keyword}{static}\ uint32\_t\ len\ =\ 0,\ sync\_time\ =\ \mbox{\hyperlink{energy_8h_ae1b9e27b004bee7dcaecf4ee4778e0bd}{TIME\_SYNC\_SEC}}\ -\/\ 1;}
\DoxyCodeLine{01035\ \ \ \ \ time\_t\ rawtime\_log;}
\DoxyCodeLine{01036\ }
\DoxyCodeLine{01037\ \ \ \ \ tzset();}
\DoxyCodeLine{01038\ \ \ \ \ timezone\ =\ 0;}
\DoxyCodeLine{01039\ \ \ \ \ daylight\ =\ 0;}
\DoxyCodeLine{01040\ \ \ \ \ time(\&rawtime\_log);}
\DoxyCodeLine{01041\ \ \ \ \ \textcolor{keywordflow}{if}\ (sync\_time++\ >\ \mbox{\hyperlink{energy_8h_ae1b9e27b004bee7dcaecf4ee4778e0bd}{TIME\_SYNC\_SEC}})\ \{}
\DoxyCodeLine{01042\ \ \ \ \ \ \ \ \ sync\_time\ =\ 0;}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \ \ snprintf(time\_log,\ \mbox{\hyperlink{energy_8h_a0c85192a1fc4b17a7c63d0c0f6f61625}{RBUF\_SIZ}}\ -\/\ 1,\ \textcolor{stringliteral}{"{}VT\%lut"{}},\ rawtime\_log);\ \textcolor{comment}{//\ format\ for\ dumpload\ controller\ gti\ time\ commands}}
\DoxyCodeLine{01044\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{http__vars_8c_addadf78316d3819a2b8fc271ffd97fc9}{mqtt\_gti\_time}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a8170bc07eb3b7f53bb8bfea780ebfdd8}{TOPIC\_P}},\ time\_log);}
\DoxyCodeLine{01045\ \ \ \ \ \}}
\DoxyCodeLine{01046\ }
\DoxyCodeLine{01047\ \ \ \ \ sprintf(time\_log,\ \textcolor{stringliteral}{"{}\%s"{}},\ ctime(\&rawtime\_log));}
\DoxyCodeLine{01048\ \ \ \ \ len\ =\ strlen(time\_log);}
\DoxyCodeLine{01049\ \ \ \ \ time\_log[len\ -\/\ 1]\ =\ 0;\ \textcolor{comment}{//\ munge\ out\ the\ return\ character}}
\DoxyCodeLine{01050\ \ \ \ \ \textcolor{keywordflow}{if}\ (log)\ \{}
\DoxyCodeLine{01051\ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ "{}},\ time\_log);}
\DoxyCodeLine{01052\ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{01053\ \ \ \ \ \}}
\DoxyCodeLine{01054\ }
\DoxyCodeLine{01055\ \ \ \ \ \textcolor{keywordflow}{return}\ time\_log;}
\DoxyCodeLine{01056\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=261pt]{energy_8c_a18b19ee666a9edc39d904a474ddee1d9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_a18b19ee666a9edc39d904a474ddee1d9_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_ae7020228b3ccca216927caec73938554}\index{energy.c@{energy.c}!log\_timer@{log\_timer}}
\index{log\_timer@{log\_timer}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{log\_timer()}{log\_timer()}}
{\footnotesize\ttfamily \label{energy_8c_ae7020228b3ccca216927caec73938554} 
bool log\+\_\+timer (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01091\ \{}
\DoxyCodeLine{01092\ \ \ \ \ \textcolor{keywordtype}{bool}\ itstime\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01093\ }
\DoxyCodeLine{01094\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.log\_spam\ <\ \mbox{\hyperlink{energy_8h_a764c3b6aadcbcacb53eca948eeb75bdf}{LOW\_LOG\_SPAM}})\ \{}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.log\_time\_reset\ =\ 0;}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ itstime\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01097\ \ \ \ \ \}}
\DoxyCodeLine{01098\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.log\_time\_reset\ >\ \mbox{\hyperlink{energy_8h_a3af0cc0b4b28d3cecd3a7d1daf772804}{RESET\_LOG\_SPAM}})\ \{}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.log\_spam\ =\ 0;}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ itstime\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01101\ \ \ \ \ \}}
\DoxyCodeLine{01102\ \ \ \ \ \textcolor{keywordflow}{return}\ itstime;}
\DoxyCodeLine{01103\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{energy_8c_ae7020228b3ccca216927caec73938554_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a0ddf1224851353fc92bfbff6f499fa97}\index{energy.c@{energy.c}!main@{main}}
\index{main@{main}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{energy_8c_a0ddf1224851353fc92bfbff6f499fa97} 
int main (\begin{DoxyParamCaption}\item[{int}]{argc}{, }\item[{char \texorpdfstring{$\ast$}{*}}]{argv}{\mbox{[}$\,$\mbox{]}}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00322\ \{}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keyword}{struct\ }itimerval\ new\_timer\ =\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ .it\_value.tv\_sec\ =\ \mbox{\hyperlink{energy_8h_af1013b321ed7dc7a7940e27f03eb5bf9}{CMD\_SEC}},}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ .it\_value.tv\_usec\ =\ 0,}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ .it\_interval.tv\_sec\ =\ \mbox{\hyperlink{energy_8h_af1013b321ed7dc7a7940e27f03eb5bf9}{CMD\_SEC}},}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ .it\_interval.tv\_usec\ =\ 0,}
\DoxyCodeLine{00328\ \ \ \ \ \};}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keyword}{struct\ }itimerval\ old\_timer;}
\DoxyCodeLine{00330\ \ \ \ \ time\_t\ rawtime;}
\DoxyCodeLine{00331\ \ \ \ \ MQTTClient\_connectOptions\ conn\_opts\_p\ =\ MQTTClient\_connectOptions\_initializer,}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ conn\_opts\_sd\ =\ MQTTClient\_connectOptions\_initializer,}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ conn\_opts\_ha\ =\ MQTTClient\_connectOptions\_initializer;}
\DoxyCodeLine{00334\ \ \ \ \ MQTTClient\_message\ pubmsg\ =\ MQTTClient\_message\_initializer;}
\DoxyCodeLine{00335\ \ \ \ \ MQTTClient\_deliveryToken\ token;}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordtype}{char}\ hname[256],\ *hname\_ptr\ =\ hname;}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ hname\_len\ =\ 12;}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \ \ gethostname(hname,\ hname\_len);}
\DoxyCodeLine{00340\ \ \ \ \ hname[12]\ =\ 0;}
\DoxyCodeLine{00341\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\ \ LOG\ Version\ \%s\ :\ MQTT\ Version\ \%s\ :\ Host\ Name\ \%s\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8h_aa48b2017856a8a9c33a9935afe604c8d}{LOG\_VERSION}},\ \mbox{\hyperlink{energy_8h_a702197a21870dfd505d92530b27754ac}{MQTT\_VERSION}},\ hname);}
\DoxyCodeLine{00342\ \ \ \ \ \mbox{\hyperlink{energy_8c_a0e3152830cd54954f6745ba7ae42ff42}{showIP}}();}
\DoxyCodeLine{00343\ \ \ \ \ \mbox{\hyperlink{energy_8c_ac6b8bef7c0921e591a31d844e13d24e8}{skeleton\_daemon}}();}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.E)\ \{}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{energy_8h_a3b2b2ba876738909ea41ffc29311415fae5b17a6cbef319f39c92c567338e03ac}{E\_INIT}}:}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \textcolor{preprocessor}{\#ifdef\ LOG\_TO\_FILE}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}\ =\ fopen(\mbox{\hyperlink{energy_8h_a2d9257ecbf4951d3877398f752d47ae6}{LOG\_TO\_FILE}},\ \textcolor{stringliteral}{"{}a"{}});}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}\ ==\ NULL)\ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}\ =\ fopen(\mbox{\hyperlink{energy_8h_aacdc926f0a34006e13fe0ddc3398deee}{LOG\_TO\_FILE\_ALT}},\ \textcolor{stringliteral}{"{}a"{}});}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}\ ==\ NULL)\ \{}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}\ =\ stdout;}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\%s\ Unable\ to\ open\ LOG\ file\ \%s\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8h_aacdc926f0a34006e13fe0ddc3398deee}{LOG\_TO\_FILE\_ALT}});}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00358\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}\ =\ stdout;}
\DoxyCodeLine{00360\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\%s\ LOG\ Version\ \%s\ :\ MQTT\ Version\ \%s\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8h_aa48b2017856a8a9c33a9935afe604c8d}{LOG\_VERSION}},\ \mbox{\hyperlink{energy_8h_a702197a21870dfd505d92530b27754ac}{MQTT\_VERSION}});}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{bsoc_8c_a571a7c60ba1a2a6c569427c21c829733}{bsoc\_init}}())\ \{}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\%s\ bsoc\_init\ failure\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00370\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ set\ the\ timer\ for\ MQTT\ publishing\ sample\ speed}}
\DoxyCodeLine{00371\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ CMD\_SEC\ \ \ \ \ \ \ \ \ 10}}
\DoxyCodeLine{00372\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ setitimer(ITIMER\_REAL,\ \&new\_timer,\ \&old\_timer);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ signal(SIGALRM,\ \mbox{\hyperlink{energy_8c_aa39b8400b702a022ed3aaa4940cf4e15}{timer\_callback}});}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strncmp(hname,\ \mbox{\hyperlink{energy_8h_af7dd188b7e9a8592e394e37ba6272a90}{TNAME}},\ 6)\ ==\ 0)\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_create(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a16d272bc422b8cccde66c643763a9070}{LADDRESS}},\ \mbox{\hyperlink{energy_8h_aca843921281fc0385b402ca1e700f13b}{CLIENTID1}},}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTCLIENT\_PERSISTENCE\_NONE,\ NULL);}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_p.keepAliveInterval\ =\ 20;}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_p.cleansession\ =\ 1;}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hname\_ptr\ =\ \mbox{\hyperlink{energy_8h_a16d272bc422b8cccde66c643763a9070}{LADDRESS}};}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_create(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a280feb883e9d4a7edcc69c8bcb9f38f2}{ADDRESS}},\ \mbox{\hyperlink{energy_8h_aca843921281fc0385b402ca1e700f13b}{CLIENTID1}},}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTCLIENT\_PERSISTENCE\_NONE,\ NULL);}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_p.keepAliveInterval\ =\ 20;}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_p.cleansession\ =\ 1;}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hname\_ptr\ =\ \mbox{\hyperlink{energy_8h_a280feb883e9d4a7edcc69c8bcb9f38f2}{ADDRESS}};}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ Connect\ MQTT\ server\ \%s,\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ hname\_ptr,\ \mbox{\hyperlink{energy_8h_aca843921281fc0385b402ca1e700f13b}{CLIENTID1}});}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_setCallbacks(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \&\mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\_flag\_vars\_ss}},\ \mbox{\hyperlink{energy_8c_a2a87ef47168dc639b307a285b8cb4462}{connlost}},\ \mbox{\hyperlink{mqtt__rec_8c_aeb7f1edb73f2b51c6df601678ca4df22}{msgarrvd}},\ \mbox{\hyperlink{mqtt__rec_8c_a4a79780b9057489f0740020d6bae250f}{delivered}});}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.rc\ =\ MQTTClient\_connect(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \&conn\_opts\_p))\ !=\ MQTTCLIENT\_SUCCESS)\ \{}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ Failed\ to\ connect\ MQTT\ server,\ return\ code\ \%d\ \%s,\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.rc,\ hname\_ptr,\ \mbox{\hyperlink{energy_8h_aca843921281fc0385b402ca1e700f13b}{CLIENTID1}});}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_mutex\_destroy(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ha\_lock);}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strncmp(hname,\ \mbox{\hyperlink{energy_8h_af7dd188b7e9a8592e394e37ba6272a90}{TNAME}},\ 6)\ ==\ 0)\ \{}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_create(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_sd,\ \mbox{\hyperlink{energy_8h_a16d272bc422b8cccde66c643763a9070}{LADDRESS}},\ \mbox{\hyperlink{energy_8h_a7adb4fde27aaf399c290536e96e41df7}{CLIENTID2}},}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTCLIENT\_PERSISTENCE\_NONE,\ NULL);}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_sd.keepAliveInterval\ =\ 20;}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_sd.cleansession\ =\ 1;}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hname\_ptr\ =\ \mbox{\hyperlink{energy_8h_a16d272bc422b8cccde66c643763a9070}{LADDRESS}};}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_create(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_sd,\ \mbox{\hyperlink{energy_8h_a280feb883e9d4a7edcc69c8bcb9f38f2}{ADDRESS}},\ \mbox{\hyperlink{energy_8h_a7adb4fde27aaf399c290536e96e41df7}{CLIENTID2}},}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTCLIENT\_PERSISTENCE\_NONE,\ NULL);}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_sd.keepAliveInterval\ =\ 20;}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_sd.cleansession\ =\ 1;}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hname\_ptr\ =\ \mbox{\hyperlink{energy_8h_a280feb883e9d4a7edcc69c8bcb9f38f2}{ADDRESS}};}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ Connect\ MQTT\ server\ \%s,\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ hname\_ptr,\ \mbox{\hyperlink{energy_8h_a7adb4fde27aaf399c290536e96e41df7}{CLIENTID2}});}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_setCallbacks(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_sd,\ \&\mbox{\hyperlink{energy_8c_a04a99d06cea1265d7193a122288d83a0}{ha\_flag\_vars\_sd}},\ \mbox{\hyperlink{energy_8c_a2a87ef47168dc639b307a285b8cb4462}{connlost}},\ \mbox{\hyperlink{mqtt__rec_8c_aeb7f1edb73f2b51c6df601678ca4df22}{msgarrvd}},\ \mbox{\hyperlink{mqtt__rec_8c_a4a79780b9057489f0740020d6bae250f}{delivered}});}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.rc\ =\ MQTTClient\_connect(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_sd,\ \&conn\_opts\_sd))\ !=\ MQTTCLIENT\_SUCCESS)\ \{}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ Failed\ to\ connect\ MQTT\ server,\ return\ code\ \%d\ \%s,\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.rc,\ hname\_ptr,\ \mbox{\hyperlink{energy_8h_a7adb4fde27aaf399c290536e96e41df7}{CLIENTID2}});}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_mutex\_destroy(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ha\_lock);}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00425\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ Home\ Assistant\ MQTT\ receive\ messages}}
\DoxyCodeLine{00426\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strncmp(hname,\ \mbox{\hyperlink{energy_8h_af7dd188b7e9a8592e394e37ba6272a90}{TNAME}},\ 6)\ ==\ 0)\ \{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_create(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_ha,\ \mbox{\hyperlink{energy_8h_a16d272bc422b8cccde66c643763a9070}{LADDRESS}},\ \mbox{\hyperlink{energy_8h_a080e92b01476c8d6861e405c4ac3bae5}{CLIENTID3}},}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTCLIENT\_PERSISTENCE\_NONE,\ NULL);}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_ha.keepAliveInterval\ =\ 20;}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_ha.cleansession\ =\ 1;}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hname\_ptr\ =\ \mbox{\hyperlink{energy_8h_a16d272bc422b8cccde66c643763a9070}{LADDRESS}};}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_create(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_ha,\ \mbox{\hyperlink{energy_8h_a280feb883e9d4a7edcc69c8bcb9f38f2}{ADDRESS}},\ \mbox{\hyperlink{energy_8h_a080e92b01476c8d6861e405c4ac3bae5}{CLIENTID3}},}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MQTTCLIENT\_PERSISTENCE\_NONE,\ NULL);}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_ha.keepAliveInterval\ =\ 20;}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conn\_opts\_ha.cleansession\ =\ 1;}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hname\_ptr\ =\ \mbox{\hyperlink{energy_8h_a280feb883e9d4a7edcc69c8bcb9f38f2}{ADDRESS}};}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ Connect\ MQTT\ server\ \%s,\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ hname\_ptr,\ \mbox{\hyperlink{energy_8h_a080e92b01476c8d6861e405c4ac3bae5}{CLIENTID3}});}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_setCallbacks(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_ha,\ \&\mbox{\hyperlink{energy_8c_ab9a22fb7b17a1ebe54668d617b8d7226}{ha\_flag\_vars\_ha}},\ \mbox{\hyperlink{energy_8c_a2a87ef47168dc639b307a285b8cb4462}{connlost}},\ \mbox{\hyperlink{mqtt__rec_8c_aeb7f1edb73f2b51c6df601678ca4df22}{msgarrvd}},\ \mbox{\hyperlink{mqtt__rec_8c_a4a79780b9057489f0740020d6bae250f}{delivered}});}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.rc\ =\ MQTTClient\_connect(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_ha,\ \&conn\_opts\_ha))\ !=\ MQTTCLIENT\_SUCCESS)\ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ Failed\ to\ connect\ MQTT\ server,\ return\ code\ \%d\ \%s,\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.rc,\ hname\_ptr,\ \mbox{\hyperlink{energy_8h_a080e92b01476c8d6861e405c4ac3bae5}{CLIENTID3}});}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_mutex\_destroy(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ha\_lock);}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00450\ }
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00452\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ on\ topic\ received\ data\ will\ trigger\ the\ msgarrvd\ function}}
\DoxyCodeLine{00453\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_subscribe(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a08b3494e502966f0b67ef43c0060b4a4}{TOPIC\_SS}},\ \mbox{\hyperlink{energy_8h_a1e5759eb3f87b00bf4acf6579f9034d5}{QOS}});\ \textcolor{comment}{//\ FM80\ Q84}}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_subscribe(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_sd,\ \mbox{\hyperlink{energy_8h_a42eda1760ac7eb3904f71b170d6eace0}{TOPIC\_SD}},\ \mbox{\hyperlink{energy_8h_a1e5759eb3f87b00bf4acf6579f9034d5}{QOS}});\ \textcolor{comment}{//\ DUMPLOAD\ K42}}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_subscribe(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_ha,\ \mbox{\hyperlink{energy_8h_a2361cc9e2cb27aa89335ae62571ef94f}{TOPIC\_HA}},\ \mbox{\hyperlink{energy_8h_a1e5759eb3f87b00bf4acf6579f9034d5}{QOS}});\ \textcolor{comment}{//\ Home\ Assistant\ Linux\ AMD64\ \ and\ ARM64}}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ pubmsg.payload\ =\ \textcolor{stringliteral}{"{}online"{}};}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ pubmsg.payloadlen\ =\ strlen(\textcolor{stringliteral}{"{}online"{}});}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ pubmsg.qos\ =\ \mbox{\hyperlink{energy_8h_a1e5759eb3f87b00bf4acf6579f9034d5}{QOS}};}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ pubmsg.retained\ =\ 0;}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\_flag\_vars\_ss}}.deliveredtoken\ =\ 0;}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ notify\ HA\ we\ are\ running\ and\ controlling\ AC\ power\ plugs}}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_publishMessage(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a75b4efd61045ccc11560697d90941f3f}{TOPIC\_PACA}},\ \&pubmsg,\ \&token);}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ MQTTClient\_publishMessage(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a7a785b1b0c69e86f3dd28b94bb393fca}{TOPIC\_PDCA}},\ \&pubmsg,\ \&token);}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ sync\ HA\ power\ switches}}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}{TOPIC\_PACC}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}{TOPIC\_PACC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}{TOPIC\_PACC}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_on\ =\ \textcolor{keyword}{true};\ \textcolor{comment}{//\ can\ be\ switched\ on\ once}}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_on\ =\ \textcolor{keyword}{true};\ \textcolor{comment}{//\ can\ be\ switched\ on\ once}}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00479\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ use\ libcurl\ to\ read\ AC\ power\ meter\ HTTP\ data}}
\DoxyCodeLine{00480\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ iammeter\ connected\ for\ split\ single\ phase\ monitoring\ and\ one\ leg\ GTI\ power\ exporting}}
\DoxyCodeLine{00481\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8h_a34d485627939300ea5e51b765f599b9a}{iammeter\_read}}();}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00485\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ start\ the\ main\ energy\ monitoring\ loop}}
\DoxyCodeLine{00486\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\%s\ Solar\ Energy\ AC\ power\ controller\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00489\ \textcolor{preprocessor}{\#ifdef\ FAKE\_VPV}}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\ Faking\ dumpload\ PV\ voltage\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00491\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\_flag\_vars\_ss}}.energy\_mode\ =\ \mbox{\hyperlink{energy_8h_a2e6d97095eb0e18b2a11eee97c1c67af}{NORM\_MODE}};}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.E\ =\ \mbox{\hyperlink{energy_8h_a3b2b2ba876738909ea41ffc29311415faa19a96871d41a61ea3b7b279f5d4b1d6}{E\_WAIT}};}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{energy_8h_a3b2b2ba876738909ea41ffc29311415faa19a96871d41a61ea3b7b279f5d4b1d6}{E\_WAIT}}:}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\_flag\_vars\_ss}}.runner\ ||\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.speed\_go++\ >\ 1500000)\ \{}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.speed\_go\ =\ 0;}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\_flag\_vars\_ss}}.runner\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.E\ =\ \mbox{\hyperlink{energy_8h_a3b2b2ba876738909ea41ffc29311415fae3ecaae4eeb09e4ca74c68185041e15b}{E\_RUN}};}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ usleep(100);}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00504\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ main\ state-\/machine\ update\ sequence}}
\DoxyCodeLine{00505\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bsoc_8c_a4c8b6884b4cae5d49a0d4141ce516372}{bsoc\_data\_collect}}();}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_a014b7e7feb1f7f94f1947d2961e58534}{sanity\_check}}())\ \{}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\%s\ Sanity\ Check\ error\ \%d\ \%s\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.sane,\ \mbox{\hyperlink{bsoc_8c_ae6b57480d8cda466cfc65b9bfc47b255}{mqtt\_name}}[\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.sane]);}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00513\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ stop\ and\ restart\ the\ energy\ control\ processing}}
\DoxyCodeLine{00514\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ from\ inside\ the\ program\ or\ from\ a\ remote\ Home\ Assistant\ command}}
\DoxyCodeLine{00515\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_a5db80d060a0e5e2905e748f97ce54f80}{solar\_shutdown}}())\ \{}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.startup)\ \{}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ SHUTDOWN\ Solar\ Energy\ Control\ -\/-\/-\/>\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aa02b759a5ba02eb2d0083c02dcbe4834}{ramp\_down\_gti}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ usleep(100000);\ \textcolor{comment}{//\ wait}}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a92077e5f551e509dad279a8d2be4b21d}{ramp\_down\_ac}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ usleep(100000);\ \textcolor{comment}{//\ wait}}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aa02b759a5ba02eb2d0083c02dcbe4834}{ramp\_down\_gti}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ usleep(100000);\ \textcolor{comment}{//\ wait}}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a92077e5f551e509dad279a8d2be4b21d}{ramp\_down\_ac}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ usleep(100000);\ \textcolor{comment}{//\ wait}}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.startup)\ \{}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ Completed\ SHUTDOWN,\ Press\ again\ to\ RESTART.\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ iam\_delay\ =\ 0;}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{energy_8c_a5db80d060a0e5e2905e748f97ce54f80}{solar\_shutdown}}())\ \{}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_a8cae358dc3a23f274454a9dc9d10443e}{mqtt\_ha\_shutdown}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_ac1a01dc509505d2a44781caffa5c071a}{TOPIC\_SHUTDOWN}});}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ usleep(\mbox{\hyperlink{energy_8h_ae1c44b0e06f13991804a91e98022ad1c}{USEC\_SEC}});\ \textcolor{comment}{//\ wait}}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((int32\_t)\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a61c580ff6ce646f13228dc2dcad390c1}{V\_HACSW}}])\ \{}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a2c6c70b9a184aa76393a677b08954c81}{ha\_ac\_off}}();}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((int32\_t)\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a7391c358a2241e66cdf9f1e953184521}{V\_HDCSW}}])\ \{}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a200b8cfedca58c43dc888d70d83342d2}{ha\_dc\_off}}();}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((iam\_delay++\ >\ \mbox{\hyperlink{energy_8h_a5b7b3aec1ddee0f87659a37569eda53c}{IAM\_DELAY}})\ \&\&\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.shutdown)\ \{}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.fm80\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dumpload\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.iammeter\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.homeassistant\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.shutdown\ =\ 0;}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ RESTART\ Solar\ Energy\ Control\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bsoc_8c_a49c1e06b8059a63a9ed7c7d729e59d90}{bsoc\_set\_mode}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.pv\_bias,\ \textcolor{keyword}{true},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_a3fc1eb9cd6b570d96277f671de9e979a}{mqtt\_gti\_power}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a8170bc07eb3b7f53bb8bfea780ebfdd8}{TOPIC\_P}},\ \textcolor{stringliteral}{"{}Z\#"{}},\ 1);\ \textcolor{comment}{//\ zero\ power\ at\ startup}}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00559\ \textcolor{preprocessor}{\#ifdef\ AUTO\_CHARGE}}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00561\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ usleep(100000);\ \textcolor{comment}{//\ wait}}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pid_8c_a2845499736d4daabdc6bfcb637203535}{ResetPI}}(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.pid);}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\_flag\_vars\_ss}}.runner\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.fm80\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dumpload\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.iammeter\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.homeassistant\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.in\_pid\_control\ =\ \textcolor{keyword}{false};\ \textcolor{comment}{//\ shutdown\ auto\ energy\ control}}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.R\ =\ \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a3c0e911dee8c0c9acea4848d7493829e}{R\_INIT}};}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\_flag\_vars\_ss}}.receivedtoken)\ \{}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\_flag\_vars\_ss}}.receivedtoken\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_a04a99d06cea1265d7193a122288d83a0}{ha\_flag\_vars\_sd}}.receivedtoken)\ \{}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a04a99d06cea1265d7193a122288d83a0}{ha\_flag\_vars\_sd}}.receivedtoken\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{energy_8h_a3b2b2ba876738909ea41ffc29311415fae3ecaae4eeb09e4ca74c68185041e15b}{E\_RUN}}:}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \ \ \ \ usleep(100);}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.R)\ \{}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a3c0e911dee8c0c9acea4848d7493829e}{R\_INIT}}:}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_ac\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_on\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_on\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.R\ =\ \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a53eae320dbcd86f620fa75b630f13c79}{R\_RUN}};}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.no\_float\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a1474a7d3758281b3a8fdfcfda8147bab}{R\_FLOAT}}:}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.no\_float)\ \{}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_ac\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_on\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_on\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.no\_float\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status)\ \{}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{bsoc_8c_ade03000a21b56a5527367c81e7219c99}{gti\_test}}()\ >\ \mbox{\hyperlink{energy_8h_a05cb74467763c662c93c0197d2ebb502}{MIN\_BAT\_KW\_GTI\_HI}})\ \{}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ R\_FLOAT\ DC\ switch\ true\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ usleep(100000);\ \textcolor{comment}{//\ wait}}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status)\ \{}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{bsoc_8c_a413c5066cb43aae0039adba36593129a}{ac\_test}}()\ >\ \mbox{\hyperlink{energy_8h_acba28bf1765e9924790cc957b23ece2f}{MIN\_BAT\_KW\_AC\_HI}})\ \{}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}{TOPIC\_PACC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ R\_FLOAT\ AC\ switch\ true\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.pv\_bias\ =\ \mbox{\hyperlink{energy_8h_abb832d8acc3779b9d179bc5577a3787d}{PV\_BIAS}};}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__rec_8c_ab3219c1d482ea970a00a713bc9631eb6}{fm80\_float}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a53eae320dbcd86f620fa75b630f13c79}{R\_RUN}}:}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.R\ =\ \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a53eae320dbcd86f620fa75b630f13c79}{R\_RUN}};}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.no\_float\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00626\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ main\ state-\/machine\ update\ sequence\ and\ control\ logic}}
\DoxyCodeLine{00627\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00629\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ check\ for\ idle/data\ errors\ flags\ from\ sensors\ and\ HA}}
\DoxyCodeLine{00630\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.data\_error)\ \{}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bsoc_8c_a49c1e06b8059a63a9ed7c7d729e59d90}{bsoc\_set\_mode}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.pv\_bias,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_delay++\ >=\ \mbox{\hyperlink{energy_8h_a5b916c6432aad3657a5787da32a7a086}{GTI\_DELAY}})\ \{}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ gti\_str[\mbox{\hyperlink{energy_8h_a6d4040fa8211c8fdb91258c7a0fbe994}{SBUF\_SIZ}}];}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ error\_drive;}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00638\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ reset\ the\ control\ mode\ from\ simple\ switched\ power\ to\ PID\ control}}
\DoxyCodeLine{00639\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.in\_pid\_control)\ \{}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ usleep(100000);\ \textcolor{comment}{//\ wait}}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}{TOPIC\_PACC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.pv\_bias\ =\ \mbox{\hyperlink{energy_8h_abb832d8acc3779b9d179bc5577a3787d}{PV\_BIAS}};}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ in\_pid\_mode\ AC/DC\ switch\ true\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__rec_8c_ab3219c1d482ea970a00a713bc9631eb6}{fm80\_float}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{mqtt__rec_8c_ab3219c1d482ea970a00a713bc9631eb6}{fm80\_float}}(\textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.pv\_bias\ =\ (int32\_t)\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.error\ -\/\ \mbox{\hyperlink{energy_8h_abb832d8acc3779b9d179bc5577a3787d}{PV\_BIAS}};}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00655\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ use\ PID\ style\ set-\/point\ error\ correction}}
\DoxyCodeLine{00656\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.in\_pid\_control\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_delay\ =\ 0;}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00660\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ adjust\ power\ balance\ if\ battery\ charging\ energy\ is\ low}}
\DoxyCodeLine{00661\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072acbf8b0bfb8d6b7f05e44120ab817a788}{V\_DPBAT}}]\ >\ \mbox{\hyperlink{energy_8h_ae8e7f559c64b5c3fced213da7eced7da}{PV\_DL\_BIAS\_RATE}})\ \{}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_drive\ =\ (int32\_t)\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.error\ -\/\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.pv\_bias;\ \textcolor{comment}{//\ PI\ feedback\ control\ signal}}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_drive\ =\ (int32\_t)\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.error\ -\/\ \mbox{\hyperlink{energy_8h_ad478547f5632a840af219749a4e22e79}{PV\_BIAS\_RATE}};}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00668\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ when\ main\ battery\ is\ in\ float,\ crank-\/up\ the\ power\ draw\ from\ the\ solar\ panels}}
\DoxyCodeLine{00669\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mqtt__rec_8c_ab3219c1d482ea970a00a713bc9631eb6}{fm80\_float}}(\textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_drive\ =\ (int32\_t)\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.error\ +\ \mbox{\hyperlink{energy_8h_abb832d8acc3779b9d179bc5577a3787d}{PV\_BIAS}});}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00674\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ don't\ drive\ to\ zero\ power}}
\DoxyCodeLine{00675\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (error\_drive\ <\ 0)\ \{}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_drive\ =\ \mbox{\hyperlink{energy_8h_a72a8935085093a655db2a9c36bc7a419}{PV\_BIAS\_LOW}};\ \textcolor{comment}{//\ control\ wide\ power\ swings}}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{mqtt__rec_8c_a218d78ec87cc0f9067283f98bace529f}{fm80\_sleep}}())\ \{\ \textcolor{comment}{//\ check\ for\ using\ sleep\ bias}}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a821ba4dacc502ba41ec0c17aff5c42d3}{V\_FBEKW}}]\ >\ \mbox{\hyperlink{energy_8h_a10405061b85ae1918bd02d110e958920}{MIN\_BAT\_KW\_BSOC\_SLP}})\ \&\&\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072ad5c883c864f682ae706402bbcbe385cf}{V\_PWA}}]\ >\ \mbox{\hyperlink{energy_8h_aa0fd7bf782c78012ac9a5e7defb1bbc9}{PWA\_SLEEP}}))\ \{}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_drive\ =\ \mbox{\hyperlink{energy_8h_a1fc05643e83a06afc4a0522013007589}{PV\_BIAS\_SLEEP}};\ \textcolor{comment}{//\ use\ higher\ power\ when\ we\ still\ have\ sun\ for\ better\ inverter\ efficiency}}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00686\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ reduce\ charging/diversion\ power\ to\ safe\ PS\ limits}}
\DoxyCodeLine{00687\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.dl\_mqtt\_max\ >\ \mbox{\hyperlink{energy_8h_afb56edb8a8e45a993924e0582035e7f3}{PV\_DL\_MPTT\_MAX}})\ \{}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess)\ \{}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_drive\ =\ \mbox{\hyperlink{energy_8h_a7aaac0669e9aba0830f4d4180ba932ab}{PV\_DL\_MPTT\_IDLE}};}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.dl\_mqtt\_max\ >\ \mbox{\hyperlink{energy_8h_a8948540a345057786acbc6b5347157b5}{PV\_DL\_MPTT\_EXCESS}})\ \{}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_drive\ =\ \mbox{\hyperlink{energy_8h_a7aaac0669e9aba0830f4d4180ba932ab}{PV\_DL\_MPTT\_IDLE}};}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess)\ \{}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_drive\ =\ \mbox{\hyperlink{energy_8h_a821e3aa59b88068f6ee5d1b8a922bd43}{PV\_DL\_EXCESS}}\ +\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess\_adj;}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00701\ }
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00703\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ shutdown\ GTI\ power\ at\ low\ DL\ battery\ Ah\ or\ Voltage}}
\DoxyCodeLine{00704\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a79eef89bbb62af24bc79c04f29d0ad97}{V\_DAHBAT}}]\ <\ \mbox{\hyperlink{energy_8h_aa475e97af32e6972baba4dd1a61f48df}{PV\_DL\_B\_AH\_LOW}})\ ||\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a313329bdfc449d61aa60f11b31432e1f}{V\_DVBAT}}]\ <\ \mbox{\hyperlink{energy_8h_a536a0eb3b3062d965ce65b5972f6f84e}{PV\_DL\_B\_V\_LOW}}))\ \{}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_drive\ =\ \mbox{\hyperlink{energy_8h_a49ebc838f3910dacd095678db5c985f7}{PV\_BIAS\_ZERO}};}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00708\ }
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(gti\_str,\ \mbox{\hyperlink{energy_8h_a6d4040fa8211c8fdb91258c7a0fbe994}{SBUF\_SIZ}}\ -\/\ 1,\ \textcolor{stringliteral}{"{}V\%04dX"{}},\ error\_drive);\ \textcolor{comment}{//\ format\ for\ dumpload\ controller\ gti\ power\ commands}}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_a3fc1eb9cd6b570d96277f671de9e979a}{mqtt\_gti\_power}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a8170bc07eb3b7f53bb8bfea780ebfdd8}{TOPIC\_P}},\ gti\_str,\ 2);}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \textcolor{preprocessor}{\#ifndef\ \ FAKE\_VPV}}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mqtt__rec_8c_ab3219c1d482ea970a00a713bc9631eb6}{fm80\_float}}(\textcolor{keyword}{true})\ ||\ ((\mbox{\hyperlink{bsoc_8c_a4ec0fe226796da34c999530046265c3a}{ac1\_filter}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a47acb84856d0db6447de2c99171d654d}{V\_BEN}}])\ >\ \mbox{\hyperlink{energy_8h_a8996e9908d95419bf7493943eb495da1}{BAL\_MAX\_ENERGY\_AC}})\ \&\&\ (\mbox{\hyperlink{bsoc_8c_a413c5066cb43aae0039adba36593129a}{ac\_test}}()\ >\ \mbox{\hyperlink{energy_8h_acba28bf1765e9924790cc957b23ece2f}{MIN\_BAT\_KW\_AC\_HI}})))\ \{}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a28b7bbb5fe37666136a84c7cded51e2e}{ramp\_up\_ac}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_on);\ \textcolor{comment}{//\ use\ once\ control}}
\DoxyCodeLine{00716\ \textcolor{preprocessor}{\#ifdef\ PSW\_DEBUG}}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ MIN\_BAT\_KW\_AC\_HI\ AC\ switch\ \%d\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_on);}
\DoxyCodeLine{00718\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_on\ =\ \textcolor{keyword}{false};\ \textcolor{comment}{//\ once\ flag}}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00721\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (((\mbox{\hyperlink{bsoc_8c_aa933af2d3df8ce390f6f95900df4b525}{ac2\_filter}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a47acb84856d0db6447de2c99171d654d}{V\_BEN}}])\ <\ \mbox{\hyperlink{energy_8h_a83055b2860263c3ebcea7deaaf48f0cf}{BAL\_MIN\_ENERGY\_AC}})\ ||\ ((\mbox{\hyperlink{bsoc_8c_a413c5066cb43aae0039adba36593129a}{ac\_test}}()\ <\ (\mbox{\hyperlink{energy_8h_acf488256aa0ed5070518a3e3e66400eb}{MIN\_BAT\_KW\_AC\_LO}}\ +\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_low\_adj)))))\ \{}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{mqtt__rec_8c_ab3219c1d482ea970a00a713bc9631eb6}{fm80\_float}}(\textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a92077e5f551e509dad279a8d2be4b21d}{ramp\_down\_ac}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_on);}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_ae7020228b3ccca216927caec73938554}{log\_timer}}())\ \{}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ RAMP\ DOWN\ AC,\ MIN\_BAT\_KW\_AC\_LO\ AC\ switch\ \%d\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_on);}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_on\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00731\ }
\DoxyCodeLine{00732\ }
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00734\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ Dump\ Load\ Excess\ testing}}
\DoxyCodeLine{00735\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ send\ excess\ power\ into\ the\ home\ power\ grid\ taking\ care\ not\ to\ export\ energy\ to\ the\ utility\ grid}}
\DoxyCodeLine{00736\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (((\mbox{\hyperlink{bsoc_8c_a623a5ccd411eeeba8acd1132a33a15e8}{dc1\_filter}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a47acb84856d0db6447de2c99171d654d}{V\_BEN}}])\ >\ \mbox{\hyperlink{energy_8h_a6c83f780e5e47e63325d47269958403e}{BAL\_MAX\_ENERGY\_GTI}})\ \&\&\ (\mbox{\hyperlink{bsoc_8c_ade03000a21b56a5527367c81e7219c99}{gti\_test}}()\ >\ \mbox{\hyperlink{energy_8h_a05cb74467763c662c93c0197d2ebb502}{MIN\_BAT\_KW\_GTI\_HI}}))\ ||\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess)\ \{}
\DoxyCodeLine{00738\ \textcolor{preprocessor}{\#ifndef\ \ FAKE\_VPV\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00739\ \textcolor{preprocessor}{\#ifdef\ B\_DLE\_DEBUG}}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess)\ \{}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ DL\ excess\ ramp\_up\_gti,\ DC\ switch\ \%d\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_on);}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00743\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aaa8441f14022457063db591bed50fe62}{ramp\_up\_gti}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_on,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess);}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_ae7020228b3ccca216927caec73938554}{log\_timer}}())\ \{}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ RAMP\ DOWN\ DC,\ MIN\_BAT\_KW\_GTI\_HI\ DC\ switch\ \%d\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_on);}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_on\ =\ \textcolor{keyword}{false};\ \textcolor{comment}{//\ once\ flag}}
\DoxyCodeLine{00749\ \textcolor{preprocessor}{\#endif\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{bsoc_8c_a4846561257bfbb8d753328d1fe7a1c07}{dc2\_filter}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a47acb84856d0db6447de2c99171d654d}{V\_BEN}}])\ <\ \mbox{\hyperlink{energy_8h_a42beedc428820d4934ee117f71e382c8}{BAL\_MIN\_ENERGY\_GTI}})\ ||\ (\mbox{\hyperlink{bsoc_8c_ade03000a21b56a5527367c81e7219c99}{gti\_test}}()\ <\ (\mbox{\hyperlink{energy_8h_a26d8cf1cdbb4c06adfe113dcfc99d002}{MIN\_BAT\_KW\_GTI\_LO}}\ +\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_low\_adj)))\ \{}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess)\ \{}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_ae7020228b3ccca216927caec73938554}{log\_timer}}())\ \{}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aa02b759a5ba02eb2d0083c02dcbe4834}{ramp\_down\_gti}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00755\ \textcolor{preprocessor}{\#ifdef\ PSW\_DEBUG}}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ MIN\_BAT\_KW\_GTI\_LO\ DC\ switch\ \%d\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_on);}
\DoxyCodeLine{00757\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_on\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \textcolor{preprocessor}{\#ifdef\ B\_ADJ\_DEBUG}}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\ LO\ ADJ:\ AC\ \%8.2fWh,\ GTI\ \%8.2fWh\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8h_acf488256aa0ed5070518a3e3e66400eb}{MIN\_BAT\_KW\_AC\_LO}}\ +\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_low\_adj,\ \mbox{\hyperlink{energy_8h_a26d8cf1cdbb4c06adfe113dcfc99d002}{MIN\_BAT\_KW\_GTI\_LO}}\ +\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_low\_adj);}
\DoxyCodeLine{00767\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00768\ \textcolor{preprocessor}{\#ifdef\ B\_DLE\_DEBUG}}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess)\ \{}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ DL\ excess\ vars\ from\ ha\_energy\ \%d\ \%d\ :\ Flag\ \%d\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.con4,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.con5,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess);}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00772\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00773\ }
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \ \ \ \ time(\&rawtime);}
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.im\_delay++\ >=\ \mbox{\hyperlink{energy_8h_a18b5f37719f22d3f499db9ec0370f9b6}{IM\_DELAY}})\ \{}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.im\_delay\ =\ 0;}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8h_a34d485627939300ea5e51b765f599b9a}{iammeter\_read}}();}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.im\_display++\ >=\ \mbox{\hyperlink{energy_8h_acd44706ab6bf5f575743818ab69a0cd4}{IM\_DISPLAY}})\ \{}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ buffer[\mbox{\hyperlink{energy_8h_a52c3aaa9470287b78eee2ca241454fcb}{SYSLOG\_SIZ}}];}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ len;}
\DoxyCodeLine{00783\ }
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.im\_display\ =\ 0;}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_aca0d9fca85baa3d4690a22e16e1b53ce}{mqtt\_ha\_pid}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a5ec6c2a3e382c3bc460c59010e1287a4}{TOPIC\_PPID}});}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.fm80\ \&\&\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dumpload\ \&\&\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.iammeter))\ \{}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.iammeter)\ \{}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.iammeter\_error++;}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.mqtt\_error++;}
\DoxyCodeLine{00791\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.shutdown++;}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\%s\ !!!!\ Source\ data\ update\ error\ !!!!\ ,\ check\ FM80\ \%i,\ DUMPLOAD\ \%i,\ IAMMETER\ \%i\ channels\ M\ \%u,\%u\ I\ \%u,\%u\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.fm80,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dumpload,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.fm80,}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.mqtt\_count,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.mqtt\_error,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.iammeter\_count,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.iammeter\_error);}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(buffer,\ \mbox{\hyperlink{energy_8h_a52c3aaa9470287b78eee2ca241454fcb}{SYSLOG\_SIZ}}\ -\/\ 1,\ \textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\%s\ !!!!\ Source\ data\ update\ error\ !!!!\ ,\ check\ FM80\ \%i,\ DUMPLOAD\ \%i,\ IAMMETER\ \%i\ channels\ M\ \%u,\%u\ I\ \%u,\%u\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.fm80,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dumpload,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.fm80,}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.mqtt\_count,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.mqtt\_error,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.iammeter\_count,\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.iammeter\_error);}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ syslog(LOG\_NOTICE,\ buffer);}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_a8cae358dc3a23f274454a9dc9d10443e}{mqtt\_ha\_shutdown}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_ac1a01dc509505d2a44781caffa5c071a}{TOPIC\_SHUTDOWN}});}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.data\_error\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.data\_error\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.shutdown\ =\ 0;}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(buffer,\ \mbox{\hyperlink{energy_8h_a0c85192a1fc4b17a7c63d0c0f6f61625}{RBUF\_SIZ}}\ -\/\ 1,\ \textcolor{stringliteral}{"{}\%s"{}},\ ctime(\&rawtime));}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ len\ =\ strlen(buffer);}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buffer[len\ -\/\ 1]\ =\ 0;\ \textcolor{comment}{//\ munge\ out\ the\ return\ character}}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ "{}},\ buffer);}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.fm80\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dumpload\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.homeassistant\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.iammeter\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_a2533146394b65b382653eff2cd6f2106}{sync\_ha}}();}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8h_a8b0aebb679cfaa2c1c7f70e477e396a5}{print\_im\_vars}}();}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8h_a7ce8be1d4c8d4c9881d482bed4933512}{print\_mvar\_vars}}();}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\(\backslash\)r"{}},\ ctime(\&rawtime));}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.E\ =\ \mbox{\hyperlink{energy_8h_a3b2b2ba876738909ea41ffc29311415faa19a96871d41a61ea3b7b279f5d4b1d6}{E\_WAIT}};}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.con6)\ \{}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.R\ =\ \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a63581c61e8680cb3c6be0310a4e19e81}{R\_IDLE}};}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.con7)\ \{}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.E\ =\ \mbox{\hyperlink{energy_8h_a3b2b2ba876738909ea41ffc29311415fa4d5e6303dba6960140ca6bf4bab1e5ac}{E\_STOP}};}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{energy_8h_a3b2b2ba876738909ea41ffc29311415fa4d5e6303dba6960140ca6bf4bab1e5ac}{E\_STOP}}:}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\%s\ HA\ Energy\ stopped\ and\ exited.\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}));}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00836\ \ \ \ \ \}}
\DoxyCodeLine{00837\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{energy_8c_a0ddf1224851353fc92bfbff6f499fa97_cgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a92077e5f551e509dad279a8d2be4b21d}\index{energy.c@{energy.c}!ramp\_down\_ac@{ramp\_down\_ac}}
\index{ramp\_down\_ac@{ramp\_down\_ac}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ramp\_down\_ac()}{ramp\_down\_ac()}}
{\footnotesize\ttfamily \label{energy_8c_a92077e5f551e509dad279a8d2be4b21d} 
void ramp\+\_\+down\+\_\+ac (\begin{DoxyParamCaption}\item[{MQTTClient}]{client\+\_\+p}{, }\item[{bool}]{sw\+\_\+off}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00937\ \{}
\DoxyCodeLine{00938\ \ \ \ \ \textcolor{keywordflow}{if}\ (sw\_off)\ \{}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(client\_p,\ \mbox{\hyperlink{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}{TOPIC\_PACC}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ usleep(500000);}
\DoxyCodeLine{00942\ \ \ \ \ \}}
\DoxyCodeLine{00943\ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_ac\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00944\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_a92077e5f551e509dad279a8d2be4b21d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{energy_8c_a92077e5f551e509dad279a8d2be4b21d_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_aa02b759a5ba02eb2d0083c02dcbe4834}\index{energy.c@{energy.c}!ramp\_down\_gti@{ramp\_down\_gti}}
\index{ramp\_down\_gti@{ramp\_down\_gti}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ramp\_down\_gti()}{ramp\_down\_gti()}}
{\footnotesize\ttfamily \label{energy_8c_aa02b759a5ba02eb2d0083c02dcbe4834} 
void ramp\+\_\+down\+\_\+gti (\begin{DoxyParamCaption}\item[{MQTTClient}]{client\+\_\+p}{, }\item[{bool}]{sw\+\_\+off}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00904\ \{}
\DoxyCodeLine{00905\ \ \ \ \ \textcolor{keywordflow}{if}\ (sw\_off)\ \{}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\_zero\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00909\ \ \ \ \ \}}
\DoxyCodeLine{00910\ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00911\ }
\DoxyCodeLine{00912\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\_zero)\ \{}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_a3fc1eb9cd6b570d96277f671de9e979a}{mqtt\_gti\_power}}(client\_p,\ \mbox{\hyperlink{energy_8h_a8170bc07eb3b7f53bb8bfea780ebfdd8}{TOPIC\_P}},\ \textcolor{stringliteral}{"{}Z\#"{}},\ 7);\ \textcolor{comment}{//\ zero\ power}}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\_zero\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00915\ \ \ \ \ \}}
\DoxyCodeLine{00916\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_aa02b759a5ba02eb2d0083c02dcbe4834_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{energy_8c_aa02b759a5ba02eb2d0083c02dcbe4834_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a28b7bbb5fe37666136a84c7cded51e2e}\index{energy.c@{energy.c}!ramp\_up\_ac@{ramp\_up\_ac}}
\index{ramp\_up\_ac@{ramp\_up\_ac}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ramp\_up\_ac()}{ramp\_up\_ac()}}
{\footnotesize\ttfamily \label{energy_8c_a28b7bbb5fe37666136a84c7cded51e2e} 
void ramp\+\_\+up\+\_\+ac (\begin{DoxyParamCaption}\item[{MQTTClient}]{client\+\_\+p}{, }\item[{bool}]{start}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00922\ \{}
\DoxyCodeLine{00923\ }
\DoxyCodeLine{00924\ \ \ \ \ \textcolor{keywordflow}{if}\ (start)\ \{}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_ac\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00926\ \ \ \ \ \}}
\DoxyCodeLine{00927\ }
\DoxyCodeLine{00928\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_ac)\ \{}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_ac\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(client\_p,\ \mbox{\hyperlink{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}{TOPIC\_PACC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ usleep(500000);\ \textcolor{comment}{//\ wait\ for\ voltage\ to\ ramp}}
\DoxyCodeLine{00933\ \ \ \ \ \}}
\DoxyCodeLine{00934\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_a28b7bbb5fe37666136a84c7cded51e2e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=233pt]{energy_8c_a28b7bbb5fe37666136a84c7cded51e2e_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_aaa8441f14022457063db591bed50fe62}\index{energy.c@{energy.c}!ramp\_up\_gti@{ramp\_up\_gti}}
\index{ramp\_up\_gti@{ramp\_up\_gti}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ramp\_up\_gti()}{ramp\_up\_gti()}}
{\footnotesize\ttfamily \label{energy_8c_aaa8441f14022457063db591bed50fe62} 
void ramp\+\_\+up\+\_\+gti (\begin{DoxyParamCaption}\item[{MQTTClient}]{client\+\_\+p}{, }\item[{bool}]{start}{, }\item[{bool}]{excess}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00843\ \{}
\DoxyCodeLine{00844\ \ \ \ \ \textcolor{keyword}{static}\ uint32\_t\ sequence\ =\ 0;}
\DoxyCodeLine{00845\ }
\DoxyCodeLine{00846\ \ \ \ \ \textcolor{keywordflow}{if}\ (start)\ \{}
\DoxyCodeLine{00847\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00848\ \ \ \ \ \}}
\DoxyCodeLine{00849\ }
\DoxyCodeLine{00850\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti)\ \{}
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ sequence\ =\ 0;}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!excess)\ \{}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ \ \ \ \ usleep(500000);\ \textcolor{comment}{//\ wait\ for\ voltage\ to\ ramp}}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \ \ \ \ sequence\ =\ 1;}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00860\ \ \ \ \ \}}
\DoxyCodeLine{00861\ }
\DoxyCodeLine{00862\ \ \ \ \ \textcolor{keywordflow}{switch}\ (sequence)\ \{}
\DoxyCodeLine{00863\ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\_zero\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00866\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00867\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00868\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\_zero\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{bsoc_8c_a4ff1d7778a0780a0f1c029a738322513}{bat\_current\_stable}}()\ ||\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dl\_excess)\ \{\ \textcolor{comment}{//\ check\ battery\ current\ std\ dev,\ stop\ 'motorboating'}}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \ \ \ \ sequence++;}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{mqtt__vars_8c_a3fc1eb9cd6b570d96277f671de9e979a}{mqtt\_gti\_power}}(client\_p,\ \mbox{\hyperlink{energy_8h_a8170bc07eb3b7f53bb8bfea780ebfdd8}{TOPIC\_P}},\ \textcolor{stringliteral}{"{}+\#"{}},\ 3))\ \{}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sequence\ =\ 0;}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ \ \ \};\ \textcolor{comment}{//\ +100W\ power}}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ \ \ usleep(500000);\ \textcolor{comment}{//\ wait\ a\ bit\ more\ for\ power\ to\ be\ stable}}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ \ \ sequence\ =\ 1;\ \textcolor{comment}{//\ do\ power\ ramps\ when\ ready}}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{mqtt__vars_8c_a3fc1eb9cd6b570d96277f671de9e979a}{mqtt\_gti\_power}}(client\_p,\ \mbox{\hyperlink{energy_8h_a8170bc07eb3b7f53bb8bfea780ebfdd8}{TOPIC\_P}},\ \textcolor{stringliteral}{"{}-\/\#"{}},\ 4))\ \{}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sequence\ =\ 0;}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \ \ \ \ \};\ \textcolor{comment}{//\ -\/\ 100W\ power}}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00883\ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ sequence++;}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\_zero)\ \{}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_a3fc1eb9cd6b570d96277f671de9e979a}{mqtt\_gti\_power}}(client\_p,\ \mbox{\hyperlink{energy_8h_a8170bc07eb3b7f53bb8bfea780ebfdd8}{TOPIC\_P}},\ \textcolor{stringliteral}{"{}Z\#"{}},\ 5);\ \textcolor{comment}{//\ zero\ power}}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\_zero\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00890\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\_zero)\ \{}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_a3fc1eb9cd6b570d96277f671de9e979a}{mqtt\_gti\_power}}(client\_p,\ \mbox{\hyperlink{energy_8h_a8170bc07eb3b7f53bb8bfea780ebfdd8}{TOPIC\_P}},\ \textcolor{stringliteral}{"{}Z\#"{}},\ 6);\ \textcolor{comment}{//\ zero\ power}}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.once\_gti\_zero\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ sequence\ =\ 0;}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00897\ \ \ \ \ \}}
\DoxyCodeLine{00898\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_aaa8441f14022457063db591bed50fe62_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=234pt]{energy_8c_aaa8441f14022457063db591bed50fe62_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a014b7e7feb1f7f94f1947d2961e58534}\index{energy.c@{energy.c}!sanity\_check@{sanity\_check}}
\index{sanity\_check@{sanity\_check}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{sanity\_check()}{sanity\_check()}}
{\footnotesize\ttfamily \label{energy_8c_a014b7e7feb1f7f94f1947d2961e58534} 
bool sanity\+\_\+check (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00254\ \{}
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072ad5c883c864f682ae706402bbcbe385cf}{V\_PWA}}]\ >\ \mbox{\hyperlink{energy_8h_a1080c8ca712e9dc1addd48d9ae40b007}{PWA\_SANE}})\ \{}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.sane\ =\ \mbox{\hyperlink{energy_8h_a5c579d778e1576fd9ae67c1cc7e81ee7af1d6fa8de1e28a2b6d8539f3b98fce4e}{S\_PWA}};}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00258\ \ \ \ \ \}}
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a3c4c2533613529ed910d3b0698e89335}{V\_PAMPS}}]\ >\ \mbox{\hyperlink{energy_8h_abdf0a79062ee811bfb1da544d1876e67}{PAMPS\_SANE}})\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.sane\ =\ \mbox{\hyperlink{energy_8h_a5c579d778e1576fd9ae67c1cc7e81ee7a25f0992e8e1881acf87ad1beb51150b8}{S\_PAMPS}};}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00262\ \ \ \ \ \}}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072aaf767b3b90d0f2566062e8ea9aa77d74}{V\_PVOLTS}}]\ >\ \mbox{\hyperlink{energy_8h_aa92d0d3c6e77fb8c158bd4c098ad07ac}{PVOLTS\_SANE}})\ \{}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.sane\ =\ \mbox{\hyperlink{energy_8h_a5c579d778e1576fd9ae67c1cc7e81ee7a240ee28d7f55ca0e4a3c4b29f06c4e21}{S\_PVOLTS}};}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00266\ \ \ \ \ \}}
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a9f8ddad7002f6868f6bf77c46b11e686}{V\_FBAMPS}}]\ >\ \mbox{\hyperlink{energy_8h_a36849bf632f6907ce2826cf4f4f7f70a}{BAMPS\_SANE}})\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.sane\ =\ \mbox{\hyperlink{energy_8h_a5c579d778e1576fd9ae67c1cc7e81ee7a3ba317a28cd9bbd8a72e138b88fe8d7a}{S\_FBAMPS}};}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00270\ \ \ \ \ \}}
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00272\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=237pt]{energy_8c_a014b7e7feb1f7f94f1947d2961e58534_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a0e3152830cd54954f6745ba7ae42ff42}\index{energy.c@{energy.c}!showIP@{showIP}}
\index{showIP@{showIP}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{showIP()}{showIP()}}
{\footnotesize\ttfamily \label{energy_8c_a0e3152830cd54954f6745ba7ae42ff42} 
void show\+IP (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00160\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keyword}{struct\ }ifaddrs\ *ifaddr,\ *ifa;}
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{keywordtype}{int}\ s;}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordtype}{char}\ host[NI\_MAXHOST];}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{keywordflow}{if}\ (getifaddrs(\&ifaddr)\ ==\ -\/1)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ perror(\textcolor{stringliteral}{"{}getifaddrs"{}});}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00168\ \ \ \ \ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordflow}{for}\ (ifa\ =\ ifaddr;\ ifa\ !=\ NULL;\ ifa\ =\ ifa-\/>ifa\_next)\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ifa-\/>ifa\_addr\ ==\ NULL)}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ s\ =\ getnameinfo(ifa-\/>ifa\_addr,\ \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct}\ sockaddr\_in),\ host,\ NI\_MAXHOST,\ NULL,\ 0,\ NI\_NUMERICHOST);}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ifa-\/>ifa\_addr-\/>sa\_family\ ==\ AF\_INET)\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s\ !=\ 0)\ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)tInterface\ :\ <\%s>\(\backslash\)n"{}},\ ifa-\/>ifa\_name);}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)t\ \ Address\ :\ <\%s>\(\backslash\)n"{}},\ host);}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00184\ \ \ \ \ \}}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \ \ freeifaddrs(ifaddr);}
\DoxyCodeLine{00187\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=208pt]{energy_8c_a0e3152830cd54954f6745ba7ae42ff42_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_ac6b8bef7c0921e591a31d844e13d24e8}\index{energy.c@{energy.c}!skeleton\_daemon@{skeleton\_daemon}}
\index{skeleton\_daemon@{skeleton\_daemon}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{skeleton\_daemon()}{skeleton\_daemon()}}
{\footnotesize\ttfamily \label{energy_8c_ac6b8bef7c0921e591a31d844e13d24e8} 
void skeleton\+\_\+daemon (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00194\ \{}
\DoxyCodeLine{00195\ \ \ \ \ pid\_t\ pid;}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{comment}{/*\ Fork\ off\ the\ parent\ process\ */}}
\DoxyCodeLine{00198\ \ \ \ \ pid\ =\ fork();}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{comment}{/*\ An\ error\ occurred\ */}}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordflow}{if}\ (pid\ <\ 0)\ \{}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n\%sDAEMON\ failure\ \ LOG\ Version\ \%s\ :\ MQTT\ Version\ \%s\(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ \mbox{\hyperlink{energy_8h_aa48b2017856a8a9c33a9935afe604c8d}{LOG\_VERSION}},\ \mbox{\hyperlink{energy_8h_a702197a21870dfd505d92530b27754ac}{MQTT\_VERSION}});}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00204\ \ \ \ \ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{comment}{/*\ Success:\ Let\ the\ parent\ terminate\ */}}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keywordflow}{if}\ (pid\ >\ 0)\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ exit(EXIT\_SUCCESS);}
\DoxyCodeLine{00209\ \ \ \ \ \}}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \ \ \textcolor{comment}{/*\ On\ success:\ The\ child\ process\ becomes\ session\ leader\ */}}
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keywordflow}{if}\ (setsid()\ <\ 0)\ \{}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00214\ \ \ \ \ \}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{comment}{/*\ Catch,\ ignore\ and\ handle\ signals\ */}}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{comment}{/*TODO:\ Implement\ a\ working\ signal\ handler\ */}}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{comment}{//\ \ \ \ signal(SIGCHLD,\ SIG\_IGN);}}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{comment}{//\ \ \ \ signal(SIGHUP,\ SIG\_IGN);}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{comment}{/*\ Fork\ off\ for\ the\ second\ time*/}}
\DoxyCodeLine{00222\ \ \ \ \ pid\ =\ fork();}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{comment}{/*\ An\ error\ occurred\ */}}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordflow}{if}\ (pid\ <\ 0)\ \{}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00227\ \ \ \ \ \}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{comment}{/*\ Success:\ Let\ the\ parent\ terminate\ */}}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keywordflow}{if}\ (pid\ >\ 0)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ exit(EXIT\_SUCCESS);}
\DoxyCodeLine{00232\ \ \ \ \ \}}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{comment}{/*\ Set\ new\ file\ permissions\ */}}
\DoxyCodeLine{00235\ \ \ \ \ umask(0);}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{comment}{/*\ Change\ the\ working\ directory\ to\ the\ root\ directory\ */}}
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{comment}{/*\ or\ another\ appropriated\ directory\ */}}
\DoxyCodeLine{00239\ \ \ \ \ chdir(\textcolor{stringliteral}{"{}/"{}});}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{comment}{/*\ Close\ all\ open\ file\ descriptors\ */}}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordtype}{int}\ x;}
\DoxyCodeLine{00243\ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ sysconf(\_SC\_OPEN\_MAX);\ x\ >=\ 0;\ x-\/-\/)\ \{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ close(x);}
\DoxyCodeLine{00245\ \ \ \ \ \}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_ac6b8bef7c0921e591a31d844e13d24e8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=260pt]{energy_8c_ac6b8bef7c0921e591a31d844e13d24e8_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a5db80d060a0e5e2905e748f97ce54f80}\index{energy.c@{energy.c}!solar\_shutdown@{solar\_shutdown}}
\index{solar\_shutdown@{solar\_shutdown}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{solar\_shutdown()}{solar\_shutdown()}}
{\footnotesize\ttfamily \label{energy_8c_a5db80d060a0e5e2905e748f97ce54f80} 
bool solar\+\_\+shutdown (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00977\ \{}
\DoxyCodeLine{00978\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ ret\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00979\ }
\DoxyCodeLine{00980\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.startup)\ \{}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ ret\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.startup\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00984\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ ret\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00986\ }
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00988\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ FIXME}}
\DoxyCodeLine{00989\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ }}
\DoxyCodeLine{00990\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00991\ \ \ \ \ \}}
\DoxyCodeLine{00992\ }
\DoxyCodeLine{00993\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.solar\_shutdown)\ \{}
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ ret\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00995\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00996\ \ \ \ \ \ \ \ \ ret\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00997\ \ \ \ \ \}}
\DoxyCodeLine{00998\ }
\DoxyCodeLine{00999\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a821ba4dacc502ba41ec0c17aff5c42d3}{V\_FBEKW}}]\ <\ \mbox{\hyperlink{energy_8h_a5a4b955055b337ef5f4f21af51eccb03}{BAT\_CRITICAL}})\ \&\&\ !\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.startup)\ \{\ \textcolor{comment}{//\ special\ case\ for\ low\ battery}}
\DoxyCodeLine{01000\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.bat\_crit)\ \{}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \ \ \ \ ret\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01002\ \textcolor{preprocessor}{\#ifdef\ CRITIAL\_SHUTDOWN\_LOG}}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ Solar\ BATTERY\ CRITICAL\ shutdown\ comms\ check\ ret\ =\ \%d\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ ret);}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{01005\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.bat\_crit\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{01008\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01009\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mode.bat\_crit\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01011\ \ \ \ \ \}}
\DoxyCodeLine{01012\ }
\DoxyCodeLine{01013\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.shutdown\ >=\ \mbox{\hyperlink{energy_8h_a7c213cc89d01ec9cdbaa3356698a86ce}{MAX\_ERROR}})\ \{}
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ ret\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.fm80\ \&\&\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dumpload\ \&\&\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.iammeter)\ \{}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \ \ \ \ ret\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.link.shutdown\ =\ 0;}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01019\ }
\DoxyCodeLine{01020\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_SHUTDOWN}}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}\%s\ Solar\ shutdown\ comms\ check\ ret\ =\ \%d\ \(\backslash\)r\(\backslash\)n"{}},\ \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}),\ ret);}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{01023\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01024\ \ \ \ \ \}}
\DoxyCodeLine{01025\ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{01026\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_a5db80d060a0e5e2905e748f97ce54f80_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=250pt]{energy_8c_a5db80d060a0e5e2905e748f97ce54f80_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_a2533146394b65b382653eff2cd6f2106}\index{energy.c@{energy.c}!sync\_ha@{sync\_ha}}
\index{sync\_ha@{sync\_ha}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{sync\_ha()}{sync\_ha()}}
{\footnotesize\ttfamily \label{energy_8c_a2533146394b65b382653eff2cd6f2106} 
bool sync\+\_\+ha (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01062\ \{}
\DoxyCodeLine{01063\ \ \ \ \ \textcolor{keywordtype}{bool}\ sync\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01064\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status\ !=\ (\textcolor{keywordtype}{bool})\ ((int32\_t)\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a7391c358a2241e66cdf9f1e953184521}{V\_HDCSW}}]))\ \{}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}DC\_MM\ \%d\ \%d\ "{}},\ (\textcolor{keywordtype}{bool})\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status,\ (\textcolor{keywordtype}{bool})\ ((int32\_t)\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a7391c358a2241e66cdf9f1e953184521}{V\_HDCSW}}]));}
\DoxyCodeLine{01066\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}{TOPIC\_PDCC}},\ !\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.gti\_sw\_status);}
\DoxyCodeLine{01067\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dc\_mismatch\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01068\ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{01069\ \ \ \ \ \ \ \ \ sync\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01070\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01071\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.dc\_mismatch\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01072\ \ \ \ \ \}}
\DoxyCodeLine{01073\ }
\DoxyCodeLine{01074\ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status\ =\ (bool)\ ((int32\_t)\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a61c580ff6ce646f13228dc2dcad390c1}{V\_HACSW}}]);\ \textcolor{comment}{//\ TEMP\ FIX\ for\ MISmatch\ errors}}
\DoxyCodeLine{01075\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status\ !=\ (\textcolor{keywordtype}{bool})\ ((int32\_t)\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a61c580ff6ce646f13228dc2dcad390c1}{V\_HACSW}}]))\ \{}
\DoxyCodeLine{01076\ \ \ \ \ \ \ \ \ fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}},\ \textcolor{stringliteral}{"{}AC\_MM\ \%d\ \%d\ "{}},\ (\textcolor{keywordtype}{bool})\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status,\ (\textcolor{keywordtype}{bool})\ ((int32\_t)\ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.mvar[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a61c580ff6ce646f13228dc2dcad390c1}{V\_HACSW}}]));}
\DoxyCodeLine{01077\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mqtt__vars_8c_ae47064c42a63c93c8a775ba79a16f5d7}{mqtt\_ha\_switch}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.client\_p,\ \mbox{\hyperlink{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}{TOPIC\_PACC}},\ !\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_sw\_status);}
\DoxyCodeLine{01078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_mismatch\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01079\ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}});}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ sync\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01081\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ac\_mismatch\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01083\ \ \ \ \ \}}
\DoxyCodeLine{01084\ \ \ \ \ \textcolor{keywordflow}{return}\ sync;}
\DoxyCodeLine{01085\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8c_a2533146394b65b382653eff2cd6f2106_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=213pt]{energy_8c_a2533146394b65b382653eff2cd6f2106_icgraph}
\end{center}
\end{figure}
\Hypertarget{energy_8c_aa39b8400b702a022ed3aaa4940cf4e15}\index{energy.c@{energy.c}!timer\_callback@{timer\_callback}}
\index{timer\_callback@{timer\_callback}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{timer\_callback()}{timer\_callback()}}
{\footnotesize\ttfamily \label{energy_8c_aa39b8400b702a022ed3aaa4940cf4e15} 
void timer\+\_\+callback (\begin{DoxyParamCaption}\item[{int32\+\_\+t}]{signum}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00283\ \{}
\DoxyCodeLine{00284\ \ \ \ \ signal(signum,\ \mbox{\hyperlink{energy_8c_aa39b8400b702a022ed3aaa4940cf4e15}{timer\_callback}});}
\DoxyCodeLine{00285\ \ \ \ \ \mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\_flag\_vars\_ss}}.runner\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00286\ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.ten\_sec\_clock++;}
\DoxyCodeLine{00287\ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.log\_spam++;}
\DoxyCodeLine{00288\ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.log\_time\_reset++;}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.log\_spam\ >\ \mbox{\hyperlink{energy_8h_ab0b8ba6aa93ebd10e13799409927e3d5}{MAX\_LOG\_SPAM}})\ \{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.log\_spam\ =\ 0;}
\DoxyCodeLine{00291\ \ \ \ \ \}}
\DoxyCodeLine{00292\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=169pt]{energy_8c_aa39b8400b702a022ed3aaa4940cf4e15_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=246pt]{energy_8c_aa39b8400b702a022ed3aaa4940cf4e15_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\Hypertarget{energy_8c_ae54230f3933b19460113c7aeac29cec7}\index{energy.c@{energy.c}!board\_name@{board\_name}}
\index{board\_name@{board\_name}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{board\_name}{board\_name}}
{\footnotesize\ttfamily \label{energy_8c_ae54230f3933b19460113c7aeac29cec7} 
const char\texorpdfstring{$\ast$}{*} board\+\_\+name = "{}NO\+\_\+\+BOARD"{}}

\Hypertarget{energy_8c_aec275271b98c5dd5cbe9a33ea5081893}\index{energy.c@{energy.c}!driver\_name@{driver\_name}}
\index{driver\_name@{driver\_name}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{driver\_name}{driver\_name}}
{\footnotesize\ttfamily \label{energy_8c_aec275271b98c5dd5cbe9a33ea5081893} 
const char \texorpdfstring{$\ast$}{*} driver\+\_\+name = "{}NO\+\_\+\+DRIVER"{}}

\Hypertarget{energy_8c_aae3805c63e28abac1e41ffd7b623596e}\index{energy.c@{energy.c}!E@{E}}
\index{E@{E}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{E}{E}}
{\footnotesize\ttfamily \label{energy_8c_aae3805c63e28abac1e41ffd7b623596e} 
struct \mbox{\hyperlink{structenergy__type}{energy\+\_\+type}} E}


\begin{DoxyCode}{0}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00108\ \ \ \ \ .once\_gti\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00109\ \ \ \ \ .once\_ac\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00110\ \ \ \ \ .once\_gti\_zero\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00111\ \ \ \ \ .iammeter\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00112\ \ \ \ \ .fm80\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00113\ \ \ \ \ .dumpload\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00114\ \ \ \ \ .homeassistant\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00115\ \ \ \ \ .ac\_low\_adj\ =\ 0.0f,}
\DoxyCodeLine{00116\ \ \ \ \ .gti\_low\_adj\ =\ 0.0f,}
\DoxyCodeLine{00117\ \ \ \ \ .ac\_sw\_on\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00118\ \ \ \ \ .gti\_sw\_on\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00119\ \ \ \ \ .im\_delay\ =\ 0,}
\DoxyCodeLine{00120\ \ \ \ \ .gti\_delay\ =\ 0,}
\DoxyCodeLine{00121\ \ \ \ \ .im\_display\ =\ 0,}
\DoxyCodeLine{00122\ \ \ \ \ .rc\ =\ 0,}
\DoxyCodeLine{00123\ \ \ \ \ .speed\_go\ =\ 0,}
\DoxyCodeLine{00124\ \ \ \ \ .mode.pid.iMax\ =\ \mbox{\hyperlink{energy_8h_a34904b7b50e61da00fececcde810eed6}{PV\_IMAX}},}
\DoxyCodeLine{00125\ \ \ \ \ .mode.pid.iMin\ =\ 0.0f,}
\DoxyCodeLine{00126\ \ \ \ \ .mode.pid.pGain\ =\ \mbox{\hyperlink{energy_8h_add82739b7510bb56bf067db225588165}{PV\_PGAIN}},}
\DoxyCodeLine{00127\ \ \ \ \ .mode.pid.iGain\ =\ \mbox{\hyperlink{energy_8h_aeb2366dfac41f8b6c707e5f46ae12f42}{PV\_IGAIN}},}
\DoxyCodeLine{00128\ \ \ \ \ .mode.mode\_tmr\ =\ 0,}
\DoxyCodeLine{00129\ \ \ \ \ .mode.mode\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00130\ \ \ \ \ .mode.in\_pid\_control\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00131\ \ \ \ \ .mode.dl\_mqtt\_max\ =\ \mbox{\hyperlink{energy_8h_afb56edb8a8e45a993924e0582035e7f3}{PV\_DL\_MPTT\_MAX}},}
\DoxyCodeLine{00132\ \ \ \ \ .mode.E\ =\ \mbox{\hyperlink{energy_8h_a3b2b2ba876738909ea41ffc29311415fae5b17a6cbef319f39c92c567338e03ac}{E\_INIT}},}
\DoxyCodeLine{00133\ \ \ \ \ .mode.R\ =\ \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a3c0e911dee8c0c9acea4848d7493829e}{R\_INIT}},}
\DoxyCodeLine{00134\ \ \ \ \ .mode.no\_float\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00135\ \ \ \ \ .mode.data\_error\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00136\ \ \ \ \ .ac\_sw\_status\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00137\ \ \ \ \ .gti\_sw\_status\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00138\ \ \ \ \ .solar\_mode\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00139\ \ \ \ \ .solar\_shutdown\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00140\ \ \ \ \ .mode.pv\_bias\ =\ \mbox{\hyperlink{energy_8h_a72a8935085093a655db2a9c36bc7a419}{PV\_BIAS\_LOW}},}
\DoxyCodeLine{00141\ \ \ \ \ .sane\ =\ \mbox{\hyperlink{energy_8h_a5c579d778e1576fd9ae67c1cc7e81ee7a8ceda6b0a239be9845967fae9f846736}{S\_DLAST}},}
\DoxyCodeLine{00142\ \ \ \ \ .startup\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00143\ \ \ \ \ .ac\_mismatch\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00144\ \ \ \ \ .dc\_mismatch\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00145\ \ \ \ \ .mode\_mismatch\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00146\ \ \ \ \ .link.shutdown\ =\ 0,}
\DoxyCodeLine{00147\ \ \ \ \ .mode.bat\_crit\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00148\ \ \ \ \ .dl\_excess\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00149\ \ \ \ \ .dl\_excess\_adj\ =\ 0.0f,}
\DoxyCodeLine{00150\ \};}

\end{DoxyCode}
\Hypertarget{energy_8c_acec19516a59050bb447192fe318e6a9c}\index{energy.c@{energy.c}!fout@{fout}}
\index{fout@{fout}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{fout}{fout}}
{\footnotesize\ttfamily \label{energy_8c_acec19516a59050bb447192fe318e6a9c} 
FILE\texorpdfstring{$\ast$}{*} fout}

\Hypertarget{energy_8c_ab9a22fb7b17a1ebe54668d617b8d7226}\index{energy.c@{energy.c}!ha\_flag\_vars\_ha@{ha\_flag\_vars\_ha}}
\index{ha\_flag\_vars\_ha@{ha\_flag\_vars\_ha}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ha\_flag\_vars\_ha}{ha\_flag\_vars\_ha}}
{\footnotesize\ttfamily \label{energy_8c_ab9a22fb7b17a1ebe54668d617b8d7226} 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}} ha\+\_\+flag\+\_\+vars\+\_\+ha}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{\ \ \ \ .runner\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .receivedtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .deliveredtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .rec\_ok\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .ha\_id\ =\ \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ae3e04e0389b1b12a4cf2738165b4ce77}{HA\_ID}},}
\DoxyCodeLine{\ \ \ \ .var\_update\ =\ 0,}
\DoxyCodeLine{\}}

\end{DoxyCode}

\begin{DoxyCode}{0}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00093\ \ \ \ \ .runner\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00094\ \ \ \ \ .receivedtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00095\ \ \ \ \ .deliveredtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00096\ \ \ \ \ .rec\_ok\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00097\ \ \ \ \ .ha\_id\ =\ \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ae3e04e0389b1b12a4cf2738165b4ce77}{HA\_ID}},}
\DoxyCodeLine{00098\ \ \ \ \ .var\_update\ =\ 0,}
\DoxyCodeLine{00099\ \};}

\end{DoxyCode}
\Hypertarget{energy_8c_ae0a8ca490b1331a13666dbedf7175bd9}\index{energy.c@{energy.c}!ha\_flag\_vars\_pc@{ha\_flag\_vars\_pc}}
\index{ha\_flag\_vars\_pc@{ha\_flag\_vars\_pc}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ha\_flag\_vars\_pc}{ha\_flag\_vars\_pc}}
{\footnotesize\ttfamily \label{energy_8c_ae0a8ca490b1331a13666dbedf7175bd9} 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}} ha\+\_\+flag\+\_\+vars\+\_\+pc}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{\ \ \ \ .runner\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .receivedtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .deliveredtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .rec\_ok\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .ha\_id\ =\ \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a2d5f3027ac999fa6e1382a8fc85e48ba}{P8055\_ID}},}
\DoxyCodeLine{\ \ \ \ .var\_update\ =\ 0,}
\DoxyCodeLine{\}}

\end{DoxyCode}

\begin{DoxyCode}{0}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00062\ \ \ \ \ .runner\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00063\ \ \ \ \ .receivedtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00064\ \ \ \ \ .deliveredtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00065\ \ \ \ \ .rec\_ok\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00066\ \ \ \ \ .ha\_id\ =\ \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a2d5f3027ac999fa6e1382a8fc85e48ba}{P8055\_ID}},}
\DoxyCodeLine{00067\ \ \ \ \ .var\_update\ =\ 0,}
\DoxyCodeLine{00068\ \};}

\end{DoxyCode}
\Hypertarget{energy_8c_a04a99d06cea1265d7193a122288d83a0}\index{energy.c@{energy.c}!ha\_flag\_vars\_sd@{ha\_flag\_vars\_sd}}
\index{ha\_flag\_vars\_sd@{ha\_flag\_vars\_sd}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ha\_flag\_vars\_sd}{ha\_flag\_vars\_sd}}
{\footnotesize\ttfamily \label{energy_8c_a04a99d06cea1265d7193a122288d83a0} 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}} ha\+\_\+flag\+\_\+vars\+\_\+sd}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{\ \ \ \ .runner\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .receivedtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .deliveredtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .rec\_ok\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .ha\_id\ =\ \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ab5fb8e8dcac9113aa99bb13518a8eecb}{DUMPLOAD\_ID}},}
\DoxyCodeLine{\ \ \ \ .var\_update\ =\ 0,}
\DoxyCodeLine{\}}

\end{DoxyCode}

\begin{DoxyCode}{0}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00083\ \ \ \ \ .runner\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00084\ \ \ \ \ .receivedtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00085\ \ \ \ \ .deliveredtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00086\ \ \ \ \ .rec\_ok\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00087\ \ \ \ \ .ha\_id\ =\ \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ab5fb8e8dcac9113aa99bb13518a8eecb}{DUMPLOAD\_ID}},}
\DoxyCodeLine{00088\ \ \ \ \ .var\_update\ =\ 0,}
\DoxyCodeLine{00089\ \};}

\end{DoxyCode}
\Hypertarget{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}\index{energy.c@{energy.c}!ha\_flag\_vars\_ss@{ha\_flag\_vars\_ss}}
\index{ha\_flag\_vars\_ss@{ha\_flag\_vars\_ss}!energy.c@{energy.c}}
\doxysubsubsection{\texorpdfstring{ha\_flag\_vars\_ss}{ha\_flag\_vars\_ss}}
{\footnotesize\ttfamily \label{energy_8c_a300fe8f759de831a9cf50f5a86c85e23} 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}} ha\+\_\+flag\+\_\+vars\+\_\+ss}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{\ \ \ \ .runner\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .receivedtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .deliveredtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .rec\_ok\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{\ \ \ \ .ha\_id\ =\ \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a5f245782cbe7efbe181ea485eb5932a5}{FM80\_ID}},}
\DoxyCodeLine{\ \ \ \ .var\_update\ =\ 0,}
\DoxyCodeLine{\ \ \ \ .energy\_mode\ =\ \mbox{\hyperlink{energy_8h_a2e6d97095eb0e18b2a11eee97c1c67af}{NORM\_MODE}},}
\DoxyCodeLine{\}}

\end{DoxyCode}

\begin{DoxyCode}{0}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00072\ \ \ \ \ .runner\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00073\ \ \ \ \ .receivedtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00074\ \ \ \ \ .deliveredtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00075\ \ \ \ \ .rec\_ok\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00076\ \ \ \ \ .ha\_id\ =\ \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a5f245782cbe7efbe181ea485eb5932a5}{FM80\_ID}},}
\DoxyCodeLine{00077\ \ \ \ \ .var\_update\ =\ 0,}
\DoxyCodeLine{00078\ \ \ \ \ .energy\_mode\ =\ \mbox{\hyperlink{energy_8h_a2e6d97095eb0e18b2a11eee97c1c67af}{NORM\_MODE}},}
\DoxyCodeLine{00079\ \};}

\end{DoxyCode}
