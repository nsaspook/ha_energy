\hypertarget{mqtt__rec_8h}{}\doxysection{ha\+\_\+energy/mqtt\+\_\+rec.h File Reference}
\label{mqtt__rec_8h}\index{ha\_energy/mqtt\_rec.h@{ha\_energy/mqtt\_rec.h}}
{\ttfamily \#include \char`\"{}energy.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mqtt\+\_\+vars.\+h\char`\"{}}\newline
Include dependency graph for mqtt\+\_\+rec.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mqtt__rec_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mqtt__rec_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{mqtt__rec_8h_afe7eb806a46046286a2cfb93e9e773ec}{RDEV\+\_\+\+SIZE}}~10
\item 
\#define \mbox{\hyperlink{mqtt__rec_8h_a83cc734c6e4406346fa81fdca5b22fe8}{SLEEP\+\_\+\+CODE}}~0
\item 
\#define \mbox{\hyperlink{mqtt__rec_8h_a3a284e729efe694efdccf514d4f1e8e5}{FLOAT\+\_\+\+CODE}}~1
\item 
\#define \mbox{\hyperlink{mqtt__rec_8h_a440ad885a7f2d4ca0a7bc18067f775b7}{MBMQTT}}~1024
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219}{mqtt\+\_\+id}} \{ \newline
\mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a2d5f3027ac999fa6e1382a8fc85e48ba}{P8055\+\_\+\+ID}}
, \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a5f245782cbe7efbe181ea485eb5932a5}{FM80\+\_\+\+ID}}
, \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ab5fb8e8dcac9113aa99bb13518a8eecb}{DUMPLOAD\+\_\+\+ID}}
, \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ae3e04e0389b1b12a4cf2738165b4ce77}{HA\+\_\+\+ID}}
, \newline
\mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a8d55b8eb8161148021fadd02dd5a74a8}{LAST\+\_\+\+MQTT\+\_\+\+ID}}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int32\+\_\+t \mbox{\hyperlink{mqtt__rec_8h_ad4ef7431b04739013aac28fb3a299a00}{msgarrvd}} (void $\ast$, char $\ast$, int, MQTTClient\+\_\+message $\ast$)
\item 
void \mbox{\hyperlink{mqtt__rec_8h_a0f736e8daa9b3861377b54b450a1385b}{delivered}} (void $\ast$, MQTTClient\+\_\+delivery\+Token)
\item 
bool \mbox{\hyperlink{mqtt__rec_8h_a9661324dccf0d0bda39b81c0fbba05ef}{json\+\_\+get\+\_\+data}} (c\+JSON $\ast$, const char $\ast$, c\+JSON $\ast$, uint32\+\_\+t)
\item 
bool \mbox{\hyperlink{mqtt__rec_8h_ab3219c1d482ea970a00a713bc9631eb6}{fm80\+\_\+float}} (const bool set\+\_\+bias)
\item 
bool \mbox{\hyperlink{mqtt__rec_8h_a218d78ec87cc0f9067283f98bace529f}{fm80\+\_\+sleep}} (void)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
FILE $\ast$ \mbox{\hyperlink{mqtt__rec_8h_acec19516a59050bb447192fe318e6a9c}{fout}}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{mqtt__rec_8h_a3a284e729efe694efdccf514d4f1e8e5}\label{mqtt__rec_8h_a3a284e729efe694efdccf514d4f1e8e5}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!FLOAT\_CODE@{FLOAT\_CODE}}
\index{FLOAT\_CODE@{FLOAT\_CODE}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{FLOAT\_CODE}{FLOAT\_CODE}}
{\footnotesize\ttfamily \#define FLOAT\+\_\+\+CODE~1}

\mbox{\Hypertarget{mqtt__rec_8h_a440ad885a7f2d4ca0a7bc18067f775b7}\label{mqtt__rec_8h_a440ad885a7f2d4ca0a7bc18067f775b7}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!MBMQTT@{MBMQTT}}
\index{MBMQTT@{MBMQTT}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{MBMQTT}{MBMQTT}}
{\footnotesize\ttfamily \#define MBMQTT~1024}

\mbox{\Hypertarget{mqtt__rec_8h_afe7eb806a46046286a2cfb93e9e773ec}\label{mqtt__rec_8h_afe7eb806a46046286a2cfb93e9e773ec}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!RDEV\_SIZE@{RDEV\_SIZE}}
\index{RDEV\_SIZE@{RDEV\_SIZE}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{RDEV\_SIZE}{RDEV\_SIZE}}
{\footnotesize\ttfamily \#define RDEV\+\_\+\+SIZE~10}

\mbox{\Hypertarget{mqtt__rec_8h_a83cc734c6e4406346fa81fdca5b22fe8}\label{mqtt__rec_8h_a83cc734c6e4406346fa81fdca5b22fe8}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!SLEEP\_CODE@{SLEEP\_CODE}}
\index{SLEEP\_CODE@{SLEEP\_CODE}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{SLEEP\_CODE}{SLEEP\_CODE}}
{\footnotesize\ttfamily \#define SLEEP\+\_\+\+CODE~0}



\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219}\label{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!mqtt\_id@{mqtt\_id}}
\index{mqtt\_id@{mqtt\_id}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{mqtt\_id}{mqtt\_id}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219}{mqtt\+\_\+id}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{P8055\_ID@{P8055\_ID}!mqtt\_rec.h@{mqtt\_rec.h}}\index{mqtt\_rec.h@{mqtt\_rec.h}!P8055\_ID@{P8055\_ID}}}\mbox{\Hypertarget{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a2d5f3027ac999fa6e1382a8fc85e48ba}\label{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a2d5f3027ac999fa6e1382a8fc85e48ba}} 
P8055\+\_\+\+ID&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{FM80\_ID@{FM80\_ID}!mqtt\_rec.h@{mqtt\_rec.h}}\index{mqtt\_rec.h@{mqtt\_rec.h}!FM80\_ID@{FM80\_ID}}}\mbox{\Hypertarget{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a5f245782cbe7efbe181ea485eb5932a5}\label{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a5f245782cbe7efbe181ea485eb5932a5}} 
FM80\+\_\+\+ID&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{DUMPLOAD\_ID@{DUMPLOAD\_ID}!mqtt\_rec.h@{mqtt\_rec.h}}\index{mqtt\_rec.h@{mqtt\_rec.h}!DUMPLOAD\_ID@{DUMPLOAD\_ID}}}\mbox{\Hypertarget{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ab5fb8e8dcac9113aa99bb13518a8eecb}\label{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ab5fb8e8dcac9113aa99bb13518a8eecb}} 
DUMPLOAD\+\_\+\+ID&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{HA\_ID@{HA\_ID}!mqtt\_rec.h@{mqtt\_rec.h}}\index{mqtt\_rec.h@{mqtt\_rec.h}!HA\_ID@{HA\_ID}}}\mbox{\Hypertarget{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ae3e04e0389b1b12a4cf2738165b4ce77}\label{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ae3e04e0389b1b12a4cf2738165b4ce77}} 
HA\+\_\+\+ID&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LAST\_MQTT\_ID@{LAST\_MQTT\_ID}!mqtt\_rec.h@{mqtt\_rec.h}}\index{mqtt\_rec.h@{mqtt\_rec.h}!LAST\_MQTT\_ID@{LAST\_MQTT\_ID}}}\mbox{\Hypertarget{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a8d55b8eb8161148021fadd02dd5a74a8}\label{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a8d55b8eb8161148021fadd02dd5a74a8}} 
LAST\+\_\+\+MQTT\+\_\+\+ID&\\
\hline

\end{DoxyEnumFields}

\begin{DoxyCode}{0}
\DoxyCodeLine{27                  \{}
\DoxyCodeLine{28         \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a2d5f3027ac999fa6e1382a8fc85e48ba}{P8055\_ID}},}
\DoxyCodeLine{29         \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a5f245782cbe7efbe181ea485eb5932a5}{FM80\_ID}},}
\DoxyCodeLine{30         \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ab5fb8e8dcac9113aa99bb13518a8eecb}{DUMPLOAD\_ID}},}
\DoxyCodeLine{31     \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ae3e04e0389b1b12a4cf2738165b4ce77}{HA\_ID}},}
\DoxyCodeLine{32         \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a8d55b8eb8161148021fadd02dd5a74a8}{LAST\_MQTT\_ID}},}
\DoxyCodeLine{33     \};}

\end{DoxyCode}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{mqtt__rec_8h_a0f736e8daa9b3861377b54b450a1385b}\label{mqtt__rec_8h_a0f736e8daa9b3861377b54b450a1385b}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!delivered@{delivered}}
\index{delivered@{delivered}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{delivered()}{delivered()}}
{\footnotesize\ttfamily void delivered (\begin{DoxyParamCaption}\item[{void $\ast$}]{context,  }\item[{MQTTClient\+\_\+delivery\+Token}]{dt }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{123 \{}
\DoxyCodeLine{124     \textcolor{keyword}{struct }\mbox{\hyperlink{structha__flag__type}{ha\_flag\_type}} *ha\_flag = context;}
\DoxyCodeLine{125 }
\DoxyCodeLine{126     \textcolor{comment}{// bug-\/out if no context variables passed to callback}}
\DoxyCodeLine{127     \textcolor{keywordflow}{if} (context == NULL) \{}
\DoxyCodeLine{128         \textcolor{keywordflow}{return};}
\DoxyCodeLine{129     \}}
\DoxyCodeLine{130     ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_ae72ab39aa9936edc5d464a42a17ebc60}{deliveredtoken}} = dt;}
\DoxyCodeLine{131 \}}

\end{DoxyCode}
\mbox{\Hypertarget{mqtt__rec_8h_ab3219c1d482ea970a00a713bc9631eb6}\label{mqtt__rec_8h_ab3219c1d482ea970a00a713bc9631eb6}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!fm80\_float@{fm80\_float}}
\index{fm80\_float@{fm80\_float}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{fm80\_float()}{fm80\_float()}}
{\footnotesize\ttfamily bool fm80\+\_\+float (\begin{DoxyParamCaption}\item[{const bool}]{set\+\_\+bias }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{247 \{}
\DoxyCodeLine{248     \textcolor{keywordflow}{if} ((uint32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072aab958e15de9756ae2b2f9c1eb7bfbc58}{V\_FCCM}}] == \mbox{\hyperlink{mqtt__rec_8h_a3a284e729efe694efdccf514d4f1e8e5}{FLOAT\_CODE}}) \{}
\DoxyCodeLine{249         \textcolor{keywordflow}{if} (set\_bias) \{}
\DoxyCodeLine{250             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_a713653ba952f067a6184ed4e10b89bcb}{pv\_bias}} = \mbox{\hyperlink{energy_8h_a1059832ae84ae61706dbb73c6f6ad35d}{PV\_BIAS\_FLOAT}};}
\DoxyCodeLine{251         \}}
\DoxyCodeLine{252         \textcolor{keywordflow}{if} (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_ab140168a45baf835fb208f93983bc794}{R}} != \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a63581c61e8680cb3c6be0310a4e19e81}{R\_IDLE}}) \{}
\DoxyCodeLine{253             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_ab140168a45baf835fb208f93983bc794}{R}} = \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a1474a7d3758281b3a8fdfcfda8147bab}{R\_FLOAT}};}
\DoxyCodeLine{254         \}}
\DoxyCodeLine{255         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{256     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{257         \textcolor{keywordflow}{if} (\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_ab140168a45baf835fb208f93983bc794}{R}} == \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a1474a7d3758281b3a8fdfcfda8147bab}{R\_FLOAT}}) \{}
\DoxyCodeLine{258             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_ab140168a45baf835fb208f93983bc794}{R}} = \mbox{\hyperlink{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69a53eae320dbcd86f620fa75b630f13c79}{R\_RUN}};}
\DoxyCodeLine{259         \}}
\DoxyCodeLine{260     \}}
\DoxyCodeLine{261     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{262 \}}

\end{DoxyCode}
\mbox{\Hypertarget{mqtt__rec_8h_a218d78ec87cc0f9067283f98bace529f}\label{mqtt__rec_8h_a218d78ec87cc0f9067283f98bace529f}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!fm80\_sleep@{fm80\_sleep}}
\index{fm80\_sleep@{fm80\_sleep}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{fm80\_sleep()}{fm80\_sleep()}}
{\footnotesize\ttfamily bool fm80\+\_\+sleep (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{269 \{}
\DoxyCodeLine{270     \textcolor{keywordflow}{if} ((uint32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072aab958e15de9756ae2b2f9c1eb7bfbc58}{V\_FCCM}}] == \mbox{\hyperlink{mqtt__rec_8h_a83cc734c6e4406346fa81fdca5b22fe8}{SLEEP\_CODE}}) \{}
\DoxyCodeLine{271         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{272     \}}
\DoxyCodeLine{273     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{274 \}}

\end{DoxyCode}
\mbox{\Hypertarget{mqtt__rec_8h_a9661324dccf0d0bda39b81c0fbba05ef}\label{mqtt__rec_8h_a9661324dccf0d0bda39b81c0fbba05ef}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!json\_get\_data@{json\_get\_data}}
\index{json\_get\_data@{json\_get\_data}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{json\_get\_data()}{json\_get\_data()}}
{\footnotesize\ttfamily bool json\+\_\+get\+\_\+data (\begin{DoxyParamCaption}\item[{c\+JSON $\ast$}]{json\+\_\+src,  }\item[{const char $\ast$}]{data\+\_\+id,  }\item[{c\+JSON $\ast$}]{name,  }\item[{uint32\+\_\+t}]{i }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{138 \{}
\DoxyCodeLine{139     \textcolor{keywordtype}{bool} ret = \textcolor{keyword}{false};}
\DoxyCodeLine{140     \textcolor{keyword}{static} uint32\_t j = 0;}
\DoxyCodeLine{141 }
\DoxyCodeLine{142     \textcolor{comment}{// access the JSON data using the lookup string passed in data\_id}}
\DoxyCodeLine{143     name = cJSON\_GetObjectItemCaseSensitive(json\_src, data\_id);}
\DoxyCodeLine{144 }
\DoxyCodeLine{145     \textcolor{comment}{/*}}
\DoxyCodeLine{146 \textcolor{comment}{     * process string values}}
\DoxyCodeLine{147 \textcolor{comment}{     */}}
\DoxyCodeLine{148     \textcolor{keywordflow}{if} (cJSON\_IsString(name) \&\& (name-\/>valuestring != NULL)) \{}
\DoxyCodeLine{149 \textcolor{preprocessor}{\#ifdef GET\_DEBUG}}
\DoxyCodeLine{150         fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}, \textcolor{stringliteral}{"{}\%s Name: \%s\(\backslash\)n"{}}, data\_id, name-\/>valuestring);}
\DoxyCodeLine{151 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{152         ret = \textcolor{keyword}{true};}
\DoxyCodeLine{153     \}}
\DoxyCodeLine{154 }
\DoxyCodeLine{155     \textcolor{comment}{/*}}
\DoxyCodeLine{156 \textcolor{comment}{     * process numeric values}}
\DoxyCodeLine{157 \textcolor{comment}{     */}}
\DoxyCodeLine{158     \textcolor{keywordflow}{if} (cJSON\_IsNumber(name)) \{}
\DoxyCodeLine{159 \textcolor{preprocessor}{\#ifdef GET\_DEBUG}}
\DoxyCodeLine{160         fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}, \textcolor{stringliteral}{"{}\%s Value: \%f\(\backslash\)n"{}}, data\_id, name-\/>valuedouble);}
\DoxyCodeLine{161 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{162         \textcolor{keywordflow}{if} (i > \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072ab183b38bd716ecf9405c4546e3bd6870}{V\_DLAST}}) \{ \textcolor{comment}{// check for out-\/of-\/range index}}
\DoxyCodeLine{163             i = \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072ab183b38bd716ecf9405c4546e3bd6870}{V\_DLAST}};}
\DoxyCodeLine{164         \}}
\DoxyCodeLine{165 }
\DoxyCodeLine{166         \textcolor{comment}{// lock the main value array during updates}}
\DoxyCodeLine{167         pthread\_mutex\_lock(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a35ae999887cbeb701800e498f4e1721a}{ha\_lock}});}
\DoxyCodeLine{168         \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i] = name-\/>valuedouble;}
\DoxyCodeLine{169         pthread\_mutex\_unlock(\&\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a35ae999887cbeb701800e498f4e1721a}{ha\_lock}});}
\DoxyCodeLine{170 }
\DoxyCodeLine{171         \textcolor{comment}{/*}}
\DoxyCodeLine{172 \textcolor{comment}{         * special processing for variable data received}}
\DoxyCodeLine{173 \textcolor{comment}{         */}}
\DoxyCodeLine{174         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a2dd8cb6e7c42be6b299e5d3d6617d7c2}{V\_DCMPPT}}) \{}
\DoxyCodeLine{175             \textcolor{comment}{/*}}
\DoxyCodeLine{176 \textcolor{comment}{             * load battery current standard deviation array bat\_c\_std\_dev with data}}
\DoxyCodeLine{177 \textcolor{comment}{             */}}
\DoxyCodeLine{178             \mbox{\hyperlink{bsoc_8c_adc8522b4d922a9ce45f83ca6a8d2708c}{bsoc\_set\_std\_dev}}(\mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i], j++);}
\DoxyCodeLine{179             \textcolor{keywordflow}{if} (j >= \mbox{\hyperlink{mqtt__rec_8h_afe7eb806a46046286a2cfb93e9e773ec}{RDEV\_SIZE}}) \{}
\DoxyCodeLine{180                 j = 0;}
\DoxyCodeLine{181             \}}
\DoxyCodeLine{182         \}}
\DoxyCodeLine{183         \textcolor{comment}{/*}}
\DoxyCodeLine{184 \textcolor{comment}{         * update local MATTER switch status from HA}}
\DoxyCodeLine{185 \textcolor{comment}{         */}}
\DoxyCodeLine{186         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a7391c358a2241e66cdf9f1e953184521}{V\_HDCSW}}) \{}
\DoxyCodeLine{187             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a1615a731cb9e2e89052bd6d7105166ec}{gti\_sw\_status}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{188             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_aa3b4f7217fce683caf7e64a3211a294a}{dc\_mismatch}} = \textcolor{keyword}{false};}
\DoxyCodeLine{189         \}}
\DoxyCodeLine{190 }
\DoxyCodeLine{191         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a61c580ff6ce646f13228dc2dcad390c1}{V\_HACSW}}) \{}
\DoxyCodeLine{192             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a3100414dc234a91d5cb378f0011b7ab1}{ac\_sw\_status}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{193             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a077335b41dbccfa620e40cd9d8512bcb}{ac\_mismatch}} = \textcolor{keyword}{false};}
\DoxyCodeLine{194         \}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196         \textcolor{comment}{// command HA\_ENERGY to shutdown mode}}
\DoxyCodeLine{197         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a71180ffbf74111c506a7c74e46a11dba}{V\_HSHUT}}) \{}
\DoxyCodeLine{198             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a752af707f8caa7b882f983a0c89f0339}{solar\_shutdown}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{199         \}}
\DoxyCodeLine{200         \textcolor{comment}{// set HA\_ENERGY energy processing mode}}
\DoxyCodeLine{201         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a972a1c6b6a2288d8dd88d6cde959086c}{V\_HMODE}}) \{}
\DoxyCodeLine{202             \mbox{\hyperlink{energy_8c_a300fe8f759de831a9cf50f5a86c85e23}{ha\_flag\_vars\_ss}}.\mbox{\hyperlink{structha__flag__type_ae45c3d1ac1128c2a27f3ee9c0545ea10}{energy\_mode}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{203         \}}
\DoxyCodeLine{204         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072aa2a2d376137d4017052d0bf5ceeebf3d}{V\_HCON0}}) \{}
\DoxyCodeLine{205             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_a305fc93f61bf3dc4210604687adceac4}{con0}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{206         \}}
\DoxyCodeLine{207         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a50be71dd4aec439fc0394cb17e66a189}{V\_HCON1}}) \{}
\DoxyCodeLine{208             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_a0b4b030068e0b059ded48a0e95e3aedd}{con1}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{209         \}}
\DoxyCodeLine{210         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a4d96c96a3fe5386e70009f7651adab78}{V\_HCON2}}) \{}
\DoxyCodeLine{211             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_ad4f177aacff3d61c46ac124b5f8a4cd8}{con2}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{212         \}}
\DoxyCodeLine{213         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a682e786afbba8dc1e112013ad16da1c6}{V\_HCON3}}) \{}
\DoxyCodeLine{214             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_adf0a03511fe0fa91adc32e7479bb632b}{con3}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{215         \}}
\DoxyCodeLine{216         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a0be3335391f5cd47a8e92fdc04f0927f}{V\_HCON4}}) \{ \textcolor{comment}{// set DL GTI excess load MODE }}
\DoxyCodeLine{217             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_a0cc3a15a994a67eb849733193e05fa06}{con4}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{218         \}}
\DoxyCodeLine{219         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a8a6eb97b0e27737572161095bdccc22f}{V\_HCON5}}) \{ \textcolor{comment}{// clear DL GTI excess load MODE}}
\DoxyCodeLine{220             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_a5ca43a1420ba47e4f37857bca5c11938}{con5}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{221         \}}
\DoxyCodeLine{222         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a7833386896850525de2b48c57d4595b7}{V\_HCON6}}) \{ \textcolor{comment}{// HA Energy program idle}}
\DoxyCodeLine{223             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_a3bc6b3f9a6c3a06dc7875133321aba62}{con6}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{224         \}}
\DoxyCodeLine{225         \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072ad6f25d2f08b07b163f622f9a6c5c1d29}{V\_HCON7}}) \{ \textcolor{comment}{// HA Energy program exit}}
\DoxyCodeLine{226             \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_ae587cb0d827d54b01b3c04540ab92948}{mode}}.\mbox{\hyperlink{structmode__type_a1ec5332759a6ff98ca880fedddd32bf9}{con7}} = (bool) ((int32\_t) \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a0d243a29681d74290efc06922fdfd7b7}{mvar}}[i]);}
\DoxyCodeLine{227         \}}
\DoxyCodeLine{228         ret = \textcolor{keyword}{true};}
\DoxyCodeLine{229     \}}
\DoxyCodeLine{230     \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{231 \}}

\end{DoxyCode}
\mbox{\Hypertarget{mqtt__rec_8h_ad4ef7431b04739013aac28fb3a299a00}\label{mqtt__rec_8h_ad4ef7431b04739013aac28fb3a299a00}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!msgarrvd@{msgarrvd}}
\index{msgarrvd@{msgarrvd}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{msgarrvd()}{msgarrvd()}}
{\footnotesize\ttfamily int32\+\_\+t msgarrvd (\begin{DoxyParamCaption}\item[{void $\ast$}]{context,  }\item[{char $\ast$}]{topic\+Name,  }\item[{int}]{topic\+Len,  }\item[{MQTTClient\+\_\+message $\ast$}]{message }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{8 \{}
\DoxyCodeLine{9     int32\_t i, ret = 1;}
\DoxyCodeLine{10     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* payloadptr;}
\DoxyCodeLine{11     \textcolor{keywordtype}{char} buffer[\mbox{\hyperlink{mqtt__rec_8h_a440ad885a7f2d4ca0a7bc18067f775b7}{MBMQTT}}];}
\DoxyCodeLine{12     \textcolor{keyword}{struct }\mbox{\hyperlink{structha__flag__type}{ha\_flag\_type}} *ha\_flag = context;}
\DoxyCodeLine{13 }
\DoxyCodeLine{14     \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_af8b87e76c6fd29fa4ac1fdd6d0e5aeac}{link}}.\mbox{\hyperlink{structlink__type_aa820e79717719cfe77f6b2b2bada58ae}{mqtt\_count}}++;}
\DoxyCodeLine{15     \textcolor{comment}{// bug-\/out if no context variables passed to callback}}
\DoxyCodeLine{16     \textcolor{keywordflow}{if} (context == NULL) \{}
\DoxyCodeLine{17         ret = -\/1;}
\DoxyCodeLine{18         \textcolor{keywordflow}{goto} null\_exit;}
\DoxyCodeLine{19     \}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#ifdef DEBUG\_REC}}
\DoxyCodeLine{22     fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}, \textcolor{stringliteral}{"{}Message arrived\(\backslash\)n"{}});}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{24     \textcolor{comment}{/*}}
\DoxyCodeLine{25 \textcolor{comment}{     * move the received message into a processing holding buffer}}
\DoxyCodeLine{26 \textcolor{comment}{     */}}
\DoxyCodeLine{27     payloadptr = message-\/>payload;}
\DoxyCodeLine{28     \textcolor{keywordflow}{for} (i = 0; i < message-\/>payloadlen; i++) \{}
\DoxyCodeLine{29         buffer[i] = *payloadptr++;}
\DoxyCodeLine{30     \}}
\DoxyCodeLine{31     buffer[i] = 0; \textcolor{comment}{// make a null terminated C string}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33     \textcolor{comment}{// parse the JSON data in the holding buffer}}
\DoxyCodeLine{34     cJSON *json = cJSON\_ParseWithLength(buffer, message-\/>payloadlen);}
\DoxyCodeLine{35     \textcolor{keywordflow}{if} (json == NULL) \{}
\DoxyCodeLine{36         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *error\_ptr = cJSON\_GetErrorPtr();}
\DoxyCodeLine{37         \textcolor{keywordflow}{if} (error\_ptr != NULL) \{}
\DoxyCodeLine{38             fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}, \textcolor{stringliteral}{"{}\%s Error: \%s NULL cJSON pointer\(\backslash\)n"{}}, \mbox{\hyperlink{energy_8c_a18b19ee666a9edc39d904a474ddee1d9}{log\_time}}(\textcolor{keyword}{false}), error\_ptr);}
\DoxyCodeLine{39         \}}
\DoxyCodeLine{40         ret = -\/1;}
\DoxyCodeLine{41         ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_a9ea932e19a574476a14bc8c144064e88}{rec\_ok}} = \textcolor{keyword}{false};}
\DoxyCodeLine{42         \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a60190fd48a28f964be8d030fe88a19a3}{fm80}} = \textcolor{keyword}{false};}
\DoxyCodeLine{43         \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a87a24fa58fbe692b797c0081bf28df28}{dumpload}} = \textcolor{keyword}{false};}
\DoxyCodeLine{44         \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_af080199f34d74e822ff98c6a9fc8c976}{homeassistant}} = \textcolor{keyword}{false};}
\DoxyCodeLine{45         \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_af8b87e76c6fd29fa4ac1fdd6d0e5aeac}{link}}.\mbox{\hyperlink{structlink__type_a17d70f7dd45e005f9cda9562d56a9fa0}{mqtt\_error}}++;}
\DoxyCodeLine{46         \textcolor{keywordflow}{goto} error\_exit;}
\DoxyCodeLine{47     \}}
\DoxyCodeLine{48 }
\DoxyCodeLine{49     \textcolor{comment}{/*}}
\DoxyCodeLine{50 \textcolor{comment}{     * MQTT messages from the FM80 Q84 interface}}
\DoxyCodeLine{51 \textcolor{comment}{     */}}
\DoxyCodeLine{52     \textcolor{keywordflow}{if} (ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_a0756e3e6519823c23b8711864a70460c}{ha\_id}} == \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219a5f245782cbe7efbe181ea485eb5932a5}{FM80\_ID}}) \{}
\DoxyCodeLine{53 \textcolor{preprocessor}{\#ifdef DEBUG\_REC}}
\DoxyCodeLine{54         fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}, \textcolor{stringliteral}{"{}FM80 MQTT data\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{56         cJSON *data\_result = json;}
\DoxyCodeLine{57 }
\DoxyCodeLine{58         \textcolor{keywordflow}{for} (uint32\_t ii = \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072aab958e15de9756ae2b2f9c1eb7bfbc58}{V\_FCCM}}; ii < \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072abb8be725d4da006153726eea397593e9}{V\_FLAST}}; ii++) \{}
\DoxyCodeLine{59             \textcolor{keywordflow}{if} (\mbox{\hyperlink{mqtt__rec_8c_acaa1a0e82c0b21e28a7b6fd6c1d6ac43}{json\_get\_data}}(json, \mbox{\hyperlink{bsoc_8c_ae6b57480d8cda466cfc65b9bfc47b255}{mqtt\_name}}[ii], data\_result, ii)) \{}
\DoxyCodeLine{60                 ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_ac5f129b617820ce6cd1e289d918e2a3f}{var\_update}}++;}
\DoxyCodeLine{61             \}}
\DoxyCodeLine{62         \}}
\DoxyCodeLine{63         \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a60190fd48a28f964be8d030fe88a19a3}{fm80}} = \textcolor{keyword}{true};}
\DoxyCodeLine{64     \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     \textcolor{comment}{/*}}
\DoxyCodeLine{67 \textcolor{comment}{     * MQTT messages from the K42 dumpload/gti interface}}
\DoxyCodeLine{68 \textcolor{comment}{     */}}
\DoxyCodeLine{69     \textcolor{keywordflow}{if} (ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_a0756e3e6519823c23b8711864a70460c}{ha\_id}} == \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ab5fb8e8dcac9113aa99bb13518a8eecb}{DUMPLOAD\_ID}}) \{}
\DoxyCodeLine{70 \textcolor{preprocessor}{\#ifdef DEBUG\_REC}}
\DoxyCodeLine{71         fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}, \textcolor{stringliteral}{"{}DUMPLOAD MQTT data\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{72 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{73         cJSON *data\_result = json;}
\DoxyCodeLine{74 }
\DoxyCodeLine{75         \textcolor{keywordflow}{for} (uint32\_t ii = \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a7391c358a2241e66cdf9f1e953184521}{V\_HDCSW}}; ii < \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072ab183b38bd716ecf9405c4546e3bd6870}{V\_DLAST}}; ii++) \{}
\DoxyCodeLine{76             \textcolor{keywordflow}{if} (\mbox{\hyperlink{mqtt__rec_8c_acaa1a0e82c0b21e28a7b6fd6c1d6ac43}{json\_get\_data}}(json, \mbox{\hyperlink{bsoc_8c_ae6b57480d8cda466cfc65b9bfc47b255}{mqtt\_name}}[ii], data\_result, ii)) \{}
\DoxyCodeLine{77                 ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_ac5f129b617820ce6cd1e289d918e2a3f}{var\_update}}++;}
\DoxyCodeLine{78             \}}
\DoxyCodeLine{79         \}}
\DoxyCodeLine{80         \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_a87a24fa58fbe692b797c0081bf28df28}{dumpload}} = \textcolor{keyword}{true};}
\DoxyCodeLine{81     \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     \textcolor{comment}{/*}}
\DoxyCodeLine{84 \textcolor{comment}{     * MQTT messages from the Linux HA\_ENERGY interface}}
\DoxyCodeLine{85 \textcolor{comment}{     */}}
\DoxyCodeLine{86     \textcolor{keywordflow}{if} (ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_a0756e3e6519823c23b8711864a70460c}{ha\_id}} == \mbox{\hyperlink{mqtt__rec_8h_a84a88b7d95b225fcc5f008c474558219ae3e04e0389b1b12a4cf2738165b4ce77}{HA\_ID}}) \{}
\DoxyCodeLine{87 \textcolor{preprocessor}{\#ifdef DEBUG\_REC}}
\DoxyCodeLine{88         fprintf(\mbox{\hyperlink{energy_8c_acec19516a59050bb447192fe318e6a9c}{fout}}, \textcolor{stringliteral}{"{}Home Assistant MQTT data\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{89 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{90         cJSON *data\_result = json;}
\DoxyCodeLine{91 }
\DoxyCodeLine{92         \textcolor{keywordflow}{if} (\mbox{\hyperlink{mqtt__rec_8c_acaa1a0e82c0b21e28a7b6fd6c1d6ac43}{json\_get\_data}}(json, \mbox{\hyperlink{bsoc_8c_ae6b57480d8cda466cfc65b9bfc47b255}{mqtt\_name}}[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a61c580ff6ce646f13228dc2dcad390c1}{V\_HACSW}}], data\_result, \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a61c580ff6ce646f13228dc2dcad390c1}{V\_HACSW}})) \{}
\DoxyCodeLine{93             ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_ac5f129b617820ce6cd1e289d918e2a3f}{var\_update}}++;}
\DoxyCodeLine{94         \}}
\DoxyCodeLine{95         data\_result = json;}
\DoxyCodeLine{96         \textcolor{keywordflow}{if} (\mbox{\hyperlink{mqtt__rec_8c_acaa1a0e82c0b21e28a7b6fd6c1d6ac43}{json\_get\_data}}(json, \mbox{\hyperlink{bsoc_8c_ae6b57480d8cda466cfc65b9bfc47b255}{mqtt\_name}}[\mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a7391c358a2241e66cdf9f1e953184521}{V\_HDCSW}}], data\_result, \mbox{\hyperlink{energy_8h_a4798b70da5e09a128bfc682db0b65072a7391c358a2241e66cdf9f1e953184521}{V\_HDCSW}})) \{}
\DoxyCodeLine{97             ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_ac5f129b617820ce6cd1e289d918e2a3f}{var\_update}}++;}
\DoxyCodeLine{98         \}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100         \mbox{\hyperlink{energy_8c_aae3805c63e28abac1e41ffd7b623596e}{E}}.\mbox{\hyperlink{structenergy__type_af080199f34d74e822ff98c6a9fc8c976}{homeassistant}} = \textcolor{keyword}{true};}
\DoxyCodeLine{101     \}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103     \textcolor{comment}{// done with processing MQTT async message, set state flags}}
\DoxyCodeLine{104     ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_ab70820f3deb59737344c41114223330b}{receivedtoken}} = \textcolor{keyword}{true};}
\DoxyCodeLine{105     ha\_flag-\/>\mbox{\hyperlink{structha__flag__type_a9ea932e19a574476a14bc8c144064e88}{rec\_ok}} = \textcolor{keyword}{true};}
\DoxyCodeLine{106     \textcolor{comment}{/*}}
\DoxyCodeLine{107 \textcolor{comment}{     * exit and delete/free resources. In steps depending of possible error conditions}}
\DoxyCodeLine{108 \textcolor{comment}{     */}}
\DoxyCodeLine{109 error\_exit:}
\DoxyCodeLine{110     \textcolor{comment}{// delete the JSON object}}
\DoxyCodeLine{111     cJSON\_Delete(json);}
\DoxyCodeLine{112 null\_exit:}
\DoxyCodeLine{113     \textcolor{comment}{// free the MQTT objects}}
\DoxyCodeLine{114     MQTTClient\_freeMessage(\&message);}
\DoxyCodeLine{115     MQTTClient\_free(topicName);}
\DoxyCodeLine{116     \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{117 \}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{mqtt__rec_8h_acec19516a59050bb447192fe318e6a9c}\label{mqtt__rec_8h_acec19516a59050bb447192fe318e6a9c}} 
\index{mqtt\_rec.h@{mqtt\_rec.h}!fout@{fout}}
\index{fout@{fout}!mqtt\_rec.h@{mqtt\_rec.h}}
\doxysubsubsection{\texorpdfstring{fout}{fout}}
{\footnotesize\ttfamily FILE$\ast$ fout\hspace{0.3cm}{\ttfamily [extern]}}

