\doxysection{ha\+\_\+energy/energy.h File Reference}
\hypertarget{energy_8h}{}\label{energy_8h}\index{ha\_energy/energy.h@{ha\_energy/energy.h}}
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include $<$signal.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include $<$sys/wait.\+h$>$}\newline
{\ttfamily \#include $<$sys/types.\+h$>$}\newline
{\ttfamily \#include $<$sys/time.\+h$>$}\newline
{\ttfamily \#include $<$errno.\+h$>$}\newline
{\ttfamily \#include $<$cjson/c\+JSON.\+h$>$}\newline
{\ttfamily \#include $<$curl/curl.\+h$>$}\newline
{\ttfamily \#include $<$pthread.\+h$>$}\newline
{\ttfamily \#include $<$sys/stat.\+h$>$}\newline
{\ttfamily \#include $<$syslog.\+h$>$}\newline
{\ttfamily \#include $<$arpa/inet.\+h$>$}\newline
{\ttfamily \#include $<$sys/socket.\+h$>$}\newline
{\ttfamily \#include $<$netdb.\+h$>$}\newline
{\ttfamily \#include $<$ifaddrs.\+h$>$}\newline
{\ttfamily \#include "{}MQTTClient.\+h"{}}\newline
{\ttfamily \#include "{}pid.\+h"{}}\newline
Include dependency graph for energy.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{energy_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structlink__type}{link\+\_\+type}}
\item 
struct \mbox{\hyperlink{structmode__type}{mode\+\_\+type}}
\item 
struct \mbox{\hyperlink{structenergy__type}{energy\+\_\+type}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{energy_8h_aa48b2017856a8a9c33a9935afe604c8d}\label{energy_8h_aa48b2017856a8a9c33a9935afe604c8d} 
\#define {\bfseries LOG\+\_\+\+VERSION}~"{}V0.\+75"{}
\item 
\Hypertarget{energy_8h_a702197a21870dfd505d92530b27754ac}\label{energy_8h_a702197a21870dfd505d92530b27754ac} 
\#define {\bfseries MQTT\+\_\+\+VERSION}~"{}V3.\+11"{}
\item 
\Hypertarget{energy_8h_af7dd188b7e9a8592e394e37ba6272a90}\label{energy_8h_af7dd188b7e9a8592e394e37ba6272a90} 
\#define {\bfseries TNAME}~"{}maint9"{}
\item 
\Hypertarget{energy_8h_a16d272bc422b8cccde66c643763a9070}\label{energy_8h_a16d272bc422b8cccde66c643763a9070} 
\#define {\bfseries LADDRESS}~"{}tcp\+://127.\+0.\+0.\+1\+:1883"{}
\item 
\Hypertarget{energy_8h_a280feb883e9d4a7edcc69c8bcb9f38f2}\label{energy_8h_a280feb883e9d4a7edcc69c8bcb9f38f2} 
\#define {\bfseries ADDRESS}~"{}tcp\+://10.\+1.\+1.\+30\+:1883"{}
\item 
\Hypertarget{energy_8h_aca843921281fc0385b402ca1e700f13b}\label{energy_8h_aca843921281fc0385b402ca1e700f13b} 
\#define {\bfseries CLIENTID1}~"{}Energy\+\_\+\+Mqtt\+\_\+\+HA1"{}
\item 
\Hypertarget{energy_8h_a7adb4fde27aaf399c290536e96e41df7}\label{energy_8h_a7adb4fde27aaf399c290536e96e41df7} 
\#define {\bfseries CLIENTID2}~"{}Energy\+\_\+\+Mqtt\+\_\+\+HA2"{}
\item 
\Hypertarget{energy_8h_a080e92b01476c8d6861e405c4ac3bae5}\label{energy_8h_a080e92b01476c8d6861e405c4ac3bae5} 
\#define {\bfseries CLIENTID3}~"{}Energy\+\_\+\+Mqtt\+\_\+\+HA3"{}
\item 
\Hypertarget{energy_8h_a8170bc07eb3b7f53bb8bfea780ebfdd8}\label{energy_8h_a8170bc07eb3b7f53bb8bfea780ebfdd8} 
\#define {\bfseries TOPIC\+\_\+P}~"{}mateq84/data/gticmd"{}
\item 
\Hypertarget{energy_8h_a1b65e9caf02a5c504b9bdbce82b687fd}\label{energy_8h_a1b65e9caf02a5c504b9bdbce82b687fd} 
\#define {\bfseries TOPIC\+\_\+\+SPAM}~"{}mateq84/data/spam"{}
\item 
\Hypertarget{energy_8h_a75b4efd61045ccc11560697d90941f3f}\label{energy_8h_a75b4efd61045ccc11560697d90941f3f} 
\#define {\bfseries TOPIC\+\_\+\+PACA}~"{}home-\/assistant/gtiac/availability"{}
\item 
\Hypertarget{energy_8h_a7a785b1b0c69e86f3dd28b94bb393fca}\label{energy_8h_a7a785b1b0c69e86f3dd28b94bb393fca} 
\#define {\bfseries TOPIC\+\_\+\+PDCA}~"{}home-\/assistant/gtidc/availability"{}
\item 
\Hypertarget{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330}\label{energy_8h_ab741d14c77c3f7326b0c05d0be7a4330} 
\#define {\bfseries TOPIC\+\_\+\+PACC}~"{}home-\/assistant/gtiac/contact"{}
\item 
\Hypertarget{energy_8h_a6bbafe078803d99cb34f62c659e58cbc}\label{energy_8h_a6bbafe078803d99cb34f62c659e58cbc} 
\#define {\bfseries TOPIC\+\_\+\+PDCC}~"{}home-\/assistant/gtidc/contact"{}
\item 
\Hypertarget{energy_8h_a5ec6c2a3e382c3bc460c59010e1287a4}\label{energy_8h_a5ec6c2a3e382c3bc460c59010e1287a4} 
\#define {\bfseries TOPIC\+\_\+\+PPID}~"{}home-\/assistant/solar/pid"{}
\item 
\Hypertarget{energy_8h_ac1a01dc509505d2a44781caffa5c071a}\label{energy_8h_ac1a01dc509505d2a44781caffa5c071a} 
\#define {\bfseries TOPIC\+\_\+\+SHUTDOWN}~"{}home-\/assistant/solar/shutdown"{}
\item 
\Hypertarget{energy_8h_a08b3494e502966f0b67ef43c0060b4a4}\label{energy_8h_a08b3494e502966f0b67ef43c0060b4a4} 
\#define {\bfseries TOPIC\+\_\+\+SS}~"{}mateq84/data/solar"{}
\item 
\Hypertarget{energy_8h_a42eda1760ac7eb3904f71b170d6eace0}\label{energy_8h_a42eda1760ac7eb3904f71b170d6eace0} 
\#define {\bfseries TOPIC\+\_\+\+SD}~"{}mateq84/data/dumpload"{}
\item 
\Hypertarget{energy_8h_a2361cc9e2cb27aa89335ae62571ef94f}\label{energy_8h_a2361cc9e2cb27aa89335ae62571ef94f} 
\#define {\bfseries TOPIC\+\_\+\+HA}~"{}home-\/assistant/status/switch"{}
\item 
\Hypertarget{energy_8h_a1e5759eb3f87b00bf4acf6579f9034d5}\label{energy_8h_a1e5759eb3f87b00bf4acf6579f9034d5} 
\#define {\bfseries QOS}~1
\item 
\Hypertarget{energy_8h_a45ba202b05caf39795aeca91b0ae547e}\label{energy_8h_a45ba202b05caf39795aeca91b0ae547e} 
\#define {\bfseries TIMEOUT}~10000L
\item 
\Hypertarget{energy_8h_a528b7d17d2b8f25733d0629af28d929c}\label{energy_8h_a528b7d17d2b8f25733d0629af28d929c} 
\#define {\bfseries SPACING\+\_\+\+USEC}~500 \texorpdfstring{$\ast$}{*} 1000
\item 
\Hypertarget{energy_8h_ae1c44b0e06f13991804a91e98022ad1c}\label{energy_8h_ae1c44b0e06f13991804a91e98022ad1c} 
\#define {\bfseries USEC\+\_\+\+SEC}~1000000L
\item 
\Hypertarget{energy_8h_a1e04b677ffb8dd7609cad8e446f21111}\label{energy_8h_a1e04b677ffb8dd7609cad8e446f21111} 
\#define {\bfseries DAQ\+\_\+\+STR}~32
\item 
\Hypertarget{energy_8h_a194d0b205e6fa0225c96c64d1824064a}\label{energy_8h_a194d0b205e6fa0225c96c64d1824064a} 
\#define {\bfseries DAQ\+\_\+\+STR\+\_\+M}~DAQ\+\_\+\+STR-\/1
\item 
\Hypertarget{energy_8h_a6d4040fa8211c8fdb91258c7a0fbe994}\label{energy_8h_a6d4040fa8211c8fdb91258c7a0fbe994} 
\#define {\bfseries SBUF\+\_\+\+SIZ}~16
\item 
\Hypertarget{energy_8h_a0c85192a1fc4b17a7c63d0c0f6f61625}\label{energy_8h_a0c85192a1fc4b17a7c63d0c0f6f61625} 
\#define {\bfseries RBUF\+\_\+\+SIZ}~82
\item 
\Hypertarget{energy_8h_a52c3aaa9470287b78eee2ca241454fcb}\label{energy_8h_a52c3aaa9470287b78eee2ca241454fcb} 
\#define {\bfseries SYSLOG\+\_\+\+SIZ}~512
\item 
\Hypertarget{energy_8h_adc31fee63bd07cbfbb61fd111b95fa99}\label{energy_8h_adc31fee63bd07cbfbb61fd111b95fa99} 
\#define {\bfseries MQTT\+\_\+\+TIMEOUT}~900
\item 
\Hypertarget{energy_8h_ab746f6546d2e3f1b423bcb4d347a1911}\label{energy_8h_ab746f6546d2e3f1b423bcb4d347a1911} 
\#define {\bfseries SW\+\_\+\+QOS}~1
\item 
\Hypertarget{energy_8h_a77f3419f781148dcca45dbf250afc2cc}\label{energy_8h_a77f3419f781148dcca45dbf250afc2cc} 
\#define {\bfseries MQTT\+\_\+\+RECONN}~3
\item 
\Hypertarget{energy_8h_a3d2ee9166822a983ebe5c404971a3e99}\label{energy_8h_a3d2ee9166822a983ebe5c404971a3e99} 
\#define {\bfseries KAI}~60
\item 
\Hypertarget{energy_8h_ab8dddbde9afb7c4d8a8cb9da5d88318a}\label{energy_8h_ab8dddbde9afb7c4d8a8cb9da5d88318a} 
\#define {\bfseries NO\+\_\+\+CYLON}
\item 
\Hypertarget{energy_8h_aef6259a38c50d4047533b3f90b514dd5}\label{energy_8h_aef6259a38c50d4047533b3f90b514dd5} 
\#define {\bfseries CRITIAL\+\_\+\+SHUTDOWN\+\_\+\+LOG}
\item 
\Hypertarget{energy_8h_a68f824d33c675c8bb6e1337a14812a8d}\label{energy_8h_a68f824d33c675c8bb6e1337a14812a8d} 
\#define {\bfseries UNIT\+\_\+\+TEST}~2
\item 
\Hypertarget{energy_8h_a2e6d97095eb0e18b2a11eee97c1c67af}\label{energy_8h_a2e6d97095eb0e18b2a11eee97c1c67af} 
\#define {\bfseries NORM\+\_\+\+MODE}~0
\item 
\Hypertarget{energy_8h_a1e885e72e7ad11061ec0b4b95cc01049}\label{energy_8h_a1e885e72e7ad11061ec0b4b95cc01049} 
\#define {\bfseries PID\+\_\+\+MODE}~1
\item 
\Hypertarget{energy_8h_a7c213cc89d01ec9cdbaa3356698a86ce}\label{energy_8h_a7c213cc89d01ec9cdbaa3356698a86ce} 
\#define {\bfseries MAX\+\_\+\+ERROR}~5
\item 
\Hypertarget{energy_8h_a5b7b3aec1ddee0f87659a37569eda53c}\label{energy_8h_a5b7b3aec1ddee0f87659a37569eda53c} 
\#define {\bfseries IAM\+\_\+\+DELAY}~120
\item 
\Hypertarget{energy_8h_af1013b321ed7dc7a7940e27f03eb5bf9}\label{energy_8h_af1013b321ed7dc7a7940e27f03eb5bf9} 
\#define {\bfseries CMD\+\_\+\+SEC}~10
\item 
\Hypertarget{energy_8h_ae1b9e27b004bee7dcaecf4ee4778e0bd}\label{energy_8h_ae1b9e27b004bee7dcaecf4ee4778e0bd} 
\#define {\bfseries TIME\+\_\+\+SYNC\+\_\+\+SEC}~30
\item 
\Hypertarget{energy_8h_ac9d8c1bf3deadb93373645fa86fe4e55}\label{energy_8h_ac9d8c1bf3deadb93373645fa86fe4e55} 
\#define {\bfseries BAT\+\_\+\+M\+\_\+\+KW}~5120.\+0f
\item 
\Hypertarget{energy_8h_a84266ec03c0f5a1e0bad318724e64f30}\label{energy_8h_a84266ec03c0f5a1e0bad318724e64f30} 
\#define {\bfseries BAT\+\_\+\+SOC\+\_\+\+TOP}~0.\+98f
\item 
\Hypertarget{energy_8h_a79455500ab09cb1afed79130e2f25cb6}\label{energy_8h_a79455500ab09cb1afed79130e2f25cb6} 
\#define {\bfseries BAT\+\_\+\+SOC\+\_\+\+HIGH}~0.\+95f
\item 
\Hypertarget{energy_8h_a3657cb94075ba688f423c0e2a00324fa}\label{energy_8h_a3657cb94075ba688f423c0e2a00324fa} 
\#define {\bfseries BAT\+\_\+\+SOC\+\_\+\+LOW}~0.\+68f
\item 
\Hypertarget{energy_8h_a5a1af43e015999e54c67ee9f2a24a921}\label{energy_8h_a5a1af43e015999e54c67ee9f2a24a921} 
\#define {\bfseries BAT\+\_\+\+SOC\+\_\+\+LOW\+\_\+\+AC}~0.\+72f
\item 
\Hypertarget{energy_8h_a5a4b955055b337ef5f4f21af51eccb03}\label{energy_8h_a5a4b955055b337ef5f4f21af51eccb03} 
\#define {\bfseries BAT\+\_\+\+CRITICAL}~746.\+0f
\item 
\Hypertarget{energy_8h_a10405061b85ae1918bd02d110e958920}\label{energy_8h_a10405061b85ae1918bd02d110e958920} 
\#define {\bfseries MIN\+\_\+\+BAT\+\_\+\+KW\+\_\+\+BSOC\+\_\+\+SLP}~4000.\+0f
\item 
\Hypertarget{energy_8h_ad844217bc1ad213a7424c3edc9f3ccbd}\label{energy_8h_ad844217bc1ad213a7424c3edc9f3ccbd} 
\#define {\bfseries MIN\+\_\+\+BAT\+\_\+\+KW\+\_\+\+BSOC\+\_\+\+HI}~4550.\+0f
\item 
\Hypertarget{energy_8h_a05cb74467763c662c93c0197d2ebb502}\label{energy_8h_a05cb74467763c662c93c0197d2ebb502} 
\#define {\bfseries MIN\+\_\+\+BAT\+\_\+\+KW\+\_\+\+GTI\+\_\+\+HI}~BAT\+\_\+\+M\+\_\+\+KW\texorpdfstring{$\ast$}{*}BAT\+\_\+\+SOC\+\_\+\+TOP
\item 
\Hypertarget{energy_8h_a26d8cf1cdbb4c06adfe113dcfc99d002}\label{energy_8h_a26d8cf1cdbb4c06adfe113dcfc99d002} 
\#define {\bfseries MIN\+\_\+\+BAT\+\_\+\+KW\+\_\+\+GTI\+\_\+\+LO}~BAT\+\_\+\+M\+\_\+\+KW\texorpdfstring{$\ast$}{*}BAT\+\_\+\+SOC\+\_\+\+LOW
\item 
\Hypertarget{energy_8h_acba28bf1765e9924790cc957b23ece2f}\label{energy_8h_acba28bf1765e9924790cc957b23ece2f} 
\#define {\bfseries MIN\+\_\+\+BAT\+\_\+\+KW\+\_\+\+AC\+\_\+\+HI}~BAT\+\_\+\+M\+\_\+\+KW\texorpdfstring{$\ast$}{*}BAT\+\_\+\+SOC\+\_\+\+HIGH
\item 
\Hypertarget{energy_8h_acf488256aa0ed5070518a3e3e66400eb}\label{energy_8h_acf488256aa0ed5070518a3e3e66400eb} 
\#define {\bfseries MIN\+\_\+\+BAT\+\_\+\+KW\+\_\+\+AC\+\_\+\+LO}~BAT\+\_\+\+M\+\_\+\+KW\texorpdfstring{$\ast$}{*}BAT\+\_\+\+SOC\+\_\+\+LOW\+\_\+\+AC
\item 
\Hypertarget{energy_8h_add82739b7510bb56bf067db225588165}\label{energy_8h_add82739b7510bb56bf067db225588165} 
\#define {\bfseries PV\+\_\+\+PGAIN}~0.\+85f
\item 
\Hypertarget{energy_8h_aeb2366dfac41f8b6c707e5f46ae12f42}\label{energy_8h_aeb2366dfac41f8b6c707e5f46ae12f42} 
\#define {\bfseries PV\+\_\+\+IGAIN}~0.\+12f
\item 
\Hypertarget{energy_8h_a34904b7b50e61da00fececcde810eed6}\label{energy_8h_a34904b7b50e61da00fececcde810eed6} 
\#define {\bfseries PV\+\_\+\+IMAX}~1400.\+0f
\item 
\Hypertarget{energy_8h_abb832d8acc3779b9d179bc5577a3787d}\label{energy_8h_abb832d8acc3779b9d179bc5577a3787d} 
\#define {\bfseries PV\+\_\+\+BIAS}~288.\+0f
\item 
\Hypertarget{energy_8h_a49ebc838f3910dacd095678db5c985f7}\label{energy_8h_a49ebc838f3910dacd095678db5c985f7} 
\#define {\bfseries PV\+\_\+\+BIAS\+\_\+\+ZERO}~0.\+0f
\item 
\Hypertarget{energy_8h_a72a8935085093a655db2a9c36bc7a419}\label{energy_8h_a72a8935085093a655db2a9c36bc7a419} 
\#define {\bfseries PV\+\_\+\+BIAS\+\_\+\+LOW}~222.\+0f
\item 
\Hypertarget{energy_8h_a1059832ae84ae61706dbb73c6f6ad35d}\label{energy_8h_a1059832ae84ae61706dbb73c6f6ad35d} 
\#define {\bfseries PV\+\_\+\+BIAS\+\_\+\+FLOAT}~399.\+0f
\item 
\Hypertarget{energy_8h_a1fc05643e83a06afc4a0522013007589}\label{energy_8h_a1fc05643e83a06afc4a0522013007589} 
\#define {\bfseries PV\+\_\+\+BIAS\+\_\+\+SLEEP}~480.\+0f
\item 
\Hypertarget{energy_8h_ad478547f5632a840af219749a4e22e79}\label{energy_8h_ad478547f5632a840af219749a4e22e79} 
\#define {\bfseries PV\+\_\+\+BIAS\+\_\+\+RATE}~320.\+0f
\item 
\Hypertarget{energy_8h_afb56edb8a8e45a993924e0582035e7f3}\label{energy_8h_afb56edb8a8e45a993924e0582035e7f3} 
\#define {\bfseries PV\+\_\+\+DL\+\_\+\+MPTT\+\_\+\+MAX}~1200.\+0f
\item 
\Hypertarget{energy_8h_a8948540a345057786acbc6b5347157b5}\label{energy_8h_a8948540a345057786acbc6b5347157b5} 
\#define {\bfseries PV\+\_\+\+DL\+\_\+\+MPTT\+\_\+\+EXCESS}~1300.\+0f
\item 
\Hypertarget{energy_8h_a7aaac0669e9aba0830f4d4180ba932ab}\label{energy_8h_a7aaac0669e9aba0830f4d4180ba932ab} 
\#define {\bfseries PV\+\_\+\+DL\+\_\+\+MPTT\+\_\+\+IDLE}~57.\+0f
\item 
\Hypertarget{energy_8h_ae8e7f559c64b5c3fced213da7eced7da}\label{energy_8h_ae8e7f559c64b5c3fced213da7eced7da} 
\#define {\bfseries PV\+\_\+\+DL\+\_\+\+BIAS\+\_\+\+RATE}~75.\+0f
\item 
\Hypertarget{energy_8h_a821e3aa59b88068f6ee5d1b8a922bd43}\label{energy_8h_a821e3aa59b88068f6ee5d1b8a922bd43} 
\#define {\bfseries PV\+\_\+\+DL\+\_\+\+EXCESS}~500.\+0f
\item 
\Hypertarget{energy_8h_aa475e97af32e6972baba4dd1a61f48df}\label{energy_8h_aa475e97af32e6972baba4dd1a61f48df} 
\#define {\bfseries PV\+\_\+\+DL\+\_\+\+B\+\_\+\+AH\+\_\+\+LOW}~100.\+0f
\item 
\Hypertarget{energy_8h_a69ba8a83d257f96478010c24eccc1627}\label{energy_8h_a69ba8a83d257f96478010c24eccc1627} 
\#define {\bfseries PV\+\_\+\+DL\+\_\+\+B\+\_\+\+AH\+\_\+\+MIN}~150.\+0f
\item 
\Hypertarget{energy_8h_a536a0eb3b3062d965ce65b5972f6f84e}\label{energy_8h_a536a0eb3b3062d965ce65b5972f6f84e} 
\#define {\bfseries PV\+\_\+\+DL\+\_\+\+B\+\_\+\+V\+\_\+\+LOW}~23.\+8f
\item 
\Hypertarget{energy_8h_aa0fd7bf782c78012ac9a5e7defb1bbc9}\label{energy_8h_aa0fd7bf782c78012ac9a5e7defb1bbc9} 
\#define {\bfseries PWA\+\_\+\+SLEEP}~200.\+0f
\item 
\Hypertarget{energy_8h_a72d43cca0100ee56d41326523daf179a}\label{energy_8h_a72d43cca0100ee56d41326523daf179a} 
\#define {\bfseries DL\+\_\+\+AC\+\_\+\+DC\+\_\+\+EFF}~1.\+24f
\item 
\Hypertarget{energy_8h_a83055b2860263c3ebcea7deaaf48f0cf}\label{energy_8h_a83055b2860263c3ebcea7deaaf48f0cf} 
\#define {\bfseries BAL\+\_\+\+MIN\+\_\+\+ENERGY\+\_\+\+AC}~-\/200.\+0f
\item 
\Hypertarget{energy_8h_a8996e9908d95419bf7493943eb495da1}\label{energy_8h_a8996e9908d95419bf7493943eb495da1} 
\#define {\bfseries BAL\+\_\+\+MAX\+\_\+\+ENERGY\+\_\+\+AC}~200.\+0f
\item 
\Hypertarget{energy_8h_a42beedc428820d4934ee117f71e382c8}\label{energy_8h_a42beedc428820d4934ee117f71e382c8} 
\#define {\bfseries BAL\+\_\+\+MIN\+\_\+\+ENERGY\+\_\+\+GTI}~-\/1400.\+0f
\item 
\Hypertarget{energy_8h_a6c83f780e5e47e63325d47269958403e}\label{energy_8h_a6c83f780e5e47e63325d47269958403e} 
\#define {\bfseries BAL\+\_\+\+MAX\+\_\+\+ENERGY\+\_\+\+GTI}~200.\+0f
\item 
\Hypertarget{energy_8h_a2d9257ecbf4951d3877398f752d47ae6}\label{energy_8h_a2d9257ecbf4951d3877398f752d47ae6} 
\#define {\bfseries LOG\+\_\+\+TO\+\_\+\+FILE}~"{}/store/logs/energy.\+log"{}
\item 
\Hypertarget{energy_8h_aacdc926f0a34006e13fe0ddc3398deee}\label{energy_8h_aacdc926f0a34006e13fe0ddc3398deee} 
\#define {\bfseries LOG\+\_\+\+TO\+\_\+\+FILE\+\_\+\+ALT}~"{}/tmp/energy.\+log"{}
\item 
\Hypertarget{energy_8h_ab0b8ba6aa93ebd10e13799409927e3d5}\label{energy_8h_ab0b8ba6aa93ebd10e13799409927e3d5} 
\#define {\bfseries MAX\+\_\+\+LOG\+\_\+\+SPAM}~60
\item 
\Hypertarget{energy_8h_a764c3b6aadcbcacb53eca948eeb75bdf}\label{energy_8h_a764c3b6aadcbcacb53eca948eeb75bdf} 
\#define {\bfseries LOW\+\_\+\+LOG\+\_\+\+SPAM}~2
\item 
\Hypertarget{energy_8h_a3af0cc0b4b28d3cecd3a7d1daf772804}\label{energy_8h_a3af0cc0b4b28d3cecd3a7d1daf772804} 
\#define {\bfseries RESET\+\_\+\+LOG\+\_\+\+SPAM}~120
\item 
\Hypertarget{energy_8h_a18b5f37719f22d3f499db9ec0370f9b6}\label{energy_8h_a18b5f37719f22d3f499db9ec0370f9b6} 
\#define {\bfseries IM\+\_\+\+DELAY}~1
\item 
\Hypertarget{energy_8h_acd44706ab6bf5f575743818ab69a0cd4}\label{energy_8h_acd44706ab6bf5f575743818ab69a0cd4} 
\#define {\bfseries IM\+\_\+\+DISPLAY}~1
\item 
\Hypertarget{energy_8h_a5b916c6432aad3657a5787da32a7a086}\label{energy_8h_a5b916c6432aad3657a5787da32a7a086} 
\#define {\bfseries GTI\+\_\+\+DELAY}~1
\item 
\Hypertarget{energy_8h_a1080c8ca712e9dc1addd48d9ae40b007}\label{energy_8h_a1080c8ca712e9dc1addd48d9ae40b007} 
\#define {\bfseries PWA\+\_\+\+SANE}~1700.\+0f
\item 
\Hypertarget{energy_8h_abdf0a79062ee811bfb1da544d1876e67}\label{energy_8h_abdf0a79062ee811bfb1da544d1876e67} 
\#define {\bfseries PAMPS\+\_\+\+SANE}~16.\+0f
\item 
\Hypertarget{energy_8h_aa92d0d3c6e77fb8c158bd4c098ad07ac}\label{energy_8h_aa92d0d3c6e77fb8c158bd4c098ad07ac} 
\#define {\bfseries PVOLTS\+\_\+\+SANE}~150.\+0f
\item 
\Hypertarget{energy_8h_a36849bf632f6907ce2826cf4f4f7f70a}\label{energy_8h_a36849bf632f6907ce2826cf4f4f7f70a} 
\#define {\bfseries BAMPS\+\_\+\+SANE}~70.\+0f
\item 
\Hypertarget{energy_8h_a79672f46174e51a679c5910274fd66a3}\label{energy_8h_a79672f46174e51a679c5910274fd66a3} 
\#define {\bfseries MAX\+\_\+\+IM\+\_\+\+VAR}~IA\+\_\+\+LAST\texorpdfstring{$\ast$}{*}PHASE\+\_\+\+LAST
\item 
\Hypertarget{energy_8h_afddaf9e33dbc732f31ced2b378f11748}\label{energy_8h_afddaf9e33dbc732f31ced2b378f11748} 
\#define {\bfseries L1\+\_\+P}~IA\+\_\+\+POWER
\item 
\Hypertarget{energy_8h_a492bcf1cf0c61ce5dfbf5d1825b09946}\label{energy_8h_a492bcf1cf0c61ce5dfbf5d1825b09946} 
\#define {\bfseries L2\+\_\+P}~L1\+\_\+P+IA\+\_\+\+LAST
\item 
\Hypertarget{energy_8h_a5a73f316e17083fb4d7cbf348494322a}\label{energy_8h_a5a73f316e17083fb4d7cbf348494322a} 
\#define {\bfseries L3\+\_\+P}~L2\+\_\+P+IA\+\_\+\+LAST
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum {\bfseries client\+\_\+id} \{ {\bfseries ID\+\_\+\+C1}
, {\bfseries ID\+\_\+\+C2}
, {\bfseries ID\+\_\+\+C3}
 \}
\item 
enum {\bfseries energy\+\_\+state} \{ \newline
{\bfseries E\+\_\+\+INIT}
, {\bfseries E\+\_\+\+RUN}
, {\bfseries E\+\_\+\+WAIT}
, {\bfseries E\+\_\+\+IDLE}
, \newline
{\bfseries E\+\_\+\+STOP}
, {\bfseries E\+\_\+\+LAST}
 \}
\item 
enum {\bfseries running\+\_\+state} \{ \newline
{\bfseries R\+\_\+\+INIT}
, {\bfseries R\+\_\+\+FLOAT}
, {\bfseries R\+\_\+\+SLEEP}
, {\bfseries R\+\_\+\+RUN}
, \newline
{\bfseries R\+\_\+\+IDLE}
, {\bfseries R\+\_\+\+LAST}
 \}
\item 
enum {\bfseries iammeter\+\_\+phase} \{ {\bfseries PHASE\+\_\+A}
, {\bfseries PHASE\+\_\+B}
, {\bfseries PHASE\+\_\+C}
, {\bfseries PHASE\+\_\+\+LAST}
 \}
\item 
enum {\bfseries iammeter\+\_\+id} \{ \newline
{\bfseries IA\+\_\+\+VOLTAGE}
, {\bfseries IA\+\_\+\+CURRENT}
, {\bfseries IA\+\_\+\+POWER}
, {\bfseries IA\+\_\+\+IMPORT}
, \newline
{\bfseries IA\+\_\+\+EXPORT}
, {\bfseries IA\+\_\+\+FREQ}
, {\bfseries IA\+\_\+\+PF}
, {\bfseries IA\+\_\+\+LAST}
 \}
\item 
enum {\bfseries mqtt\+\_\+vars} \{ \newline
{\bfseries V\+\_\+\+FCCM}
, {\bfseries V\+\_\+\+FBEKW}
, {\bfseries V\+\_\+\+FRUNT}
, {\bfseries V\+\_\+\+FBAMPS}
, \newline
{\bfseries V\+\_\+\+FBV}
, {\bfseries V\+\_\+\+FLO}
, {\bfseries V\+\_\+\+FSO}
, {\bfseries V\+\_\+\+FACE}
, \newline
{\bfseries V\+\_\+\+BEN}
, {\bfseries V\+\_\+\+PWA}
, {\bfseries V\+\_\+\+PAMPS}
, {\bfseries V\+\_\+\+PVOLTS}
, \newline
{\bfseries V\+\_\+\+FLAST}
, {\bfseries V\+\_\+\+HDCSW}
, {\bfseries V\+\_\+\+HACSW}
, {\bfseries V\+\_\+\+HSHUT}
, \newline
{\bfseries V\+\_\+\+HMODE}
, {\bfseries V\+\_\+\+HCON0}
, {\bfseries V\+\_\+\+HCON1}
, {\bfseries V\+\_\+\+HCON2}
, \newline
{\bfseries V\+\_\+\+HCON3}
, {\bfseries V\+\_\+\+HCON4}
, {\bfseries V\+\_\+\+HCON5}
, {\bfseries V\+\_\+\+HCON6}
, \newline
{\bfseries V\+\_\+\+HCON7}
, {\bfseries V\+\_\+\+DVPV}
, {\bfseries V\+\_\+\+DPPV}
, {\bfseries V\+\_\+\+DPBAT}
, \newline
{\bfseries V\+\_\+\+DVBAT}
, {\bfseries V\+\_\+\+DCMPPT}
, {\bfseries V\+\_\+\+DPMPPT}
, {\bfseries V\+\_\+\+DAHBAT}
, \newline
{\bfseries V\+\_\+\+DCCMODE}
, {\bfseries V\+\_\+\+DGTI}
, {\bfseries V\+\_\+\+DLAST}
 \}
\item 
enum {\bfseries sane\+\_\+vars} \{ \newline
{\bfseries S\+\_\+\+FCCM}
, {\bfseries S\+\_\+\+FBEKW}
, {\bfseries S\+\_\+\+FRUNT}
, {\bfseries S\+\_\+\+FBAMPS}
, \newline
{\bfseries S\+\_\+\+FBV}
, {\bfseries S\+\_\+\+FLO}
, {\bfseries S\+\_\+\+FSO}
, {\bfseries S\+\_\+\+FACE}
, \newline
{\bfseries S\+\_\+\+BEN}
, {\bfseries S\+\_\+\+PWA}
, {\bfseries S\+\_\+\+PAMPS}
, {\bfseries S\+\_\+\+PVOLTS}
, \newline
{\bfseries S\+\_\+\+FLAST}
, {\bfseries S\+\_\+\+HDCSW}
, {\bfseries S\+\_\+\+HACSW}
, {\bfseries S\+\_\+\+HSHUT}
, \newline
{\bfseries S\+\_\+\+HMODE}
, {\bfseries S\+\_\+\+DVPV}
, {\bfseries S\+\_\+\+DPPV}
, {\bfseries S\+\_\+\+DPBAT}
, \newline
{\bfseries S\+\_\+\+DVBAT}
, {\bfseries S\+\_\+\+DCMPPT}
, {\bfseries S\+\_\+\+DPMPPT}
, {\bfseries S\+\_\+\+DAHBAT}
, \newline
{\bfseries S\+\_\+\+DCCMODE}
, {\bfseries S\+\_\+\+DGTI}
, {\bfseries S\+\_\+\+DLAST}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{energy_8h_a16c43fcb061651421cdf377a01de5802}{timer\+\_\+callback}} (int32\+\_\+t)
\item 
void \mbox{\hyperlink{energy_8h_acac721db1f1fabfc32db2d76683f6584}{connlost}} (void \texorpdfstring{$\ast$}{*}, char \texorpdfstring{$\ast$}{*})
\item 
void \mbox{\hyperlink{energy_8h_aec7b6ceb0e44a7b4cc2ddcad8af63961}{ramp\+\_\+up\+\_\+gti}} (MQTTClient, bool, bool)
\item 
void \mbox{\hyperlink{energy_8h_a83dff61732d4ce6a5f659dab11d86c0d}{ramp\+\_\+up\+\_\+ac}} (MQTTClient, bool)
\item 
void \mbox{\hyperlink{energy_8h_a921d1b16c4cd888e365414602e256ba8}{ramp\+\_\+down\+\_\+gti}} (MQTTClient, bool)
\item 
void \mbox{\hyperlink{energy_8h_a46e17290c238de32216da16a2cd5951b}{ramp\+\_\+down\+\_\+ac}} (MQTTClient, bool)
\item 
void \mbox{\hyperlink{energy_8h_a2c6c70b9a184aa76393a677b08954c81}{ha\+\_\+ac\+\_\+off}} (void)
\item 
void \mbox{\hyperlink{energy_8h_a9a2e9166d49137eb9230625ac072807d}{ha\+\_\+ac\+\_\+on}} (void)
\item 
void \mbox{\hyperlink{energy_8h_a200b8cfedca58c43dc888d70d83342d2}{ha\+\_\+dc\+\_\+off}} (void)
\item 
void \mbox{\hyperlink{energy_8h_ada6758833529a18e073775d997a3833b}{ha\+\_\+dc\+\_\+on}} (void)
\item 
size\+\_\+t \mbox{\hyperlink{energy_8h_a29cd5a6b609c70451dc93083c9244125}{iammeter\+\_\+write\+\_\+callback}} (char \texorpdfstring{$\ast$}{*}, size\+\_\+t, size\+\_\+t, void \texorpdfstring{$\ast$}{*})
\item 
void \mbox{\hyperlink{energy_8h_a34d485627939300ea5e51b765f599b9a}{iammeter\+\_\+read}} (void)
\item 
void \mbox{\hyperlink{energy_8h_a8b0aebb679cfaa2c1c7f70e477e396a5}{print\+\_\+im\+\_\+vars}} (void)
\item 
void \mbox{\hyperlink{energy_8h_a7ce8be1d4c8d4c9881d482bed4933512}{print\+\_\+mvar\+\_\+vars}} (void)
\item 
bool \mbox{\hyperlink{energy_8h_a014b7e7feb1f7f94f1947d2961e58534}{sanity\+\_\+check}} (void)
\item 
char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{energy_8h_aa6c4cd39da4bcd29a41c0aec2fc3596b}{log\+\_\+time}} (bool)
\item 
bool \mbox{\hyperlink{energy_8h_a2533146394b65b382653eff2cd6f2106}{sync\+\_\+ha}} (void)
\item 
bool \mbox{\hyperlink{energy_8h_ae7020228b3ccca216927caec73938554}{log\+\_\+timer}} (void)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structenergy__type}{energy\+\_\+type}} \mbox{\hyperlink{energy_8h_aae3805c63e28abac1e41ffd7b623596e}{E}}
\item 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}} \mbox{\hyperlink{energy_8h_a300fe8f759de831a9cf50f5a86c85e23}{ha\+\_\+flag\+\_\+vars\+\_\+ss}}
\item 
\Hypertarget{energy_8h_acec19516a59050bb447192fe318e6a9c}\label{energy_8h_acec19516a59050bb447192fe318e6a9c} 
FILE \texorpdfstring{$\ast$}{*} {\bfseries fout}
\end{DoxyCompactItemize}


\doxysubsection{Enumeration Type Documentation}
\Hypertarget{energy_8h_a3880622ca383fee22fbbac18442bae32}\index{energy.h@{energy.h}!client\_id@{client\_id}}
\index{client\_id@{client\_id}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{client\_id}{client\_id}}
{\footnotesize\ttfamily \label{energy_8h_a3880622ca383fee22fbbac18442bae32} 
enum client\+\_\+id}


\begin{DoxyCode}{0}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ ID\_C1,}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ ID\_C2,}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ ID\_C3,}
\DoxyCodeLine{00198\ \ \ \ \ \};}

\end{DoxyCode}
\Hypertarget{energy_8h_a3b2b2ba876738909ea41ffc29311415f}\index{energy.h@{energy.h}!energy\_state@{energy\_state}}
\index{energy\_state@{energy\_state}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{energy\_state}{energy\_state}}
{\footnotesize\ttfamily \label{energy_8h_a3b2b2ba876738909ea41ffc29311415f} 
enum energy\+\_\+state}


\begin{DoxyCode}{0}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ E\_INIT,}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ E\_RUN,}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ E\_WAIT,}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ E\_IDLE,}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ E\_STOP,}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ E\_LAST,}
\DoxyCodeLine{00207\ \ \ \ \ \};}

\end{DoxyCode}
\Hypertarget{energy_8h_a9221f2a245e5eb6eb3034802aa882184}\index{energy.h@{energy.h}!iammeter\_id@{iammeter\_id}}
\index{iammeter\_id@{iammeter\_id}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{iammeter\_id}{iammeter\_id}}
{\footnotesize\ttfamily \label{energy_8h_a9221f2a245e5eb6eb3034802aa882184} 
enum iammeter\+\_\+id}


\begin{DoxyCode}{0}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ IA\_VOLTAGE,}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ IA\_CURRENT,}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ IA\_POWER,}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ IA\_IMPORT,}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ IA\_EXPORT,}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ IA\_FREQ,}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ IA\_PF,}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ IA\_LAST,}
\DoxyCodeLine{00234\ \ \ \ \ \};}

\end{DoxyCode}
\Hypertarget{energy_8h_a43ff9d577152831837f2de48199c0323}\index{energy.h@{energy.h}!iammeter\_phase@{iammeter\_phase}}
\index{iammeter\_phase@{iammeter\_phase}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{iammeter\_phase}{iammeter\_phase}}
{\footnotesize\ttfamily \label{energy_8h_a43ff9d577152831837f2de48199c0323} 
enum iammeter\+\_\+phase}


\begin{DoxyCode}{0}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ PHASE\_A,}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ PHASE\_B,}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ PHASE\_C,}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ PHASE\_LAST,}
\DoxyCodeLine{00223\ \ \ \ \ \};}

\end{DoxyCode}
\Hypertarget{energy_8h_a4798b70da5e09a128bfc682db0b65072}\index{energy.h@{energy.h}!mqtt\_vars@{mqtt\_vars}}
\index{mqtt\_vars@{mqtt\_vars}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{mqtt\_vars}{mqtt\_vars}}
{\footnotesize\ttfamily \label{energy_8h_a4798b70da5e09a128bfc682db0b65072} 
enum mqtt\+\_\+vars}


\begin{DoxyCode}{0}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ V\_FCCM,}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ V\_FBEKW,}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ V\_FRUNT,}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ V\_FBAMPS,}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ V\_FBV,}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ V\_FLO,}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ V\_FSO,}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ V\_FACE,}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ V\_BEN,}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ V\_PWA,}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ V\_PAMPS,}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ V\_PVOLTS,}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ V\_FLAST,}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ V\_HDCSW,}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ V\_HACSW,}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ V\_HSHUT,}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ V\_HMODE,}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ V\_HCON0,}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ V\_HCON1,}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ V\_HCON2,}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ V\_HCON3,}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ V\_HCON4,}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ V\_HCON5,}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ V\_HCON6,}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ V\_HCON7,}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ add\ other\ data\ ranges\ here}}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ V\_DVPV,}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ V\_DPPV,}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ V\_DPBAT,}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ V\_DVBAT,}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ V\_DCMPPT,}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ V\_DPMPPT,}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ V\_DAHBAT,}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ V\_DCCMODE,}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ V\_DGTI,}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ V\_DLAST,}
\DoxyCodeLine{00273\ \ \ \ \ \};}

\end{DoxyCode}
\Hypertarget{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69}\index{energy.h@{energy.h}!running\_state@{running\_state}}
\index{running\_state@{running\_state}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{running\_state}{running\_state}}
{\footnotesize\ttfamily \label{energy_8h_a1bdad092c5c23a62d1b0d20c6ce63d69} 
enum running\+\_\+state}


\begin{DoxyCode}{0}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ R\_INIT,}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ R\_FLOAT,}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ R\_SLEEP,}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ R\_RUN,}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ R\_IDLE,}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ R\_LAST,}
\DoxyCodeLine{00216\ \ \ \ \ \};}

\end{DoxyCode}
\Hypertarget{energy_8h_a5c579d778e1576fd9ae67c1cc7e81ee7}\index{energy.h@{energy.h}!sane\_vars@{sane\_vars}}
\index{sane\_vars@{sane\_vars}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{sane\_vars}{sane\_vars}}
{\footnotesize\ttfamily \label{energy_8h_a5c579d778e1576fd9ae67c1cc7e81ee7} 
enum sane\+\_\+vars}


\begin{DoxyCode}{0}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ S\_FCCM,}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ S\_FBEKW,}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ S\_FRUNT,}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ S\_FBAMPS,}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ S\_FBV,}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ S\_FLO,}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ S\_FSO,}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ S\_FACE,}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ S\_BEN,}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ S\_PWA,}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ S\_PAMPS,}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ S\_PVOLTS,}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ S\_FLAST,}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ S\_HDCSW,}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ S\_HACSW,}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ S\_HSHUT,}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ S\_HMODE,}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ add\ other\ data\ ranges\ here}}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ S\_DVPV,}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ S\_DPPV,}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ S\_DPBAT,}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ S\_DVBAT,}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ S\_DCMPPT,}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ S\_DPMPPT,}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ S\_DAHBAT,}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ S\_DCCMODE,}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ S\_DGTI,}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ S\_DLAST,}
\DoxyCodeLine{00304\ \ \ \ \ \};}

\end{DoxyCode}


\doxysubsection{Function Documentation}
\Hypertarget{energy_8h_acac721db1f1fabfc32db2d76683f6584}\index{energy.h@{energy.h}!connlost@{connlost}}
\index{connlost@{connlost}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{connlost()}{connlost()}}
{\footnotesize\ttfamily \label{energy_8h_acac721db1f1fabfc32db2d76683f6584} 
void connlost (\begin{DoxyParamCaption}\item[{void \texorpdfstring{$\ast$}{*}}]{context}{, }\item[{char \texorpdfstring{$\ast$}{*}}]{cause}{}\end{DoxyParamCaption})}

trouble in River-\/city
\begin{DoxyCode}{0}
\DoxyCodeLine{00301\ \{}
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structha__flag__type}{ha\_flag\_type}}\ *ha\_flag\ =\ context;}
\DoxyCodeLine{00303\ \ \ \ \ int32\_t\ id\_num\ =\ ha\_flag-\/>ha\_id;}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{keyword}{static}\ uint32\_t\ times\ =\ 0;}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keywordtype}{char}\ *\ where\ =\ \textcolor{stringliteral}{"{}Missing\ Topic"{}};}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \ \ \textcolor{keywordflow}{switch}\ (ha\_flag-\/>cid)\ \{}
\DoxyCodeLine{00308\ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_C1:}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ where\ =\ TOPIC\_SS;}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_C2:}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ where\ =\ TOPIC\_SD;}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_C3:}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ where\ =\ TOPIC\_HA;}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00317\ \ \ \ \ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{comment}{//\ bug-\/out\ if\ no\ context\ variables\ passed\ to\ callback}}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keywordflow}{if}\ (context\ ==\ NULL)\ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ id\_num\ =\ -\/1;}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ bugout;\ }
\DoxyCodeLine{00323\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (times++\ >\ MQTT\_RECONN)\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ bugout;}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\(\backslash\)n\%s\ Connection\ lost,\ exit\ ha\_energy\ program\(\backslash\)n"{}},\ log\_time(\textcolor{keyword}{false}));}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\%s\ \ \ \ \ cause:\ \%s,\ h\_id\ \%d\ c\_id\ \%d\ \%s\ \(\backslash\)n"{}},\ log\_time(\textcolor{keyword}{false}),\ cause,\ id\_num,\ ha\_flag-\/>cid,\ where);}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\%s\ MQTT\ DAEMON\ failure\ \ LOG\ Version\ \%s\ :\ MQTT\ Version\ \%s\(\backslash\)n"{}},\ log\_time(\textcolor{keyword}{false}),\ LOG\_VERSION,\ MQTT\_VERSION);}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ fflush(fout);}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00333\ \ \ \ \ \}}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ bugout:}
\DoxyCodeLine{00336\ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\(\backslash\)n\%s\ Connection\ lost,\ exit\ ha\_energy\ program\(\backslash\)n"{}},\ log\_time(\textcolor{keyword}{false}));}
\DoxyCodeLine{00337\ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\%s\ \ \ \ \ cause:\ \%s,\ h\_id\ \%d\ c\_id\ \%d\ \%s\ \(\backslash\)n"{}},\ log\_time(\textcolor{keyword}{false}),\ cause,\ id\_num,\ ha\_flag-\/>cid,\ where);}
\DoxyCodeLine{00338\ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\%s\ MQTT\ DAEMON\ failure\ \ LOG\ Version\ \%s\ :\ MQTT\ Version\ \%s\(\backslash\)n"{}},\ log\_time(\textcolor{keyword}{false}),\ LOG\_VERSION,\ MQTT\_VERSION);}
\DoxyCodeLine{00339\ \ \ \ \ fflush(fout);}
\DoxyCodeLine{00340\ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00341\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a2c6c70b9a184aa76393a677b08954c81}\index{energy.h@{energy.h}!ha\_ac\_off@{ha\_ac\_off}}
\index{ha\_ac\_off@{ha\_ac\_off}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{ha\_ac\_off()}{ha\_ac\_off()}}
{\footnotesize\ttfamily \label{energy_8h_a2c6c70b9a184aa76393a677b08954c81} 
void ha\+\_\+ac\+\_\+off (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00978\ \{}
\DoxyCodeLine{00979\ \ \ \ \ mqtt\_ha\_switch(E.client\_p,\ TOPIC\_PACC,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00980\ \ \ \ \ E.ac\_sw\_status\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00981\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a9a2e9166d49137eb9230625ac072807d}\index{energy.h@{energy.h}!ha\_ac\_on@{ha\_ac\_on}}
\index{ha\_ac\_on@{ha\_ac\_on}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{ha\_ac\_on()}{ha\_ac\_on()}}
{\footnotesize\ttfamily \label{energy_8h_a9a2e9166d49137eb9230625ac072807d} 
void ha\+\_\+ac\+\_\+on (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00984\ \{}
\DoxyCodeLine{00985\ \ \ \ \ mqtt\_ha\_switch(E.client\_p,\ TOPIC\_PACC,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00986\ \ \ \ \ E.ac\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00987\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a200b8cfedca58c43dc888d70d83342d2}\index{energy.h@{energy.h}!ha\_dc\_off@{ha\_dc\_off}}
\index{ha\_dc\_off@{ha\_dc\_off}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{ha\_dc\_off()}{ha\_dc\_off()}}
{\footnotesize\ttfamily \label{energy_8h_a200b8cfedca58c43dc888d70d83342d2} 
void ha\+\_\+dc\+\_\+off (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00993\ \{}
\DoxyCodeLine{00994\ \ \ \ \ mqtt\_ha\_switch(E.client\_p,\ TOPIC\_PDCC,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00995\ \ \ \ \ E.gti\_sw\_status\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00996\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_ada6758833529a18e073775d997a3833b}\index{energy.h@{energy.h}!ha\_dc\_on@{ha\_dc\_on}}
\index{ha\_dc\_on@{ha\_dc\_on}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{ha\_dc\_on()}{ha\_dc\_on()}}
{\footnotesize\ttfamily \label{energy_8h_ada6758833529a18e073775d997a3833b} 
void ha\+\_\+dc\+\_\+on (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00999\ \{}
\DoxyCodeLine{01000\ \ \ \ \ mqtt\_ha\_switch(E.client\_p,\ TOPIC\_PDCC,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01001\ \ \ \ \ E.gti\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01002\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a34d485627939300ea5e51b765f599b9a}\index{energy.h@{energy.h}!iammeter\_read@{iammeter\_read}}
\index{iammeter\_read@{iammeter\_read}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{iammeter\_read()}{iammeter\_read()}}
{\footnotesize\ttfamily \label{energy_8h_a34d485627939300ea5e51b765f599b9a} 
void iammeter\+\_\+read (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00076\ \{}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ curl\ =\ curl\_easy\_init();}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordflow}{if}\ (curl)\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ E.link.iammeter\_count++;}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ curl\_easy\_setopt(curl,\ CURLOPT\_URL,\ \textcolor{stringliteral}{"{}http://10.1.1.101/monitorjson"{}});}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ curl\_easy\_setopt(curl,\ CURLOPT\_WRITEFUNCTION,\ iammeter\_write\_callback);}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ curl\_easy\_setopt(curl,\ CURLOPT\_WRITEDATA,\ E.print\_vars);\ \textcolor{comment}{//\ external\ data\ array\ for\ iammeter\ values}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ res\ =\ curl\_easy\_perform(curl);}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Check\ for\ errors\ */}}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (res\ !=\ CURLE\_OK)\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}curl\_easy\_perform()\ failed\ in\ iammeter\_read:\ \%s\(\backslash\)n"{}},}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ curl\_easy\_strerror(res));}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ E.iammeter\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ E.link.iammeter\_error++;}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ E.iammeter\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ curl\_easy\_cleanup(curl);}
\DoxyCodeLine{00096\ \ \ \ \ \}}
\DoxyCodeLine{00097\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a29cd5a6b609c70451dc93083c9244125}\index{energy.h@{energy.h}!iammeter\_write\_callback@{iammeter\_write\_callback}}
\index{iammeter\_write\_callback@{iammeter\_write\_callback}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{iammeter\_write\_callback()}{iammeter\_write\_callback()}}
{\footnotesize\ttfamily \label{energy_8h_a29cd5a6b609c70451dc93083c9244125} 
size\+\_\+t iammeter\+\_\+write\+\_\+callback (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{buffer}{, }\item[{size\+\_\+t}]{size}{, }\item[{size\+\_\+t}]{nitems}{, }\item[{void \texorpdfstring{$\ast$}{*}}]{stream}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00014\ \{}
\DoxyCodeLine{00015\ \ \ \ \ cJSON\ *json\ =\ cJSON\_ParseWithLength(buffer,\ strlen(buffer));}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structenergy__type}{energy\_type}}\ *\ e\ =\ stream;}
\DoxyCodeLine{00017\ \ \ \ \ uint32\_t\ next\_var\ =\ 0;}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \ \ \ \ E.link.iammeter\_count++;}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keywordflow}{if}\ (json\ ==\ NULL)\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *error\_ptr\ =\ cJSON\_GetErrorPtr();}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ E.link.iammeter\_error++;}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (error\_ptr\ !=\ NULL)\ \{}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}Error\ in\ iammeter\_write\_callback\ \%u:\ \%s\(\backslash\)n"{}},\ E.link.iammeter\_error,\ error\_ptr);}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ iammeter\_exit;}
\DoxyCodeLine{00028\ \ \ \ \ \}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#ifdef\ IM\_DEBUG}}
\DoxyCodeLine{00030\ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\(\backslash\)n\ iammeter\_read\_callback\ \%s\ \(\backslash\)n"{}},\ buffer);}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ cJSON\ *data\_result\ =\ cJSON\_GetObjectItemCaseSensitive(json,\ \textcolor{stringliteral}{"{}Datas"{}});}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keywordflow}{if}\ (!data\_result)\ \{}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ size\ =\ 0;}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ nitems\ =\ 0;}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ iammeter\_exit;}
\DoxyCodeLine{00039\ \ \ \ \ \}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ cJSON\ *jname;}
\DoxyCodeLine{00042\ \ \ \ \ uint32\_t\ phase\ =\ PHASE\_A;}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ cJSON\_ArrayForEach(jname,\ data\_result)}
\DoxyCodeLine{00045\ \ \ \ \ \{}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ cJSON\ *ianame;}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#ifdef\ IM\_DEBUG}}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\(\backslash\)n\ iammeter\ variables\ "{}});}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ cJSON\_ArrayForEach(ianame,\ jname)}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ phase\_var\ =\ IA\_VOLTAGE;}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ iammeter\_get\_data(ianame-\/>valuedouble,\ phase\_var,\ phase);}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ e-\/>print\_vars[next\_var++]\ =\ ianame-\/>valuedouble;}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#ifdef\ IM\_DEBUG}}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\%8.2f\ "{}},\ im\_vars[phase\_var][phase]);}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ phase\_var++;}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ phase++;}
\DoxyCodeLine{00062\ \ \ \ \ \}}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#ifdef\ IM\_DEBUG}}
\DoxyCodeLine{00064\ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ iammeter\_exit:}
\DoxyCodeLine{00068\ \ \ \ \ cJSON\_Delete(json);}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordflow}{return}\ size\ *\ nitems;}
\DoxyCodeLine{00070\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_aa6c4cd39da4bcd29a41c0aec2fc3596b}\index{energy.h@{energy.h}!log\_time@{log\_time}}
\index{log\_time@{log\_time}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{log\_time()}{log\_time()}}
{\footnotesize\ttfamily \label{energy_8h_aa6c4cd39da4bcd29a41c0aec2fc3596b} 
char \texorpdfstring{$\ast$}{*} log\+\_\+time (\begin{DoxyParamCaption}\item[{bool}]{log}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01063\ \{}
\DoxyCodeLine{01064\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{char}\ time\_log[RBUF\_SIZ]\ =\ \{0\};}
\DoxyCodeLine{01065\ \ \ \ \ \textcolor{keyword}{static}\ uint32\_t\ len\ =\ 0,\ sync\_time\ =\ TIME\_SYNC\_SEC\ -\/\ 1;}
\DoxyCodeLine{01066\ \ \ \ \ time\_t\ rawtime\_log;}
\DoxyCodeLine{01067\ }
\DoxyCodeLine{01068\ \ \ \ \ tzset();}
\DoxyCodeLine{01069\ \ \ \ \ timezone\ =\ 0;}
\DoxyCodeLine{01070\ \ \ \ \ daylight\ =\ 0;}
\DoxyCodeLine{01071\ \ \ \ \ time(\&rawtime\_log);}
\DoxyCodeLine{01072\ \ \ \ \ \textcolor{keywordflow}{if}\ (sync\_time++\ >\ TIME\_SYNC\_SEC)\ \{}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \ \ sync\_time\ =\ 0;}
\DoxyCodeLine{01074\ \ \ \ \ \ \ \ \ snprintf(time\_log,\ RBUF\_SIZ\ -\/\ 1,\ \textcolor{stringliteral}{"{}VT\%lut"{}},\ rawtime\_log);\ \textcolor{comment}{//\ format\ for\ dumpload\ controller\ gti\ time\ commands}}
\DoxyCodeLine{01075\ \ \ \ \ \ \ \ \ mqtt\_gti\_time(E.client\_p,\ TOPIC\_P,\ time\_log);}
\DoxyCodeLine{01076\ \ \ \ \ \}}
\DoxyCodeLine{01077\ }
\DoxyCodeLine{01078\ \ \ \ \ sprintf(time\_log,\ \textcolor{stringliteral}{"{}\%s"{}},\ ctime(\&rawtime\_log));}
\DoxyCodeLine{01079\ \ \ \ \ len\ =\ strlen(time\_log);}
\DoxyCodeLine{01080\ \ \ \ \ time\_log[len\ -\/\ 1]\ =\ 0;\ \textcolor{comment}{//\ munge\ out\ the\ return\ character}}
\DoxyCodeLine{01081\ \ \ \ \ \textcolor{keywordflow}{if}\ (log)\ \{}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\%s\ "{}},\ time\_log);}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ fflush(fout);}
\DoxyCodeLine{01084\ \ \ \ \ \}}
\DoxyCodeLine{01085\ }
\DoxyCodeLine{01086\ \ \ \ \ \textcolor{keywordflow}{return}\ time\_log;}
\DoxyCodeLine{01087\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_ae7020228b3ccca216927caec73938554}\index{energy.h@{energy.h}!log\_timer@{log\_timer}}
\index{log\_timer@{log\_timer}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{log\_timer()}{log\_timer()}}
{\footnotesize\ttfamily \label{energy_8h_ae7020228b3ccca216927caec73938554} 
bool log\+\_\+timer (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01122\ \{}
\DoxyCodeLine{01123\ \ \ \ \ \textcolor{keywordtype}{bool}\ itstime\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01124\ }
\DoxyCodeLine{01125\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.log\_spam\ <\ LOW\_LOG\_SPAM)\ \{}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ E.log\_time\_reset\ =\ 0;}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ itstime\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01128\ \ \ \ \ \}}
\DoxyCodeLine{01129\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.log\_time\_reset\ >\ RESET\_LOG\_SPAM)\ \{}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \ \ E.log\_spam\ =\ 0;}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \ \ itstime\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01132\ \ \ \ \ \}}
\DoxyCodeLine{01133\ \ \ \ \ \textcolor{keywordflow}{return}\ itstime;}
\DoxyCodeLine{01134\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a8b0aebb679cfaa2c1c7f70e477e396a5}\index{energy.h@{energy.h}!print\_im\_vars@{print\_im\_vars}}
\index{print\_im\_vars@{print\_im\_vars}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{print\_im\_vars()}{print\_im\_vars()}}
{\footnotesize\ttfamily \label{energy_8h_a8b0aebb679cfaa2c1c7f70e477e396a5} 
void print\+\_\+im\+\_\+vars (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00111\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{char}\ time\_log[RBUF\_SIZ]\ =\ \{0\};}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keyword}{static}\ uint32\_t\ sync\_time\ =\ TIME\_SYNC\_SEC\ -\/\ 1;}
\DoxyCodeLine{00114\ \ \ \ \ time\_t\ rawtime\_log;}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordtype}{char}\ imvars[SYSLOG\_SIZ];}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ fflush(fout);}
\DoxyCodeLine{00118\ \ \ \ \ snprintf(imvars,\ SYSLOG\_SIZ-\/1,\ \textcolor{stringliteral}{"{}House\ L1\ \%7.2fW,\ House\ L2\ \%7.2fW,\ GTI\ L1\ \%7.2fW"{}},\ E.print\_vars[L1\_P],\ E.print\_vars[L2\_P],\ E.print\_vars[L3\_P]);}
\DoxyCodeLine{00119\ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}\%s"{}},\ imvars);}
\DoxyCodeLine{00120\ \ \ \ \ fflush(fout);}
\DoxyCodeLine{00121\ \ \ \ \ time(\&rawtime\_log);}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordflow}{if}\ (sync\_time++\ >\ TIME\_SYNC\_SEC)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ sync\_time\ =\ 0;}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ snprintf(time\_log,\ RBUF\_SIZ\ -\/\ 1,\ \textcolor{stringliteral}{"{}VT\%lut"{}},\ rawtime\_log);\ \textcolor{comment}{//\ format\ for\ dumpload\ controller\ gti\ time\ commands}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ mqtt\_gti\_time(E.client\_p,\ TOPIC\_P,\ time\_log);}
\DoxyCodeLine{00126\ \ \ \ \ \}}
\DoxyCodeLine{00127\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a7ce8be1d4c8d4c9881d482bed4933512}\index{energy.h@{energy.h}!print\_mvar\_vars@{print\_mvar\_vars}}
\index{print\_mvar\_vars@{print\_mvar\_vars}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{print\_mvar\_vars()}{print\_mvar\_vars()}}
{\footnotesize\ttfamily \label{energy_8h_a7ce8be1d4c8d4c9881d482bed4933512} 
void print\+\_\+mvar\+\_\+vars (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00237\ \{}
\DoxyCodeLine{00238\ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{},\ AC\ Inverter\ \%7.2fW,\ BAT\ Energy\ \%7.2fWh,\ Solar\ E\ \%7.2fWh,\ AC\ E\ \%7.2fWh,\ PERR\ \%7.2fW,\ PBAL\ \%7.2fW,\ ST\ \%7.2f,\ GDL\ \%7.2f,\ \%d,\%d,\%d\ \%d,\%d,\%d\(\backslash\)r"{}},}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ E.mvar[V\_FLO],\ E.mvar[V\_FBEKW],\ E.mvar[V\_FSO],\ E.mvar[V\_FACE],\ E.mode.error,\ E.mvar[V\_BEN],\ E.mode.total\_system,\ E.mode.gti\_dumpload,\ (int32\_t)\ E.mvar[V\_HDCSW],\ (int32\_t)\ E.mvar[V\_HACSW],\ (int32\_t)\ E.mvar[V\_HMODE],}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ (int32\_t)\ E.dc\_mismatch,\ (int32\_t)\ E.ac\_mismatch,\ (int32\_t)\ E.mode\_mismatch);}
\DoxyCodeLine{00241\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a46e17290c238de32216da16a2cd5951b}\index{energy.h@{energy.h}!ramp\_down\_ac@{ramp\_down\_ac}}
\index{ramp\_down\_ac@{ramp\_down\_ac}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{ramp\_down\_ac()}{ramp\_down\_ac()}}
{\footnotesize\ttfamily \label{energy_8h_a46e17290c238de32216da16a2cd5951b} 
void ramp\+\_\+down\+\_\+ac (\begin{DoxyParamCaption}\item[{MQTTClient}]{client\+\_\+p}{, }\item[{bool}]{sw\+\_\+off}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00968\ \{}
\DoxyCodeLine{00969\ \ \ \ \ \textcolor{keywordflow}{if}\ (sw\_off)\ \{}
\DoxyCodeLine{00970\ \ \ \ \ \ \ \ \ mqtt\_ha\_switch(client\_p,\ TOPIC\_PACC,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ E.ac\_sw\_status\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ usleep(500000);}
\DoxyCodeLine{00973\ \ \ \ \ \}}
\DoxyCodeLine{00974\ \ \ \ \ E.once\_ac\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00975\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a921d1b16c4cd888e365414602e256ba8}\index{energy.h@{energy.h}!ramp\_down\_gti@{ramp\_down\_gti}}
\index{ramp\_down\_gti@{ramp\_down\_gti}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{ramp\_down\_gti()}{ramp\_down\_gti()}}
{\footnotesize\ttfamily \label{energy_8h_a921d1b16c4cd888e365414602e256ba8} 
void ramp\+\_\+down\+\_\+gti (\begin{DoxyParamCaption}\item[{MQTTClient}]{client\+\_\+p}{, }\item[{bool}]{sw\+\_\+off}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00935\ \{}
\DoxyCodeLine{00936\ \ \ \ \ \textcolor{keywordflow}{if}\ (sw\_off)\ \{}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ mqtt\_ha\_switch(client\_p,\ TOPIC\_PDCC,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ E.once\_gti\_zero\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ E.gti\_sw\_status\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00940\ \ \ \ \ \}}
\DoxyCodeLine{00941\ \ \ \ \ E.once\_gti\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00942\ }
\DoxyCodeLine{00943\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.once\_gti\_zero)\ \{}
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ mqtt\_gti\_power(client\_p,\ TOPIC\_P,\ \textcolor{stringliteral}{"{}Z\#"{}},\ 7);\ \textcolor{comment}{//\ zero\ power}}
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ E.once\_gti\_zero\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00946\ \ \ \ \ \}}
\DoxyCodeLine{00947\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a83dff61732d4ce6a5f659dab11d86c0d}\index{energy.h@{energy.h}!ramp\_up\_ac@{ramp\_up\_ac}}
\index{ramp\_up\_ac@{ramp\_up\_ac}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{ramp\_up\_ac()}{ramp\_up\_ac()}}
{\footnotesize\ttfamily \label{energy_8h_a83dff61732d4ce6a5f659dab11d86c0d} 
void ramp\+\_\+up\+\_\+ac (\begin{DoxyParamCaption}\item[{MQTTClient}]{client\+\_\+p}{, }\item[{bool}]{start}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00953\ \{}
\DoxyCodeLine{00954\ }
\DoxyCodeLine{00955\ \ \ \ \ \textcolor{keywordflow}{if}\ (start)\ \{}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ E.once\_ac\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00957\ \ \ \ \ \}}
\DoxyCodeLine{00958\ }
\DoxyCodeLine{00959\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.once\_ac)\ \{}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ E.once\_ac\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ mqtt\_ha\_switch(client\_p,\ TOPIC\_PACC,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ E.ac\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ usleep(500000);\ \textcolor{comment}{//\ wait\ for\ voltage\ to\ ramp}}
\DoxyCodeLine{00964\ \ \ \ \ \}}
\DoxyCodeLine{00965\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_aec7b6ceb0e44a7b4cc2ddcad8af63961}\index{energy.h@{energy.h}!ramp\_up\_gti@{ramp\_up\_gti}}
\index{ramp\_up\_gti@{ramp\_up\_gti}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{ramp\_up\_gti()}{ramp\_up\_gti()}}
{\footnotesize\ttfamily \label{energy_8h_aec7b6ceb0e44a7b4cc2ddcad8af63961} 
void ramp\+\_\+up\+\_\+gti (\begin{DoxyParamCaption}\item[{MQTTClient}]{client\+\_\+p}{, }\item[{bool}]{start}{, }\item[{bool}]{excess}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00874\ \{}
\DoxyCodeLine{00875\ \ \ \ \ \textcolor{keyword}{static}\ uint32\_t\ sequence\ =\ 0;}
\DoxyCodeLine{00876\ }
\DoxyCodeLine{00877\ \ \ \ \ \textcolor{keywordflow}{if}\ (start)\ \{}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ E.once\_gti\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00879\ \ \ \ \ \}}
\DoxyCodeLine{00880\ }
\DoxyCodeLine{00881\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.once\_gti)\ \{}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ E.once\_gti\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ sequence\ =\ 0;}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!excess)\ \{}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ \ \ mqtt\_ha\_switch(client\_p,\ TOPIC\_PDCC,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ \ \ E.gti\_sw\_status\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \ \ \ \ usleep(500000);\ \textcolor{comment}{//\ wait\ for\ voltage\ to\ ramp}}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \ \ \ \ sequence\ =\ 1;}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00891\ \ \ \ \ \}}
\DoxyCodeLine{00892\ }
\DoxyCodeLine{00893\ \ \ \ \ \textcolor{keywordflow}{switch}\ (sequence)\ \{}
\DoxyCodeLine{00894\ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ E.once\_gti\_zero\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00897\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00898\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00899\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ E.once\_gti\_zero\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bat\_current\_stable()\ ||\ E.dl\_excess)\ \{\ \textcolor{comment}{//\ check\ battery\ current\ std\ dev,\ stop\ 'motorboating'}}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ \ \ sequence++;}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!mqtt\_gti\_power(client\_p,\ TOPIC\_P,\ \textcolor{stringliteral}{"{}+\#"{}},\ 3))\ \{}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sequence\ =\ 0;}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \ \ \ \ \};\ \textcolor{comment}{//\ +100W\ power}}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \ \ \ \ usleep(500000);\ \textcolor{comment}{//\ wait\ a\ bit\ more\ for\ power\ to\ be\ stable}}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ \ \ \ sequence\ =\ 1;\ \textcolor{comment}{//\ do\ power\ ramps\ when\ ready}}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!mqtt\_gti\_power(client\_p,\ TOPIC\_P,\ \textcolor{stringliteral}{"{}-\/\#"{}},\ 4))\ \{}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sequence\ =\ 0;}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \ \ \ \ \};\ \textcolor{comment}{//\ -\/\ 100W\ power}}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00914\ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ sequence++;}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (E.once\_gti\_zero)\ \{}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \ \ \ \ mqtt\_gti\_power(client\_p,\ TOPIC\_P,\ \textcolor{stringliteral}{"{}Z\#"{}},\ 5);\ \textcolor{comment}{//\ zero\ power}}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ E.once\_gti\_zero\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00921\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (E.once\_gti\_zero)\ \{}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \ \ mqtt\_gti\_power(client\_p,\ TOPIC\_P,\ \textcolor{stringliteral}{"{}Z\#"{}},\ 6);\ \textcolor{comment}{//\ zero\ power}}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ E.once\_gti\_zero\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ sequence\ =\ 0;}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00928\ \ \ \ \ \}}
\DoxyCodeLine{00929\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a014b7e7feb1f7f94f1947d2961e58534}\index{energy.h@{energy.h}!sanity\_check@{sanity\_check}}
\index{sanity\_check@{sanity\_check}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{sanity\_check()}{sanity\_check()}}
{\footnotesize\ttfamily \label{energy_8h_a014b7e7feb1f7f94f1947d2961e58534} 
bool sanity\+\_\+check (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00257\ \{}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.mvar[V\_PWA]\ >\ PWA\_SANE)\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ E.sane\ =\ S\_PWA;}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00261\ \ \ \ \ \}}
\DoxyCodeLine{00262\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.mvar[V\_PAMPS]\ >\ PAMPS\_SANE)\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ E.sane\ =\ S\_PAMPS;}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00265\ \ \ \ \ \}}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.mvar[V\_PVOLTS]\ >\ PVOLTS\_SANE)\ \{}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ E.sane\ =\ S\_PVOLTS;}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00269\ \ \ \ \ \}}
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.mvar[V\_FBAMPS]\ >\ BAMPS\_SANE)\ \{}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ E.sane\ =\ S\_FBAMPS;}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00273\ \ \ \ \ \}}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00275\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a2533146394b65b382653eff2cd6f2106}\index{energy.h@{energy.h}!sync\_ha@{sync\_ha}}
\index{sync\_ha@{sync\_ha}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{sync\_ha()}{sync\_ha()}}
{\footnotesize\ttfamily \label{energy_8h_a2533146394b65b382653eff2cd6f2106} 
bool sync\+\_\+ha (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{01093\ \{}
\DoxyCodeLine{01094\ \ \ \ \ \textcolor{keywordtype}{bool}\ sync\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01095\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.gti\_sw\_status\ !=\ (\textcolor{keywordtype}{bool})\ ((int32\_t)\ E.mvar[V\_HDCSW]))\ \{}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}DC\_MM\ \%d\ \%d\ "{}},\ (\textcolor{keywordtype}{bool})\ E.gti\_sw\_status,\ (\textcolor{keywordtype}{bool})\ ((int32\_t)\ E.mvar[V\_HDCSW]));}
\DoxyCodeLine{01097\ \ \ \ \ \ \ \ \ mqtt\_ha\_switch(E.client\_p,\ TOPIC\_PDCC,\ !E.gti\_sw\_status);}
\DoxyCodeLine{01098\ \ \ \ \ \ \ \ \ E.dc\_mismatch\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ fflush(fout);}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ sync\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01101\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01102\ \ \ \ \ \ \ \ \ E.dc\_mismatch\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01103\ \ \ \ \ \}}
\DoxyCodeLine{01104\ }
\DoxyCodeLine{01105\ \ \ \ \ E.ac\_sw\_status\ =\ (bool)\ ((int32\_t)\ E.mvar[V\_HACSW]);\ \textcolor{comment}{//\ TEMP\ FIX\ for\ MISmatch\ errors}}
\DoxyCodeLine{01106\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.ac\_sw\_status\ !=\ (\textcolor{keywordtype}{bool})\ ((int32\_t)\ E.mvar[V\_HACSW]))\ \{}
\DoxyCodeLine{01107\ \ \ \ \ \ \ \ \ fprintf(fout,\ \textcolor{stringliteral}{"{}AC\_MM\ \%d\ \%d\ "{}},\ (\textcolor{keywordtype}{bool})\ E.ac\_sw\_status,\ (\textcolor{keywordtype}{bool})\ ((int32\_t)\ E.mvar[V\_HACSW]));}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ mqtt\_ha\_switch(E.client\_p,\ TOPIC\_PACC,\ !E.ac\_sw\_status);}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \ \ E.ac\_mismatch\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ fflush(fout);}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ sync\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01112\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \ \ E.ac\_mismatch\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01114\ \ \ \ \ \}}
\DoxyCodeLine{01115\ \ \ \ \ \textcolor{keywordflow}{return}\ sync;}
\DoxyCodeLine{01116\ \}}

\end{DoxyCode}
\Hypertarget{energy_8h_a16c43fcb061651421cdf377a01de5802}\index{energy.h@{energy.h}!timer\_callback@{timer\_callback}}
\index{timer\_callback@{timer\_callback}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{timer\_callback()}{timer\_callback()}}
{\footnotesize\ttfamily \label{energy_8h_a16c43fcb061651421cdf377a01de5802} 
void timer\+\_\+callback (\begin{DoxyParamCaption}\item[{int32\+\_\+t}]{signum}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00286\ \{}
\DoxyCodeLine{00287\ \ \ \ \ signal(signum,\ timer\_callback);}
\DoxyCodeLine{00288\ \ \ \ \ ha\_flag\_vars\_ss.runner\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00289\ \ \ \ \ E.ten\_sec\_clock++;}
\DoxyCodeLine{00290\ \ \ \ \ E.log\_spam++;}
\DoxyCodeLine{00291\ \ \ \ \ E.log\_time\_reset++;}
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{keywordflow}{if}\ (E.log\_spam\ >\ MAX\_LOG\_SPAM)\ \{}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ E.log\_spam\ =\ 0;}
\DoxyCodeLine{00294\ \ \ \ \ \}}
\DoxyCodeLine{00295\ \}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\Hypertarget{energy_8h_aae3805c63e28abac1e41ffd7b623596e}\index{energy.h@{energy.h}!E@{E}}
\index{E@{E}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{E}{E}}
{\footnotesize\ttfamily \label{energy_8h_aae3805c63e28abac1e41ffd7b623596e} 
struct \mbox{\hyperlink{structenergy__type}{energy\+\_\+type}} E\hspace{0.3cm}{\ttfamily [extern]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00111\ \ \ \ \ .once\_gti\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00112\ \ \ \ \ .once\_ac\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00113\ \ \ \ \ .once\_gti\_zero\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00114\ \ \ \ \ .iammeter\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00115\ \ \ \ \ .fm80\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00116\ \ \ \ \ .dumpload\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00117\ \ \ \ \ .homeassistant\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00118\ \ \ \ \ .ac\_low\_adj\ =\ 0.0f,}
\DoxyCodeLine{00119\ \ \ \ \ .gti\_low\_adj\ =\ 0.0f,}
\DoxyCodeLine{00120\ \ \ \ \ .ac\_sw\_on\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00121\ \ \ \ \ .gti\_sw\_on\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00122\ \ \ \ \ .im\_delay\ =\ 0,}
\DoxyCodeLine{00123\ \ \ \ \ .gti\_delay\ =\ 0,}
\DoxyCodeLine{00124\ \ \ \ \ .im\_display\ =\ 0,}
\DoxyCodeLine{00125\ \ \ \ \ .rc\ =\ 0,}
\DoxyCodeLine{00126\ \ \ \ \ .speed\_go\ =\ 0,}
\DoxyCodeLine{00127\ \ \ \ \ .mode.pid.iMax\ =\ PV\_IMAX,}
\DoxyCodeLine{00128\ \ \ \ \ .mode.pid.iMin\ =\ 0.0f,}
\DoxyCodeLine{00129\ \ \ \ \ .mode.pid.pGain\ =\ PV\_PGAIN,}
\DoxyCodeLine{00130\ \ \ \ \ .mode.pid.iGain\ =\ PV\_IGAIN,}
\DoxyCodeLine{00131\ \ \ \ \ .mode.mode\_tmr\ =\ 0,}
\DoxyCodeLine{00132\ \ \ \ \ .mode.mode\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00133\ \ \ \ \ .mode.in\_pid\_control\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00134\ \ \ \ \ .mode.dl\_mqtt\_max\ =\ PV\_DL\_MPTT\_MAX,}
\DoxyCodeLine{00135\ \ \ \ \ .mode.E\ =\ E\_INIT,}
\DoxyCodeLine{00136\ \ \ \ \ .mode.R\ =\ R\_INIT,}
\DoxyCodeLine{00137\ \ \ \ \ .mode.no\_float\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00138\ \ \ \ \ .mode.data\_error\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00139\ \ \ \ \ .ac\_sw\_status\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00140\ \ \ \ \ .gti\_sw\_status\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00141\ \ \ \ \ .solar\_mode\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00142\ \ \ \ \ .solar\_shutdown\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00143\ \ \ \ \ .mode.pv\_bias\ =\ PV\_BIAS\_LOW,}
\DoxyCodeLine{00144\ \ \ \ \ .sane\ =\ S\_DLAST,}
\DoxyCodeLine{00145\ \ \ \ \ .startup\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00146\ \ \ \ \ .ac\_mismatch\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00147\ \ \ \ \ .dc\_mismatch\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00148\ \ \ \ \ .mode\_mismatch\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00149\ \ \ \ \ .link.shutdown\ =\ 0,}
\DoxyCodeLine{00150\ \ \ \ \ .mode.bat\_crit\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00151\ \ \ \ \ .dl\_excess\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00152\ \ \ \ \ .dl\_excess\_adj\ =\ 0.0f,}
\DoxyCodeLine{00153\ \};}

\end{DoxyCode}
\Hypertarget{energy_8h_a300fe8f759de831a9cf50f5a86c85e23}\index{energy.h@{energy.h}!ha\_flag\_vars\_ss@{ha\_flag\_vars\_ss}}
\index{ha\_flag\_vars\_ss@{ha\_flag\_vars\_ss}!energy.h@{energy.h}}
\doxysubsubsection{\texorpdfstring{ha\_flag\_vars\_ss}{ha\_flag\_vars\_ss}}
{\footnotesize\ttfamily \label{energy_8h_a300fe8f759de831a9cf50f5a86c85e23} 
struct \mbox{\hyperlink{structha__flag__type}{ha\+\_\+flag\+\_\+type}} ha\+\_\+flag\+\_\+vars\+\_\+ss\hspace{0.3cm}{\ttfamily [extern]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00075\ \ \ \ \ .runner\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00076\ \ \ \ \ .receivedtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00077\ \ \ \ \ .deliveredtoken\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00078\ \ \ \ \ .rec\_ok\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00079\ \ \ \ \ .ha\_id\ =\ FM80\_ID,}
\DoxyCodeLine{00080\ \ \ \ \ .var\_update\ =\ 0,}
\DoxyCodeLine{00081\ \ \ \ \ .energy\_mode\ =\ NORM\_MODE,}
\DoxyCodeLine{00082\ \};}

\end{DoxyCode}
